// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/3.38/esri/copyright.txt for details.
//>>built
define("esri/dijit/RendererSlider/sliderUtils","../../renderers/utils ../../numberUtils dojo/i18n!../../nls/jsapi dojo/_base/array dojo/_base/lang dojo/dom-style dojo/string dijit/Tooltip dojox/gfx".split(" "),function(x,y,z,p,w,f,A,B,C){return{histogramXAvgPadding:18,labelTopOffset:3,generateTransparentBackground:function(a,b,c,d){a=a.createRect({width:b,height:c}).setFill(d?this.getTransparentFill():null);a.moveToBack();return a},getTransparentFill:function(){return{type:"pattern",x:0,y:0,width:16,
height:16,src:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZlcnNpb249IjEuMSIgaGVpZ2h0PSIxNiIgd2lkdGg9IjE2Ij48cGF0aCBkPSJNMCAwIEw4IDAgTDggOCBMMCA4IFoiIGZpbGw9IiNjY2MiIC8+PHBhdGggZD0iTTAgMCBMOCAwIEw4IDggTDAgOCBaIiBmaWxsPSIjZmZmIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwLDgpIiAvPjxwYXRoIGQ9Ik0wIDAgTDggMCBMOCA4IEwwIDggWiIgZmlsbD0iI2NjYyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoOCw4KSIgLz48cGF0aCBkPSJNMCAwIEw4IDAgTDggOCBMMCA4IFoiIGZpbGw9IiNmZmYiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDgsMCkiIC8+PC9zdmc+"}},
generateHistogramSurface:function(a,b,c,d){a=C.createSurface(a,b,c);f.set(a.rawNode,{overflow:"visible",display:"inline-block",left:d+"px"});a.rawNode.setAttribute("class","esri-histogram-surface");return a},generateCountTooltips:function(a,b){var c=[];a=p.map(a.bins,function(d){return"object"===typeof d?d.count:d});a.reverse();p.forEach(a,w.hitch(this,function(d,h){d=A.substitute(z.widgets.rendererSlider.count,{count:d});c.push(new B({connectId:[b.children[h].rawNode],label:d}))}));return c},generateHistogram:function(a,
b,c,d,h){var m=a.createGroup(),q;m.rawNode.setAttribute("class","esri-histogram-group");var n=p.map(b.bins,function(e){return"object"===typeof e?e.count:e});n.reverse();var k=a.getDimensions().height/n.length;p.forEach(n,w.hitch(this,function(e,r){q=0<e?(c-this.histogramXAvgPadding)*(e/Math.max.apply(Math,n)):0;e=m.createRect({width:q,height:k}).setFill("#aaa").setTransform(C.matrix.translate(0,k*r));e.rawNode.setAttribute("class","esri-histogram-bar");e.rawNode.setAttribute("shape-rendering","crispEdges")}));
f.set(a.rawNode,{display:"inline-block",left:d+"px"});h||m.setTransform({dx:c,dy:0,xx:-1,xy:0,yx:0,yy:1});return m},generateAvgLine:function(a,b,c,d,h,m,q){if(null!=b){var n=a.rawNode.getAttribute("width"),k=a.rawNode.getAttribute("height");c=Math.round(c);var e=a.createLine({x1:h?0:12,y1:c,x2:h?n-this.histogramXAvgPadding+4:n,y2:c}).setStroke({color:"#667"}).moveToBack();e.rawNode.setAttribute("shape-rendering","crispEdges");a=a.createImage({x:h?n-this.histogramXAvgPadding+6:0,y:c-8,width:12,height:14,
src:require.toUrl("esri/dijit/RendererSlider/images/xAvg.png")});b=m?x.formatDate(b,x.timelineDateFormatOptions):q?y.format(parseFloat(b.toFixed(2))).toString()+"%":y.format(parseFloat(b.toFixed(2>d?2:d))).toString();b=A.substitute(z.widgets.rendererSlider.statsAvg,{avg:b});b=new B({connectId:[a.rawNode],label:b});c>k||0>c?(f.set(e.rawNode,"display","none"),f.set(a.rawNode,"display","none")):(f.set(e.rawNode,"display","block"),f.set(a.rawNode,"display","block"));return{avgHandleLine:e,avgHandleImage:a,
avgHandleTooltip:b}}},getCombinedPrecision:function(a,b){var c=this.getPrecision(a),d=this.getPrecision(b);return-10<a&&10>a&&-10<b&&10>b&&2>c&&2>d?2:c>d?c:d},getPrecision:function(a){for(var b=1;Math.round(a*b)/b!==a;)b*=10;a=Math.round(Math.log(b)/Math.LN10);return 20<a?20:a},_resetLabelPositions:function(a){p.forEach(a,function(b){if(b){var c=b.labelNode;c&&(f.set(c,"top","3px"),b.labelNode._autoPositioned=!1)}})},_autoPositionHandleLabels:function(a){var b=[];if(0!==a.length&&(this._resetLabelPositions(a),
p.forEach(a,function(c,d){c&&c.labelNode&&b.push({index:d,handle:c,label:c.labelNode,rect:c.labelNode.getBoundingClientRect()})}),0!==b.length))switch(b.length){case 1:break;case 2:this._autoPositionTwoHandles(a,b);break;case 3:this._autoPositionThreeHandles(a,b);break;default:this._autoPositionManyHandles(a,b)}},_autoPositionTwoHandles:function(a,b){if(this.collisionCheck(b[0].rect,b[1].rect)){a=b[0].rect.top-b[1].rect.top;var c=(b[0].rect.height-a)/2;a=this.labelTopOffset+c;c=this.labelTopOffset-
c;f.set(b[0].label,"top",a+"px");f.set(b[1].label,"top",c+"px");b[0].label._autoPositioned=!0;b[1].label._autoPositioned=!0}},_autoPositionThreeHandles:function(a,b){var c,d,h,m,q,n;p.forEach(b,w.hitch(this,function(l,g){(g=b[g-1])&&g.rect&&this.collisionCheck(l.rect,g.rect)&&(l.label._autoPositioned&&!g.label._autoPositioned?(c=g.rect.top-l.rect.top,h=l.rect.height,m=h-c+this.labelTopOffset,f.set(g.label,"top",m+"px"),g.label._autoPositioned=!0):(!l.label._autoPositioned&&g.label._autoPositioned?
(c=g.rect.top-l.rect.top,h=l.rect.height,m=-1*(h-c)+Number(g.label.style.top.replace("px","")),f.set(l.label,"top",m+"px")):(c=g.rect.top-l.rect.top,d=(l.rect.height-c)/2,q=this.labelTopOffset-d,n=this.labelTopOffset+d,f.set(g.label,"top",n+"px"),f.set(l.label,"top",q+"px"),g.label._autoPositioned=!0),l.label._autoPositioned=!0))}));if(b[2].handle&&10>b[2].handle.style.top.replace("px","")){a=b[2].label;var k=b[1].label,e=b[0].label,r=a.getBoundingClientRect(),t=k.getBoundingClientRect(),v=e.getBoundingClientRect();
if(a._autoPositioned&&k._autoPositioned&&e._autoPositioned)r=Number(a.style.top.replace("px",""))+8,t=Number(k.style.top.replace("px",""))+8,v=Number(e.style.top.replace("px",""))+8,f.set(a,"top",r+"px"),f.set(k,"top",t+"px"),f.set(e,"top",v+"px");else{if(a._autoPositioned){var u=Number(a.style.top.replace("px",""))+4;f.set(a,"top",u+"px")}k._autoPositioned&&t.top-r.top<t.height&&(u=Number(k.style.top.replace("px",""))+4,f.set(k,"top",u+"px"));v.top-t.top<v.height&&(u=Number(e.style.top.replace("px",
""))+4,f.set(e,"top",u+"px"))}}},_autoPositionManyHandles:function(){},collisionCheck:function(a,b){return!(a.right<b.left||a.left>b.right||a.bottom<b.top||a.top>b.bottom)}}});