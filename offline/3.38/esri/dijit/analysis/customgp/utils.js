// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/3.38/esri/copyright.txt for details.
//>>built
define("esri/dijit/analysis/customgp/utils","dojo/_base/array dojo/_base/html dojo/_base/lang dojo/cookie dojo/Deferred dojo/query esri/request".split(" "),function(f,h,q,l,m,p,k){var g={promisifyGetValue:function(a){var b=a.getValue;a.getValue=function(){var c=b.apply(a);if(null!==c&&c.then)return c;var d=new p;d.resolve(c);return d}},allowShareResult:function(a){return f.some(a.outputParams,function(b){return"GPRecordSet"===b.dataType||"GPFeatureRecordSetLayer"===b.dataType&&b.defaultValue&&b.defaultValue.geometryType})},
getServiceDescription:function(a){var b;return k({url:a,content:{f:"json"},handleAs:"json",callbackParamName:"callback"}).then(function(c){b=c;return g.getGPServerDescription(a).then(function(d){b.serverInfo=d;b.useResultMapServer=d.hasResultMapServer;return g.uploadSupported(d).then(function(e){b.serverInfo.supportsUpload=e.supportsUpload;"maxUploadFileSize"in e&&(b.serverInfo.maxUploadFileSize=e.maxUploadFileSize);return b})})})},getGPServerDescription:function(a){var b={url:g.getGPServerUrl(a),
content:{f:"json"},handleAs:"json",callbackParamName:"callback"};return k(b,{useProxy:!1}).then(function(c){var d={};d.currentVersion=c.currentVersion||0;d.url=b.url;d.hasResultMapServer="esriExecutionTypeAsynchronous"===c.executionType&&"resultMapServerName"in c&&""!==c.resultMapServerName;d.resultMapServerName=c.resultMapServerName;return d})},getGPServerUrl:function(a){if(!/\/GPServer\/.+$/.test(a))return"";var b=a.search(/[\w]+[^\/]*$/g);return a.substr(0,b)},getResultMapServerUrl:function(a,
b){if(!/\/rest\/services\//.test(a))return"";var c=a.search(/\/rest\/services\//);return a.substr(0,c+15)+b+"/MapServer"},uploadSupported:function(a){if(10.1<=a.currentVersion)return k({url:a.url+"uploads/info",content:{f:"json"},handleAs:"json"}).then(function(b){return{supportsUpload:!0,maxUploadFileSize:b.maxUploadFileSize}},function(){return{supportsUpload:!1}});a=new p;a.resolve({supportsUpload:!1});return a},getResultMapLayers:function(a,b){a={url:g.getResultMapServerUrl(a,b),content:{f:"json"},
handleAs:"json",callbackParamName:"callback"};return k(a,{useProxy:!1}).then(function(c){var d=f.map(c.layers,function(e){return e.name});f.forEach(c.tables,function(e){d.push(e.name)});return d})},useDynamicSchema:function(a,b){return"useDynamicSchema"in a?!0===a.useDynamicSchema:!0===b.useDynamicSchema},sanitizeHTML:function(a){return a},stripHTML:function(a){return a?-1<a.indexOf("\x3c")&&-1<a.indexOf("\x3e")?a.replace(/<(?:.|\s)*?>/g,""):a:a},setVerticalCenter:function(a){setTimeout(function(){var b=
m(".jimu-vcenter-text",a),c,d;f.forEach(b,function(e){c=h.getContentBox(e).h;h.setStyle(e,{lineHeight:c+"px"})},this);b=m(".jimu-vcenter",a);f.forEach(b,function(e){c=h.getContentBox(e).h;d=h.getContentBox(m(e).parent()[0]).h;h.setStyle(e,{marginTop:(d-c)/2+"px"})},this)},10)},getItemQueryStringByTypes:function(a){var b="",c=g.getAllItemTypes();if(a&&0<a.length&&0<a.length){var d="";f.forEach(a,function(e,n){d+=' type:"'+e+'" ';n!==a.length-1&&(d+=" OR ")});b=" ( "+d+" ) ";c=a.concat(c);c=f.filter(c,
function(e){return f.every(a,function(n){return 0>n.toLowerCase().indexOf(e.toLowerCase())})});f.forEach(c,function(e){b+=' -type:"'+e+'" '})}return b},isInConfigOrPreviewWindow:function(){var a=!1;try{a=!window.isBuilder&&window.parent&&window.parent!==window&&window.parent.isBuilder}catch(b){a=!1}return!!a},removeCookie:function(a,b){var c=this._getDomainsByServerName(window.location.hostname);f.forEach(c,q.hitch(this,function(d){l(a,null,{expires:-1,path:b});l(a,null,{expires:-1,path:b,domain:d});
l(a,null,{expires:-1,path:b,domain:"."+d})}))},checkServiceNameAvailable:function(a,b,c){return k({url:b+"/sharing/rest/portals/"+a.orgId+"/isServiceNameAvailable",content:{name:c,type:"Feature Service",f:"json"}})}};return g});