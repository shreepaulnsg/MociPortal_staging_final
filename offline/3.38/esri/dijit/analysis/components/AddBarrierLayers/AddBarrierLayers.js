// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/3.38/esri/copyright.txt for details.
//>>built
require({cache:{"url:esri/dijit/analysis/components/AddBarrierLayers/AddBarrierLayers.html":'\x3ctr\x3e\r\n  \x3ctd colspan\x3d"3" class\x3d"optionsTd"\x3e\r\n    \x3cdiv class\x3d"optionsClose" data-dojo-attach-point\x3d"_optionsDiv"\x3e\r\n      \x3ctable class\x3d"esriFormTable"\x3e\r\n        \x3ctbody\x3e\r\n          \x3ctr\x3e\r\n            \x3ctd colspan\x3d"2"\x3e\r\n                \x3cdiv class\x3d"dijitTreeExpando" data-dojo-attach-event\x3d"onclick:_handleOptionsBtnClick"\x3e\r\n                  \x3clabel class\x3d"esriLeadingMargin2 noWrapLabel"\x3e${i18n.addBarriers}\x3c/label\x3e\r\n                \x3c/div\x3e\r\n            \x3c/td\x3e\r\n            \x3ctd\x3e\r\n                \x3ca href\x3d"#" class\x3d\'esriFloatTrailing helpIcon\' esriHelpTopic\x3d"barrier_layers"\x3e\x3c/a\x3e\r\n            \x3c/td\x3e\r\n          \x3c/tr\x3e\r\n        \x3c/tbody\x3e\r\n      \x3c/table\x3e\r\n      \x3ctable class\x3d"esriFormTable optionsTable"\x3e\r\n        \x3ctbody\x3e\r\n    \x3c!-- Point Barrier Header --\x3e\r\n          \x3ctr\x3e\r\n            \x3ctd colspan\x3d"2"\x3e\r\n              \x3clabel class\x3d"esriLeadingMargin1 esriAnalysisStepsLabel"\x3e${i18n.pointBarrier}\x3c/label\x3e\r\n            \x3c/td\x3e                   \r\n          \x3c/tr\x3e\r\n    \x3c!-- Point Barrier Select Box --\x3e\r\n          \x3ctr\x3e\r\n            \x3ctd colspan\x3d"3"\x3e\r\n              \x3cselect class\x3d"esriLeadingMargin1 longInput esriLongLabel" data-dojo-type\x3d"dijit/form/Select" data-dojo-props\x3d"required:false" data-dojo-attach-point\x3d"_pointBarrierSelect" data-dojo-attach-event\x3d"onChange:_handlePointBarrierChange"\x3e\r\n              \x3c/select\x3e\r\n            \x3c/td\x3e\r\n          \x3c/tr\x3e\r\n    \x3c!-- Line Barrier Header --\x3e                  \r\n          \x3ctr\x3e\r\n            \x3ctd colspan\x3d"2"\x3e\r\n              \x3clabel class\x3d"esriLeadingMargin1 esriAnalysisStepsLabel"\x3e${i18n.lineBarrier}\x3c/label\x3e\r\n            \x3c/td\x3e                \r\n          \x3c/tr\x3e\r\n    \x3c!-- Line Barrier Select Box --\x3e\r\n          \x3ctr\x3e\r\n            \x3ctd colspan\x3d"3"\x3e\r\n              \x3cselect class\x3d"esriLeadingMargin1 longInput esriLongLabel" data-dojo-type\x3d"dijit/form/Select" data-dojo-props\x3d"required:false" data-dojo-attach-point\x3d"_lineBarrierSelect" data-dojo-attach-event\x3d"onChange:_handleLineBarrierChange"\x3e\r\n              \x3c/select\x3e\r\n            \x3c/td\x3e\r\n          \x3c/tr\x3e\r\n    \x3c!-- Polygon Barrier Header --\x3e \r\n          \x3ctr\x3e\r\n            \x3ctd colspan\x3d"2"\x3e\r\n              \x3clabel class\x3d"esriLeadingMargin1 esriAnalysisStepsLabel"\x3e${i18n.polygonBarrier}\x3c/label\x3e\r\n            \x3c/td\x3e                 \r\n          \x3c/tr\x3e\r\n    \x3c!-- Polygon Barrier Select Box --\x3e\r\n          \x3ctr\x3e\r\n            \x3ctd colspan\x3d"3"\x3e\r\n              \x3cselect class\x3d"esriLeadingMargin1 longInput esriLongLabel" data-dojo-type\x3d"dijit/form/Select" data-dojo-props\x3d"required:false" data-dojo-attach-point\x3d"_polygonBarrierSelect" data-dojo-attach-event\x3d"onChange:_handlePolygonBarrierChange"\x3e\r\n              \x3c/select\x3e\r\n            \x3c/td\x3e\r\n          \x3c/tr\x3e                             \r\n        \x3c/tbody\x3e\r\n      \x3c/table\x3e\r\n    \x3c/div\x3e\r\n  \x3c/td\x3e\r\n\x3c/tr\x3e'}});
define("esri/dijit/analysis/components/AddBarrierLayers/AddBarrierLayers","../../../../kernel ../../AnalysisRegistry ../../utils dijit/form/Select dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/_base/declare dojo/_base/lang dojo/dom-class dojo/has dojo/on dojo/Evented ../../mixins/browselayers/BrowseLayerMixin dojo/i18n!../../../../nls/jsapi dojo/i18n!../../nls/AddBarrierLayers dojo/text!./AddBarrierLayers.html".split(" "),function(m,f,c,k,n,p,q,r,g,d,t,A,u,v,w,x,y){k=
r([n,p,q,u,v],{declaredClass:"esri.dijit.analysis.components.AddBarrierLayers.AddBarrierLayers",templateString:y,i18n:{},pointBarrierLayer:null,pointBarriers:[],lineBarrierLayer:null,lineBarriers:[],polygonBarrierLayer:null,polygonBarriers:[],showGeoAnalyticsParams:!1,forbiddenLayers:[],showBrowseLayers:!1,portalUrl:"",portalSelf:{},map:{},useArcGISComponents:!0,_hidden:!0,_currentSelectBox:null,_currentLayersArray:[],constructor:function(a){},postMixInProperties:function(){this.inherited(arguments);
g.mixin(this.i18n,w.common);g.mixin(this.i18n,x);this.showGeoAnalyticsParams&&(this.showBrowseLayers=!0)},postCreate:function(){this.inherited(arguments)},destroy:function(){this.inherited(arguments)},startup:function(){this.inherited(arguments)},enable:function(){this._hidden=!1;d.remove(this._optionsDiv,"disabled")},disable:function(){this._hidden=!0;d.remove(this._optionsDiv,"optionsOpen");d.add(this._optionsDiv,"optionsClose");d.add(this._optionsDiv,"disabled")},updateOptions:function(a){this.set("forbiddenLayers",
a);this._populateLayersSelect({inLayer:this.pointBarrierLayer,inLayerList:this.pointBarriers,selectWidget:this._pointBarrierSelect,forbiddenLayers:a,options:[{value:"",label:this.i18n.selectPointBarrier},{type:"separator"}]});this._populateLayersSelect({inLayer:this.lineBarrierLayer,inLayerList:this.lineBarriers,selectWidget:this._lineBarrierSelect,forbiddenLayers:a,options:[{value:"",label:this.i18n.selectLineBarrier},{type:"separator"}]});this._populateLayersSelect({inLayer:this.polygonBarrierLayer,
inLayerList:this.polygonBarriers,selectWidget:this._polygonBarrierSelect,forbiddenLayers:a,options:[{value:"",label:this.i18n.selectPolygonBarrier},{type:"separator"}]});this._addBrowseLayersOption();this._handlePointBarrierChange(this._pointBarrierSelect.get("value"));this._handleLineBarrierChange(this._lineBarrierSelect.get("value"));this._handlePolygonBarrierChange(this._polygonBarrierSelect.get("value"))},_addBrowseLayersOption:function(){this.showBrowseLayers&&(this._browseLyrsdlg||this._initializeBrowseLyrDialog(),
[this._pointBarrierSelect,this._lineBarrierSelect,this._polygonBarrierSelect].forEach(function(a){var b=a.get("options");b&&1<=b.length&&("separator"!==b[b.length-1].type&&a.addOption([{type:"separator"}]),c.addBrowseOptionForTool({select:a,disableLAAL:!0},this))},this))},_initializeBrowseLyrDialog:function(){var a=[this._pointBarrierSelect,this._lineBarrierSelect,this._polygonBarrierSelect];this._browseLyrsdlg=c.addBrowseAnalysisDialog({widget:this,browseType:1});this.own(this._browseLyrsdlg.on("browseitems-close",
g.hitch(this,function(b){"add-layer"===b.action&&(this._browseLyrsdlg.browseItems.plugIn._grid&&(b.selection.selectedLayer=this._browseLyrsdlg.browseItems.plugIn._selectedLayer,this._handleBrowseItemsSelect({dialog:this._browseLyrsdlg,selection:b.selection})),this._browseLyrsdlg.browseItems.closeInfoPanel())})));this.own(this._browseLyrsdlg.on("hide",g.hitch(this,function(){a.forEach(function(b){"browselayers"===b.get("value")&&b.reset()})})))},_populateLayersSelect:function(a){a.inLayerList&&a.forbiddenLayers&&
a.selectWidget&&a.options&&(a.selectWidget.removeOption(a.selectWidget.getOptions()),0<a.inLayerList.length&&a.inLayerList.forEach(function(b,l){var e=!1,h;var z=!!c.isSameLayer(b,a.inLayer);for(h=0;h<a.forbiddenLayers.length;h++)if(c.isSameLayer(b,a.forbiddenLayers[h])){e=!0;break}!1===e&&a.options.push({value:l.toString(),label:b.name,selected:z})},this),a.selectWidget.addOption(a.options))},addNewBarrier:function(a){var b=a&&a.geometryType;b&&(b!==f.GeometryTypes.Point||c.isLayerInLayers(a,this.pointBarriers)?
b!==f.GeometryTypes.Line||c.isLayerInLayers(a,this.lineBarriers)?b!==f.GeometryTypes.Polygon||c.isLayerInLayers(a,this.polygonBarriers)||this.polygonBarriers.push(a):this.lineBarriers.push(a):this.pointBarriers.push(a))},buildUI:function(a){this._setupPointBarrierParams({pointBarrierLayer:a.pointBarrierLayer,pointBarriers:a.pointBarriers});this._setupLineBarrierParams({lineBarrierLayer:a.lineBarrierLayer,lineBarriers:a.lineBarriers});this._setupPolygonBarrierParams({polygonBarrierLayer:a.polygonBarrierLayer,
polygonBarriers:a.polygonBarriers});this._setUpAddBrowseLayerOption({showBrowseLayers:a.showBrowseLayers,map:a.map,portalSelf:a.portalSelf,portalUrl:a.portalUrl});this.updateOptions(a.forbiddenLayers);(a.pointBarrierLayer||a.lineBarrierLayer||a.polygonBarrierLayer)&&this._handleOptionsBtnClick();this.useArcGISComponents=a.useArcGISComponents;this.isSingleTenant=a.isSingleTenant},_setupPointBarrierParams:function(a){this.set("pointBarrierLayer",a.pointBarrierLayer);a.pointBarriers||(a.pointBarriers=
[]);this.set("pointBarriers",a.pointBarriers);this.pointBarrierLayer&&!c.isLayerInLayers(this.pointBarrierLayer,this.pointBarriers)&&this.pointBarriers.push(this.pointBarrierLayer)},_setupLineBarrierParams:function(a){this.set("lineBarrierLayer",a.lineBarrierLayer);a.lineBarriers||(a.lineBarriers=[]);this.set("lineBarriers",a.lineBarriers);this.lineBarrierLayer&&!c.isLayerInLayers(this.lineBarrierLayer,this.lineBarriers)&&this.lineBarriers.push(this.lineBarrierLayer)},_setupPolygonBarrierParams:function(a){this.set("polygonBarrierLayer",
a.polygonBarrierLayer);a.polygonBarriers||(a.polygonBarriers=[]);this.set("polygonBarriers",a.polygonBarriers);this.polygonBarrierLayer&&!c.isLayerInLayers(this.polygonBarrierLayer,this.polygonBarriers)&&this.polygonBarriers.push(this.polygonBarrierLayer)},_setUpAddBrowseLayerOption:function(a){this.showBrowseLayers=a.showBrowseLayers;this.map=a.map;this.portalSelf=a.portalSelf;this.portalUrl=a.portalUrl},_setPointBarrierLayerAttr:function(a){this.pointBarrierLayer=a;this.emit("update-layer-options",
{pointBarrierLayer:this.pointBarrierLayer})},_setPointBarriersAttr:function(a){this.pointBarriers=a.filter(function(b){return c.isPoint(b)})},_setLineBarrierLayerAttr:function(a){this.lineBarrierLayer=a;this.emit("update-layer-options",{lineBarrierLayer:this.lineBarrierLayer})},_setLineBarriersAttr:function(a){this.lineBarriers=a.filter(function(b){return c.isLine(b)})},_setPolygonBarrierLayerAttr:function(a){this.polygonBarrierLayer=a;this.emit("update-layer-options",{polygonBarrierLayer:this.polygonBarrierLayer})},
_setPolygonBarriersAttr:function(a){this.polygonBarriers=a.filter(function(b){return c.isPolygon(b)})},_getBarrierLayersAttr:function(){var a={};!1===this._hidden&&(this.pointBarrierLayer&&(a.pointBarrierLayer=this.pointBarrierLayer),this.lineBarrierLayer&&(a.lineBarrierLayer=this.lineBarrierLayer),this.polygonBarrierLayer&&(a.polygonBarrierLayer=this.polygonBarrierLayer));return a},_getBarrierTagsAttr:function(){var a="";var b=this.get("barrierLayers");b.pointBarrierLayer&&(a=a+", "+this.i18n.pointBarrier+
", "+this.pointBarrierLayer.name);b.lineBarrierLayer&&(a=a+", "+this.i18n.lineBarrier+", "+this.lineBarrierLayer.name);b.polygonBarrierLayer&&(a=a+", "+this.i18n.polygonBarrier+", "+this.polygonBarrierLayer.name);return a},_handleOptionsBtnClick:function(){this._hidden=!1;d.contains(this._optionsDiv,"disabled")?this._hidden=!0:d.contains(this._optionsDiv,"optionsClose")?(d.remove(this._optionsDiv,"optionsClose"),d.add(this._optionsDiv,"optionsOpen")):d.contains(this._optionsDiv,"optionsOpen")&&(d.remove(this._optionsDiv,
"optionsOpen"),d.add(this._optionsDiv,"optionsClose"))},_handlePointBarrierChange:function(a){this._currentSelectBox=this._pointBarrierSelect;this._currentLayersArray=this.pointBarriers;"browselayers"===a?this._createBrowseItems({browseValue:a,disabledSubResources:this.forbiddenLayers},{tags:["point"],geometryTypes:[f.GeometryTypes.Point]},this._pointBarrierSelect):this.set("pointBarrierLayer",this.pointBarriers[a])},_handleLineBarrierChange:function(a){this._currentSelectBox=this._lineBarrierSelect;
this._currentLayersArray=this.lineBarriers;"browselayers"===a?this._createBrowseItems({browseValue:a,disabledSubResources:this.forbiddenLayers},{tags:["line"],geometryTypes:[f.GeometryTypes.Line]},this._lineBarrierSelect):this.set("lineBarrierLayer",this.lineBarriers[a])},_handlePolygonBarrierChange:function(a){this._currentSelectBox=this._polygonBarrierSelect;this._currentLayersArray=this.polygonBarriers;"browselayers"===a?this._createBrowseItems({browseValue:a,disabledSubResources:this.forbiddenLayers},
{tags:["polygon"],geometryTypes:[f.GeometryTypes.Polygon]},this._polygonBarrierSelect):this.set("polygonBarrierLayer",this.polygonBarriers[a])},_handleBrowseItemsSelect:function(a,b){a&&a.selection&&c.addAnalysisReadyLayer({item:a.selection,layers:this._currentLayersArray,layersSelect:this._currentSelectBox,browseDialog:a.dialog,widget:this},b).then(g.hitch(this,function(l){var e=[];l&&(e=this._currentSelectBox.get("options"),this._currentSelectBox.removeOption(e),e.splice(1,0,{type:"separator"}),
this._currentSelectBox.addOption(e))}))}});t("extend-esri")&&g.setObject("esri.dijit.analysis.components.AddBarrierLayers.AddBarrierLayers",k,m);return k});