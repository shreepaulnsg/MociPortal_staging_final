// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/3.38/esri/copyright.txt for details.
//>>built
define("esri/dijit/analysis/GPWidgetViewModel","dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has dojo/json dojo/Stateful ./customgp/utils ../../arcgis/Portal ../../kernel ../../lang".split(" "),function(d,c,k,l,p,m,e,f,n,q){d=d([m],{declaredClass:"esri.dijit.analysis.GPWidgetViewModel",constructor:function(a){this.watch("taskUrl",c.hitch(this,this.fetchTaskInfo));this.watch("portalUrl",c.hitch(this,this.initPortal));this.watch("portalSelf",c.hitch(this,this.initPortal))},_taskUrlSetter:function(a){this.taskUrl=
a},_taskInfoSetter:function(a){this.taskInfo=a},_serverInfoSetter:function(a){this.serverInfo=a},_inputParamsSetter:function(a){this.inputParams=a},_outputParamsSetter:function(a){this.outputParams=a},_nameSetter:function(a){this.name=a},_titleSetter:function(a){this.title=a},_mapSetter:function(a){this.map=a},_analysisLayersSetter:function(a){this.analysisLayers=a},_portalUrlSetter:function(a){this.portalUrl=a},_portalSelfSetter:function(a){this.portalSelf=a},_helpUrlSetter:function(a){this.helpUrl=
a},_useResultMapServerSetter:function(a){this.useResultMapServer=a},fetchTaskInfo:function(){this.taskUrl&&e.getServiceDescription(this.taskUrl).then(c.hitch(this,function(a){this.set("taskInfo",a);this.set("serverInfo",a.serverInfo);this.set("title",a.displayName);this.set("name",this.taskUrl.substring(this.taskUrl.indexOf("GPServer/")+9));this.set("helpUrl",a.helpUrl);this.set("useResultMapServer",a.useResultMapServer);var g=[],h=[];k.forEach(a.parameters,function(b){b.label=b.displayName;delete b.displayName;
"esriGPParameterDirectionInput"===b.direction?g.push(b):h.push(b);delete b.direction;b.visible=!0;b.required="esriGPParameterTypeRequired"===b.parameterType?!0:!1;delete b.parameterType;"GPFeatureRecordSetLayer"===b.dataType&&(b.analysisLayers=this.analysisLayers,b.featureSetMode="layers")},this);this.set("gp",this.taskUrl);this.set("inputParams",g);this.set("outputParams",h)}),c.hitch(this,function(a){console.log("Error fetching GP Task",a)}))},initPortal:function(){if(this.portalUrl||this.portalSelf)this.portal=
this.portalSelf?new f.Portal({url:this.portalUrl,self:this.portalSelf}):new f.Portal(this.portalUrl),this.portal.signIn().then(c.hitch(this,function(a){this.user=a}),c.hitch(this,function(a){console.log("Error signing into portal",a)}))},checkServiceNameAvailable:function(a){return e.checkServiceNameAvailable(this.user,this.portalUrl,a)}});l("extend-esri")&&c.setObject("dijit.analysis.GPWidgetViewModel",d,n);return d});