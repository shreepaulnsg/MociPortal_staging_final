// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/3.38/esri/copyright.txt for details.
//>>built
require({cache:{"url:esri/dijit/analysis/templates/BuildMultiVariablesList.html":'\x3cdiv class\x3d"esriAnalysis"\x3e\r\n    \x3cdiv data-dojo-type\x3d"dijit/layout/ContentPane" style\x3d"padding:1px;width:100%;"\x3e\r\n      \x3ctable class\x3d"esriFormTable" style\x3d"width:100%;"\x3e\r\n        \x3ctbody\x3e\r\n            \x3ctr\x3e\r\n                \x3ctd colspan\x3d"2"\x3e\r\n                  \x3clabel\x3e${i18n.chooseInputLayer}\x3c/label\x3e\r\n                \x3c/td\x3e\r\n                \x3ctd class\x3d"shortTextInput"\x3e\r\n                  \x3ca href\x3d"#" class\x3d\'esriFloatTrailing helpIcon\' esriHelpTopic\x3d"addVariablesWindow"\x3e\x3c/a\x3e\r\n                \x3c/td\x3e\r\n            \x3c/tr\x3e\r\n            \x3ctr\x3e\r\n                \x3ctd colspan\x3d"3" style\x3d"padding-top:0;" data-dojo-attach-point\x3d"_inputLayerTd"\x3e\r\n                \x3c/td\x3e\r\n            \x3c/tr\x3e\r\n            \x3ctr data-dojo-attach-point\x3d"_inputWarnMsgRow" style\x3d"display:none;"\x3e\r\n              \x3ctd colspan\x3d"3"\x3e\r\n                \x3cdiv class\x3d"esriFormWarning esriRoundedBox" data-dojo-attach-point\x3d"_errorMessagePane" style\x3d"display:none;"\x3e\r\n                  \x3c!--\x3ca href\x3d"#" title\x3d"${i18n.close}" class\x3d"esriFloatTrailing esriAnalysisCloseIcon" data-dojo-attach-event\x3d"onclick:_handleCloseMsg"\x3e\x3c/a\x3e--\x3e\r\n                  \x3cspan data-dojo-attach-point\x3d"_bodyNode"\x3e\x3c/span\x3e\r\n                \x3c/div\x3e\r\n              \x3c/td\x3e\r\n            \x3c/tr\x3e\r\n            \x3ctr\x3e\r\n              \x3ctd colspan\x3d"3" style\x3d"padding-top:2em;"\x3e\r\n                \x3cdiv class\x3d"esriLeadingMargin5 center buildMVGAddVariableCtr"\x3e\r\n                  \x3clabel\x3e${i18n.addAVar}\x3c/label\x3e\r\n                  \x3cdiv class\x3d"esriLeadingMargin3 esri-icon-plus-circled addVariableAction" data-dojo-attach-point\x3d"_addBtn"\x3e\x3c/div\x3e\r\n                \x3c/div\x3e\r\n              \x3c/td\x3e\r\n            \x3c/tr\x3e\r\n            \x3ctr data-dojo-attach-point\x3d"_variableWarnMsgRow" style\x3d"display:none;"\x3e\r\n              \x3ctd colspan\x3d"3"\x3e\r\n                \x3cdiv class\x3d"esriFormWarning esriRoundedBox" data-dojo-attach-point\x3d"_variableErrorPane" style\x3d"display:none;"\x3e\r\n                  \x3c!--\x3ca href\x3d"#" title\x3d"${i18n.close}" class\x3d"esriFloatTrailing esriAnalysisCloseIcon" data-dojo-attach-event\x3d"onclick:_handleCloseMsg"\x3e\x3c/a\x3e--\x3e\r\n                  \x3cspan data-dojo-attach-point\x3d"_variableBodyNode"\x3e\x3c/span\x3e\r\n                \x3c/div\x3e\r\n              \x3c/td\x3e\r\n            \x3c/tr\x3e\r\n        \x3c/tbody\x3e\r\n      \x3c/table\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"_cardContainer" class\x3d"variableListContainer"\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e\r\n'}});
define("esri/dijit/analysis/BuildMultiVariablesList","require dojo/aspect dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/json dojo/has dojo/json dojo/string dojo/dom-style dojo/dom-attr dojo/dom-construct dojo/query dojo/dom-class dojo/on dojo/_base/fx dojo/fx/easing dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dijit/_OnDijitClickMixin dijit/_FocusMixin dijit/registry dijit/form/Button dijit/form/CheckBox dijit/form/Form dijit/form/Select dijit/form/TextBox dijit/form/ToggleButton dijit/form/ValidationTextBox dijit/form/NumberTextBox dijit/layout/ContentPane dijit/form/FilteringSelect dijit/Dialog dijit/TitlePane dijit/InlineEditBox ../../kernel ../../lang ./utils ./Card ./MultiVariableForm ./customgp/editors/SelectFeatureSetFromLayer dojo/i18n!../../nls/jsapi dojo/i18n!./nls/BuildMultiVariablesList dojo/text!./templates/BuildMultiVariablesList.html".split(" "),
function(m,N,u,e,f,v,O,w,P,Q,k,x,g,R,S,n,p,q,y,z,A,B,C,r,T,U,D,V,W,X,E,Y,Z,aa,ba,ca,da,F,t,G,H,I,J,K,L,M){m=u([y,z,A,B,C],{declaredClass:"esri.dijit.analysis.BuildMultiVariablesList",templateString:M,widgetsInTemplate:!0,i18n:null,constructor:function(a){this._pbConnects=[];a.containerNode&&(this.container=a.containerNode);this.variableUIMap=a.variableUIMap||[];this.cards=a.cards||[]},destroy:function(){this.inherited(arguments);f.forEach(this._pbConnects,v.disconnect);delete this._pbConnects},postMixInProperties:function(){this.inherited(arguments);
this.i18n=e.mixin({},L);e.mixin(this.i18n,K.common)},postCreate:function(){this.inherited(arguments);this._loadConnections();G.initHelpLinks(this.domNode,!0);this._inputParam=new J({cssClass:{featureSetSelect:"esriTableFixedLayout fullSpread esriLongLabel esriAnalysisSelect",layerChooseCtr:""},param:{},widgetUID:void 0,widget:this,config:{showDrawOption:!1,portalUrl:this.portalUrl,analysisLayers:this.inputLayers,analysisLayer:this.inputLayer,showGeoAnalyticsParams:this.showGeoAnalyticsParams},appConfig:void 0,
map:this.map,nls:this.i18n,editorManager:null,style:{width:"100%"}});this._inputLayerTd.appendChild(this._inputParam.domNode);this.inputLayer||(this.inputLayer=this._inputParam.analysisLayer);this.inputLayer&&this._handleLayerChange({analysisLayer:this.inputLayer});this.own(this._inputParam.on("analysislayer-change",e.hitch(this,this._handleLayerChange)));this.mode||(this.set("mode","add"),this._handleModeChange())},startup:function(){},reset:function(){this._inputParam.spatialFilterByFeatures.reset();
this._removeCards()},_loadConnections:function(){this.own(n(this._addBtn,"click",e.hitch(this,this._handleAddBtnClick)),this.watch("layerVariables",e.hitch(this,this._handleLayerVariablesChange)),this.watch("mode",e.hitch(this,this._handleModeChange)))},_createCard:function(){var a={};var b=this._createCardHeader(a);a.hForm=r.getEnclosingWidget(b);var c=this._createCardContent(a);a.vForm=r.getEnclosingWidget(c);b=new H({header:b,content:c});c=g.create("div",{style:"padding: 1em;"},this._cardContainer);
c.appendChild(b.domNode);a.card=b;a.cardDiv=c;return a},_removeCard:function(a,b){a&&a.card&&(b&&(b=f.indexOf(this.cards,a),this.cards.splice(b,1)),a.card.destroy(),g.destroy(a.cardDiv),a=null)},_removeCards:function(){f.forEach(this.cards,function(a){this._removeCard(a)},this);this.cards=[]},_createCardHeader:function(a){var b=new D({},g.create("div",null)),c=new E({trim:!0,required:!0,"class":"longTextInput esriLeadingMargin1"}),d=g.create("a",{title:this.i18n.remove,"class":"esriLeadingMargin1 esri-icon-minus-circled addVariableAction"});
a.deleteHandle=n(d,"click",e.hitch(this,this._handleRemoveButtonClick,a));c.startup();b.domNode.appendChild(c.domNode);b.domNode.appendChild(d);return b.domNode},_createCardContent:function(a){a=new I({inputLayer:this._inputParam.get("analysisLayer"),outFieldName:a.hForm.domNode.elements[1].value,binSize:this.get("binSize"),binSizeUnit:this.get("binSizeUnit"),portalUrl:this.portalUrl,showGeoAnalyticsParams:this.showGeoAnalyticsParams},g.create("div",null));a.startup();return a.domNode},_validate:function(){return f.every(this.cards,
function(a){return a&&a.hForm.validate()&&a.vForm.validate()})},validate:function(a){var b={msgRow:this._variableWarnMsgRow,msgNode:this._variableBodyNode,errorPane:this._variableErrorPane},c=!0;this._handleCloseMsg(null,b);a||this.cards&&0!==this.cards.length?(c=this._validate(),a=this.i18n.validationErrorMsg):(c=!1,a=this.i18n.atleastOneVarMsg);c||this._showMessages(a,b);return c},_handleLayerChange:function(a){a&&a.analysisLayer&&this.inputLayer!==a.analysisLayer&&(this.inputLayer=a.analysisLayer,
this._removeCards())},_handleAddBtnClick:function(){this.validate(!0)&&this.cards.push(this._createCard())},_handleRemoveButtonClick:function(a,b){b.stopPropagation();b.preventDefault();this._removeCard(a,!0)},_handleLayerVariablesChange:function(a,b,c){c&&t.isDefined(c.layer)&&c.variables&&(this.reset(),this._inputParam.spatialFilterByFeatures.set("value",c.layer+1),f.forEach(c.variables,function(d){var h=this._createCard();h.hForm.domNode.elements[1].value=d.outFieldName;h.vForm.set("variable",
d);this.cards.push(h)},this))},_handleModeChange:function(a,b,c){this._inputParam&&this._inputParam.spatialFilterByFeatures&&this._inputParam.spatialFilterByFeatures.set("disabled","edit"===this.mode);"add"===this.mode?this._showMessages(this.i18n.layerChangeWarnMsg):this._handleCloseMsg()},_showMessages:function(a,b){var c=b&&b.msgNode||this._bodyNode,d=b&&b.errorPane||this._errorMessagePane;k.set(b&&b.msgRow||this._inputWarnMsgRow,"display","table-row");x.set(c,"innerHTML",a);p.fadeIn({node:d,easing:q.quadIn,
onEnd:e.hitch(this,function(){k.set(d,{display:""})})}).play()},_handleCloseMsg:function(a,b){var c=b&&b.msgRow||this._inputWarnMsgRow,d=b&&b.errorPane||this._errorMessagePane;a&&a.preventDefault();k.set(c,"display","none");p.fadeOut({node:d,easing:q.quadOut,onEnd:e.hitch(this,function(){k.set(d,{display:"none"})})}).play()},_getBinSizeAttr:function(){return this.binSize},_setBinSizeAttr:function(a){this._set("binSize",a)},_getBinSizeUnitAttr:function(){return this.binSizeUnit},_setBinSizeUnitAttr:function(a){this._set("binSizeUnit",
a)},_setInputLayerAttr:function(a){this._set("inputLayer",a)},_getInputLayerAttr:function(){this._inputParam&&(this.inputLayer=this._inputParam.get("analysisLayer"));return this.inputLayer},_setModeAttr:function(a){this._set("mode",a)},_getLayerVariablesAttr:function(){var a=f.map(this.cards,function(d){d.vForm.set("outFieldName",d.hForm.domNode.elements[1].value);return d.vForm.get("variable")}),b=-1,c="";f.forEach(this.inputLayers,function(d,h){var l=this.get("inputLayer");if(d.name&&l.name&&d.name===
l.name||d.url&&l.url&&d.url===l.url)b=h,c=d.name},this);return{layer:b,variables:a,name:c}},_setLayerVariablesAttr:function(a){a&&t.isDefined(a.layer)&&a.variables&&(this._set("layerVariables",a),this._handleLayerVariablesChange("layerVariables",null,a))}});w("extend-esri")&&e.setObject("dijit.analysis.BuildMultiVariablesList",m,F);return m});