// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/3.38/esri/copyright.txt for details.
//>>built
require({cache:{"dojo/debounce":function(){define([],function(){return function(x,D){var n;return function(){n&&clearTimeout(n);var q=this,k=arguments;n=setTimeout(function(){x.apply(q,k)},D)}}})},"dijit/Menu":function(){define("require dojo/_base/array dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-geometry dojo/dom-style dojo/keys dojo/_base/lang dojo/on dojo/sniff dojo/_base/window dojo/window ./popup ./DropDownMenu dojo/ready".split(" "),function(x,D,n,q,k,t,g,e,c,r,m,A,l,B,y,f){m("dijit-legacy-requires")&&
f(0,function(){x(["dijit/MenuItem","dijit/PopupMenuItem","dijit/CheckedMenuItem","dijit/MenuSeparator"])});return n("dijit.Menu",y,{constructor:function(){this._bindings=[]},targetNodeIds:[],selector:"",contextMenuForWindow:!1,leftClickToOpen:!1,refocus:!0,postCreate:function(){this.contextMenuForWindow?this.bindDomNode(this.ownerDocumentBody):D.forEach(this.targetNodeIds,this.bindDomNode,this);this.inherited(arguments)},_iframeContentWindow:function(h){return l.get(this._iframeContentDocument(h))||
this._iframeContentDocument(h).__parent__||h.name&&document.frames[h.name]||null},_iframeContentDocument:function(h){return h.contentDocument||h.contentWindow&&h.contentWindow.document||h.name&&document.frames[h.name]&&document.frames[h.name].document||null},bindDomNode:function(h){h=q.byId(h,this.ownerDocument);if("iframe"==h.tagName.toLowerCase()){var w=h;var u=this._iframeContentWindow(w);u=A.body(u.document)}else u=h==A.body(this.ownerDocument)?this.ownerDocument.documentElement:h;var v={node:h,
iframe:w};k.set(h,"_dijitMenu"+this.id,this._bindings.push(v));var z=c.hitch(this,function(I){var G=this.selector,J=G?function(E){return r.selector(G,E)}:function(E){return E},F=this;return[r(I,J(this.leftClickToOpen?"click":"contextmenu"),function(E){E.stopPropagation();E.preventDefault();(new Date).getTime()<F._lastKeyDown+500||F._scheduleOpen(this,w,{x:E.pageX,y:E.pageY},E.target)}),r(I,J("keydown"),function(E){if(93==E.keyCode||E.shiftKey&&E.keyCode==e.F10||F.leftClickToOpen&&E.keyCode==e.SPACE)E.stopPropagation(),
E.preventDefault(),F._scheduleOpen(this,w,null,E.target),F._lastKeyDown=(new Date).getTime()})]});v.connects=u?z(u):[];w&&(v.onloadHandler=c.hitch(this,function(){var I=this._iframeContentWindow(w);I=A.body(I.document);v.connects=z(I)}),w.addEventListener?w.addEventListener("load",v.onloadHandler,!1):w.attachEvent("onload",v.onloadHandler))},unBindDomNode:function(h){try{var w=q.byId(h,this.ownerDocument)}catch(I){return}h="_dijitMenu"+this.id;if(w&&k.has(w,h)){for(var u=k.get(w,h)-1,v=this._bindings[u],
z;z=v.connects.pop();)z.remove();(z=v.iframe)&&(z.removeEventListener?z.removeEventListener("load",v.onloadHandler,!1):z.detachEvent("onload",v.onloadHandler));k.remove(w,h);delete this._bindings[u]}},_scheduleOpen:function(h,w,u,v){this._openTimer||(this._openTimer=this.defer(function(){delete this._openTimer;this._openMyself({target:v,delegatedTarget:h,iframe:w,coords:u})},1))},_openMyself:function(h){function w(){E.refocus&&Q&&Q.focus();B.close(E)}var u=h.target,v=h.iframe,z=h.coords,I=!z;this.currentTarget=
h.delegatedTarget;if(z){if(v){h=t.position(v,!0);u=this._iframeContentWindow(v);u=t.docScroll(u.document);var G=g.getComputedStyle(v),J=g.toPixelValue,F=(m("ie")&&m("quirks")?0:J(v,G.paddingLeft))+(m("ie")&&m("quirks")?J(v,G.borderLeftWidth):0);v=(m("ie")&&m("quirks")?0:J(v,G.paddingTop))+(m("ie")&&m("quirks")?J(v,G.borderTopWidth):0);z.x+=h.x+F-u.x;z.y+=h.y+v-u.y}}else z=t.position(u,!0),z.x+=10,z.y+=10;var E=this;v=this._focusManager.get("prevNode");h=this._focusManager.get("curNode");var Q=!h||
q.isDescendant(h,this.domNode)?v:h;B.open({popup:this,x:z.x,y:z.y,onExecute:w,onCancel:w,orient:this.isLeftToRight()?"L":"R"});this.focus();I||this.defer(function(){this._cleanUp(!0)});this._onBlur=function(){this.inherited("_onBlur",arguments);B.close(this)}},destroy:function(){D.forEach(this._bindings,function(h){h&&this.unBindDomNode(h.node)},this);this.inherited(arguments)}})})},"dijit/DropDownMenu":function(){define(["dojo/_base/declare","dojo/keys","dojo/text!./templates/Menu.html","./_MenuBase"],
function(x,D,n,q){return x("dijit.DropDownMenu",q,{templateString:n,baseClass:"dijitMenu",_onUpArrow:function(){this.focusPrev()},_onDownArrow:function(){this.focusNext()},_onRightArrow:function(k){this._moveToPopup(k);k.stopPropagation();k.preventDefault()},_onLeftArrow:function(k){if(this.parentMenu)if(this.parentMenu._isMenuBar)this.parentMenu.focusPrev();else this.onCancel(!1);else k.stopPropagation(),k.preventDefault()}})})},"dijit/_MenuBase":function(){define("dojo/_base/array dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-class dojo/_base/lang dojo/mouse dojo/on dojo/window ./a11yclick ./registry ./_Widget ./_CssStateMixin ./_KeyNavContainer ./_TemplatedMixin".split(" "),
function(x,D,n,q,k,t,g,e,c,r,m,A,l,B,y){return D("dijit._MenuBase",[A,y,B,l],{selected:null,_setSelectedAttr:function(f){this.selected!=f&&(this.selected&&(this.selected._setSelected(!1),this._onChildDeselect(this.selected)),f&&f._setSelected(!0),this._set("selected",f))},activated:!1,_setActivatedAttr:function(f){k.toggle(this.domNode,"dijitMenuActive",f);k.toggle(this.domNode,"dijitMenuPassive",!f);this._set("activated",f)},parentMenu:null,popupDelay:500,passivePopupDelay:Infinity,autoFocus:!1,
childSelector:function(f){var h=m.byNode(f);return f.parentNode==this.containerNode&&h&&h.focus},postCreate:function(){var f=this,h="string"==typeof this.childSelector?this.childSelector:t.hitch(this,"childSelector");this.own(e(this.containerNode,e.selector(h,g.enter),function(){f.onItemHover(m.byNode(this))}),e(this.containerNode,e.selector(h,g.leave),function(){f.onItemUnhover(m.byNode(this))}),e(this.containerNode,e.selector(h,r),function(w){f.onItemClick(m.byNode(this),w);w.stopPropagation()}),
e(this.containerNode,e.selector(h,"focusin"),function(){f._onItemFocus(m.byNode(this))}));this.inherited(arguments)},onKeyboardSearch:function(f,h,w,u){this.inherited(arguments);if(f&&(-1==u||f.popup&&1==u))this.onItemClick(f,h)},_keyboardSearchCompare:function(f,h){return f.shortcutKey?h==f.shortcutKey.toLowerCase()?-1:0:this.inherited(arguments)?1:0},onExecute:function(){},onCancel:function(){},_moveToPopup:function(f){if(this.focusedChild&&this.focusedChild.popup&&!this.focusedChild.disabled)this.onItemClick(this.focusedChild,
f);else(f=this._getTopMenu())&&f._isMenuBar&&f.focusNext()},_onPopupHover:function(){this.set("selected",this.currentPopupItem);this._stopPendingCloseTimer()},onItemHover:function(f){this.activated?(this.set("selected",f),!f.popup||f.disabled||this.hover_timer||(this.hover_timer=this.defer(function(){this._openItemPopup(f)},this.popupDelay))):Infinity>this.passivePopupDelay&&(this.passive_hover_timer&&this.passive_hover_timer.remove(),this.passive_hover_timer=this.defer(function(){this.onItemClick(f,
{type:"click"})},this.passivePopupDelay));this._hoveredChild=f;f._set("hovering",!0)},_onChildDeselect:function(f){this._stopPopupTimer();this.currentPopupItem==f&&(this._stopPendingCloseTimer(),this._pendingClose_timer=this.defer(function(){this.currentPopupItem=this._pendingClose_timer=null;f._closePopup()},this.popupDelay))},onItemUnhover:function(f){this._hoveredChild==f&&(this._hoveredChild=null);this.passive_hover_timer&&(this.passive_hover_timer.remove(),this.passive_hover_timer=null);f._set("hovering",
!1)},_stopPopupTimer:function(){this.hover_timer&&(this.hover_timer=this.hover_timer.remove())},_stopPendingCloseTimer:function(){this._pendingClose_timer&&(this._pendingClose_timer=this._pendingClose_timer.remove())},_getTopMenu:function(){for(var f=this;f.parentMenu;f=f.parentMenu);return f},onItemClick:function(f,h){this.passive_hover_timer&&this.passive_hover_timer.remove();this.focusChild(f);if(f.disabled)return!1;f.popup?(this.set("selected",f),this.set("activated",!0),h=/^key/.test(h._origType||
h.type)||0==h.clientX&&0==h.clientY,this._openItemPopup(f,h)):(this.onExecute(),f._onClick?f._onClick(h):f.onClick(h))},_openItemPopup:function(f,h){if(f!=this.currentPopupItem){this.currentPopupItem&&(this._stopPendingCloseTimer(),this.currentPopupItem._closePopup());this._stopPopupTimer();var w=f.popup;w.parentMenu=this;this.own(this._mouseoverHandle=e.once(w.domNode,"mouseover",t.hitch(this,"_onPopupHover")));var u=this;f._openPopup({parent:this,orient:this._orient||["after","before"],onCancel:function(){h&&
u.focusChild(f);u._cleanUp()},onExecute:t.hitch(this,"_cleanUp",!0),onClose:function(){u._mouseoverHandle&&(u._mouseoverHandle.remove(),delete u._mouseoverHandle)}},h);this.currentPopupItem=f}},onOpen:function(){this.isShowingNow=!0;this.set("activated",!0)},onClose:function(){this.set("activated",!1);this.set("selected",null);this.isShowingNow=!1;this.parentMenu=null},_closeChild:function(){this._stopPopupTimer();this.currentPopupItem&&(this.focused&&(q.set(this.selected.focusNode,"tabIndex",this.tabIndex),
this.selected.focusNode.focus()),this.currentPopupItem._closePopup(),this.currentPopupItem=null)},_onItemFocus:function(f){if(this._hoveredChild&&this._hoveredChild!=f)this.onItemUnhover(this._hoveredChild);this.set("selected",f)},_onBlur:function(){this._cleanUp(!0);this.inherited(arguments)},_cleanUp:function(f){this._closeChild();"undefined"==typeof this.isShowingNow&&this.set("activated",!1);f&&this.set("selected",null)}})})},"dijit/_KeyNavContainer":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-attr dojo/_base/kernel dojo/keys dojo/_base/lang ./registry ./_Container ./_FocusMixin ./_KeyNavMixin".split(" "),
function(x,D,n,q,k,t,g,e,c,r){return D("dijit._KeyNavContainer",[c,r,e],{connectKeyNavHandlers:function(m,A){var l=this._keyNavCodes={},B=t.hitch(this,"focusPrev"),y=t.hitch(this,"focusNext");x.forEach(m,function(f){l[f]=B});x.forEach(A,function(f){l[f]=y});l[k.HOME]=t.hitch(this,"focusFirstChild");l[k.END]=t.hitch(this,"focusLastChild")},startupKeyNavChildren:function(){q.deprecated("startupKeyNavChildren() call no longer needed","","2.0")},startup:function(){this.inherited(arguments);x.forEach(this.getChildren(),
t.hitch(this,"_startupChild"))},addChild:function(m,A){this.inherited(arguments);this._startupChild(m)},_startupChild:function(m){m.set("tabIndex","-1")},_getFirst:function(){var m=this.getChildren();return m.length?m[0]:null},_getLast:function(){var m=this.getChildren();return m.length?m[m.length-1]:null},focusNext:function(){this.focusChild(this._getNextFocusableChild(this.focusedChild,1))},focusPrev:function(){this.focusChild(this._getNextFocusableChild(this.focusedChild,-1),!0)},childSelector:function(m){return(m=
g.byNode(m))&&m.getParent()==this}})})},"dijit/_KeyNavMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-attr dojo/keys dojo/_base/lang dojo/on dijit/registry dijit/_FocusMixin".split(" "),function(x,D,n,q,k,t,g,e){return D("dijit._KeyNavMixin",e,{tabIndex:"0",childSelector:null,postCreate:function(){this.inherited(arguments);n.set(this.domNode,"tabIndex",this.tabIndex);if(!this._keyNavCodes){var c=this._keyNavCodes={};c[q.HOME]=k.hitch(this,"focusFirstChild");c[q.END]=k.hitch(this,
"focusLastChild");c[this.isLeftToRight()?q.LEFT_ARROW:q.RIGHT_ARROW]=k.hitch(this,"_onLeftArrow");c[this.isLeftToRight()?q.RIGHT_ARROW:q.LEFT_ARROW]=k.hitch(this,"_onRightArrow");c[q.UP_ARROW]=k.hitch(this,"_onUpArrow");c[q.DOWN_ARROW]=k.hitch(this,"_onDownArrow")}var r=this;c="string"==typeof this.childSelector?this.childSelector:k.hitch(this,"childSelector");this.own(t(this.domNode,"keypress",k.hitch(this,"_onContainerKeypress")),t(this.domNode,"keydown",k.hitch(this,"_onContainerKeydown")),t(this.domNode,
"focus",k.hitch(this,"_onContainerFocus")),t(this.containerNode,t.selector(c,"focusin"),function(m){r._onChildFocus(g.getEnclosingWidget(this),m)}))},_onLeftArrow:function(){},_onRightArrow:function(){},_onUpArrow:function(){},_onDownArrow:function(){},focus:function(){this.focusFirstChild()},_getFirstFocusableChild:function(){return this._getNextFocusableChild(null,1)},_getLastFocusableChild:function(){return this._getNextFocusableChild(null,-1)},focusFirstChild:function(){this.focusChild(this._getFirstFocusableChild())},
focusLastChild:function(){this.focusChild(this._getLastFocusableChild())},focusChild:function(c,r){c&&(this.focusedChild&&c!==this.focusedChild&&this._onChildBlur(this.focusedChild),c.set("tabIndex",this.tabIndex),c.focus(r?"end":"start"))},_onContainerFocus:function(c){c.target!==this.domNode||this.focusedChild||this.focus()},_onFocus:function(){n.set(this.domNode,"tabIndex","-1");this.inherited(arguments)},_onBlur:function(c){n.set(this.domNode,"tabIndex",this.tabIndex);this.focusedChild&&(this.focusedChild.set("tabIndex",
"-1"),this.lastFocusedChild=this.focusedChild,this._set("focusedChild",null));this.inherited(arguments)},_onChildFocus:function(c){c&&c!=this.focusedChild&&(this.focusedChild&&!this.focusedChild._destroyed&&this.focusedChild.set("tabIndex","-1"),c.set("tabIndex",this.tabIndex),this.lastFocused=c,this._set("focusedChild",c))},_searchString:"",multiCharSearchDuration:1E3,onKeyboardSearch:function(c,r,m,A){c&&this.focusChild(c)},_keyboardSearchCompare:function(c,r){var m=c.domNode;c=(c.label||(m.focusNode?
m.focusNode.label:"")||m.innerText||m.textContent||"").replace(/^\s+/,"").substr(0,r.length).toLowerCase();return r.length&&c==r?-1:0},_isFormElement:function(c){return"INPUT"===c.tagName||"TEXTAREA"===c.tagName||"SELECT"===c.tagName||"BUTTON"===c.tagName},_onContainerKeydown:function(c){if(!this._isFormElement(document.activeElement)){var r=this._keyNavCodes[c.keyCode];r?(r(c,this.focusedChild),c.stopPropagation(),c.preventDefault(),this._searchString=""):c.keyCode!=q.SPACE||!this._searchTimer||
c.ctrlKey||c.altKey||c.metaKey||(c.stopImmediatePropagation(),c.preventDefault(),this._keyboardSearch(c," "))}},_onContainerKeypress:function(c){this._isFormElement(document.activeElement)||c.charCode<=q.SPACE||c.ctrlKey||c.altKey||c.metaKey||(c.preventDefault(),c.stopPropagation(),this._keyboardSearch(c,String.fromCharCode(c.charCode).toLowerCase()))},_keyboardSearch:function(c,r){var m=null,A,l=0;k.hitch(this,function(){this._searchTimer&&this._searchTimer.remove();this._searchString+=r;var B=/^(.)\1*$/.test(this._searchString)?
1:this._searchString.length;A=this._searchString.substr(0,B);this._searchTimer=this.defer(function(){this._searchTimer=null;this._searchString=""},this.multiCharSearchDuration);var y=this.focusedChild||null;if(1==B||!y)if(y=this._getNextFocusableChild(y,1),!y)return;B=y;do{var f=this._keyboardSearchCompare(y,A);f&&0==l++&&(m=y);if(-1==f){l=-1;break}y=this._getNextFocusableChild(y,1)}while(y&&y!=B)})();this.onKeyboardSearch(m,c,A,l)},_onChildBlur:function(){},_getNextFocusableChild:function(c,r){var m=
c;do{if(c)c=this._getNext(c,r);else if(c=this[0<r?"_getFirst":"_getLast"](),!c)break;if(null!=c&&c!=m&&c.isFocusable())return c}while(c!=m);return null},_getFirst:function(){return null},_getLast:function(){return null},_getNext:function(c,r){if(c)for(c=c.domNode;c;)if((c=c[0>r?"previousSibling":"nextSibling"])&&"getAttribute"in c){var m=g.byNode(c);if(m)return m}return null}})})},"dijit/MenuItem":function(){define("dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-class dojo/_base/kernel dojo/sniff dojo/_base/lang ./_Widget ./_TemplatedMixin ./_Contained ./_CssStateMixin dojo/text!./templates/MenuItem.html".split(" "),
function(x,D,n,q,k,t,g,e,c,r,m,A){g=x("dijit.MenuItem"+(t("dojo-bidi")?"_NoBidi":""),[e,c,r,m],{templateString:A,baseClass:"dijitMenuItem",label:"",_setLabelAttr:function(l){this._set("label",l);var B="";var y=l.search(/{\S}/);if(0<=y){B=l.charAt(y+1);var f=l.substr(0,y);l=l.substr(y+3);y=f+B+l;l=f+'\x3cspan class\x3d"dijitMenuItemShortcutKey"\x3e'+B+"\x3c/span\x3e"+l}else y=l;this.domNode.setAttribute("aria-label",y+" "+this.accelKey);this.containerNode.innerHTML=l;this._set("shortcutKey",B)},iconClass:"dijitNoIcon",
_setIconClassAttr:{node:"iconNode",type:"class"},accelKey:"",disabled:!1,_fillContent:function(l){!l||"label"in this.params||this._set("label",l.innerHTML)},buildRendering:function(){this.inherited(arguments);n.set(this.containerNode,"id",this.id+"_text");this.accelKeyNode&&n.set(this.accelKeyNode,"id",this.id+"_accel");D.setSelectable(this.domNode,!1)},onClick:function(){},focus:function(){try{8==t("ie")&&this.containerNode.focus(),this.focusNode.focus()}catch(l){}},_setSelected:function(l){q.toggle(this.domNode,
"dijitMenuItemSelected",l)},setLabel:function(l){k.deprecated("dijit.MenuItem.setLabel() is deprecated.  Use set('label', ...) instead.","","2.0");this.set("label",l)},setDisabled:function(l){k.deprecated("dijit.Menu.setDisabled() is deprecated.  Use set('disabled', bool) instead.","","2.0");this.set("disabled",l)},_setDisabledAttr:function(l){this.focusNode.setAttribute("aria-disabled",l?"true":"false");this._set("disabled",l)},_setAccelKeyAttr:function(l){this.accelKeyNode&&(this.accelKeyNode.style.display=
l?"":"none",this.accelKeyNode.innerHTML=l,n.set(this.containerNode,"colSpan",l?"1":"2"));this._set("accelKey",l)}});t("dojo-bidi")&&(g=x("dijit.MenuItem",g,{_setLabelAttr:function(l){this.inherited(arguments);"auto"===this.textDir&&this.applyTextDir(this.textDirNode)}}));return g})},"dijit/_Contained":function(){define(["dojo/_base/declare","./registry"],function(x,D){return x("dijit._Contained",null,{_getSibling:function(n){var q=this.getParent();return q&&q._getSiblingOfChild&&q._getSiblingOfChild(this,
"previous"==n?-1:1)||null},getPreviousSibling:function(){return this._getSibling("previous")},getNextSibling:function(){return this._getSibling("next")},getIndexInParent:function(){var n=this.getParent();return n&&n.getIndexOfChild?n.getIndexOfChild(this):-1}})})},"esri/tasks/AreasAndLengthsParameters":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/has ../kernel".split(" "),function(x,D,n,q,k,t){x=x(null,{declaredClass:"esri.tasks.AreasAndLengthsParameters",
polygons:null,lengthUnit:null,areaUnit:null,calculationType:null,toJson:function(){var g=n.map(this.polygons,function(c){return c.toJson()}),e={};e.polygons=q.toJson(g);g=this.polygons[0].spatialReference;e.sr=g.wkid?g.wkid:q.toJson(g.toJson());this.lengthUnit&&(e.lengthUnit=this.lengthUnit);this.areaUnit&&(D.isString(this.areaUnit)?e.areaUnit=q.toJson({areaUnit:this.areaUnit}):e.areaUnit=this.areaUnit);this.calculationType&&(e.calculationType=this.calculationType);return e}});k("extend-esri")&&D.setObject("tasks.AreasAndLengthsParameters",
x,t);return x})},"esri/tasks/LengthsParameters":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/has ../kernel".split(" "),function(x,D,n,q,k,t){x=x(null,{declaredClass:"esri.tasks.LengthsParameters",polylines:null,lengthUnit:null,geodesic:null,calculationType:null,toJson:function(){var g=n.map(this.polylines,function(c){return c.toJson()}),e={};e.polylines=q.toJson(g);g=this.polylines[0].spatialReference;e.sr=g.wkid?g.wkid:q.toJson(g.toJson());this.lengthUnit&&
(e.lengthUnit=this.lengthUnit);this.geodesic&&(e.geodesic=this.geodesic);this.calculationType&&(e.calculationType=this.calculationType);return e}});k("extend-esri")&&D.setObject("tasks.LengthsParameters",x,t);return x})},"esri/numberUtils":function(){define(["dojo/has","dojo/number","dojo/i18n!dojo/cldr/nls/number","./kernel"],function(x,D,n,q){var k=function(g,e){return g-e},t={_reNumber:/^-?(\d+)(\.(\d+))?$/i,getDigits:function(g){var e=String(g),c=e.match(t._reNumber);g={integer:0,fractional:0};
c&&c[1]?(g.integer=c[1].split("").length,g.fractional=c[3]?c[3].split("").length:0):-1<e.toLowerCase().indexOf("e")&&(c=e.split("e"),e=c[0],c=c[1],e&&c&&(e=Number(e),c=Number(c),(g=0<c)||(c=Math.abs(c)),e=t.getDigits(e),g?(e.integer+=c,e.fractional=c>e.fractional?0:e.fractional-c):(e.fractional+=c,e.integer=c>e.integer?1:e.integer-c),g=e));return g},getFixedNumbers:function(g,e){var c=Number(g.toFixed(e));c<g?g=c+1/Math.pow(10,e):(g=c,c-=1/Math.pow(10,e));c=Number(c.toFixed(e));g=Number(g.toFixed(e));
return[c,g]},getPctChange:function(g,e,c,r){var m={prev:null,next:null};if(null!=c){var A=g-c;m.prev=Math.floor(Math.abs(100*(e-c-A)/A))}null!=r&&(A=r-g,m.next=Math.floor(Math.abs(100*(r-e-A)/A)));return m},round:function(g,e){g=g.slice(0);var c,r,m=e&&null!=e.tolerance?e.tolerance:2,A=e&&e.indexes,l=e&&null!=e.strictBounds?e.strictBounds:!1;if(A)A.sort(k);else for(A=[],c=0;c<g.length;c++)A.push(c);for(c=0;c<A.length;c++){var B=A[c];e=g[B];var y=0===B?null:g[B-1];var f=B===g.length-1?null:g[B+1];
var h=t.getDigits(e);if(h=h.fractional){var w=0;for(r=!1;w<=h&&!r;){var u=t.getFixedNumbers(e,w);u=l&&0===c?u[1]:u[0];r=t.hasMinimalChange(e,u,y,f,m);w++}r&&(g[B]=u)}}return g},hasMinimalChange:function(g,e,c,r,m){g=t.getPctChange(g,e,c,r);e=null==g.prev||g.prev<=m;c=null==g.next||g.next<=m;return e&&c||g.prev+g.next<=2*m},_reAllZeros:new RegExp("\\"+n.decimal+"0+$","g"),_reSomeZeros:/(\d)0*$/g,format:function(g,e){e=e||{places:20,round:-1};(g=D.format(g,e))&&(g=g.replace(t._reSomeZeros,"$1").replace(t._reAllZeros,
""));return g}};x("extend-esri")&&(q.numberUtils=t);return t})},"url:dijit/templates/Menu.html":'\x3ctable class\x3d"dijit dijitMenu dijitMenuPassive dijitReset dijitMenuTable" role\x3d"menu" tabIndex\x3d"${tabIndex}"\r\n\t   cellspacing\x3d"0"\x3e\r\n\t\x3ctbody class\x3d"dijitReset" data-dojo-attach-point\x3d"containerNode"\x3e\x3c/tbody\x3e\r\n\x3c/table\x3e\r\n',"url:dijit/templates/MenuItem.html":'\x3ctr class\x3d"dijitReset" data-dojo-attach-point\x3d"focusNode" role\x3d"menuitem" tabIndex\x3d"-1"\x3e\r\n\t\x3ctd class\x3d"dijitReset dijitMenuItemIconCell" role\x3d"presentation"\x3e\r\n\t\t\x3cspan role\x3d"presentation" class\x3d"dijitInline dijitIcon dijitMenuItemIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\x3e\r\n\t\x3c/td\x3e\r\n\t\x3ctd class\x3d"dijitReset dijitMenuItemLabel" colspan\x3d"2" data-dojo-attach-point\x3d"containerNode,textDirNode"\r\n\t\trole\x3d"presentation"\x3e\x3c/td\x3e\r\n\t\x3ctd class\x3d"dijitReset dijitMenuItemAccelKey" style\x3d"display: none" data-dojo-attach-point\x3d"accelKeyNode"\x3e\x3c/td\x3e\r\n\t\x3ctd class\x3d"dijitReset dijitMenuArrowCell" role\x3d"presentation"\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"arrowWrapper" style\x3d"visibility: hidden"\x3e\r\n\t\t\t\x3cspan class\x3d"dijitInline dijitIcon dijitMenuExpand"\x3e\x3c/span\x3e\r\n\t\t\t\x3cspan class\x3d"dijitMenuExpandA11y"\x3e+\x3c/span\x3e\r\n\t\t\x3c/span\x3e\r\n\t\x3c/td\x3e\r\n\x3c/tr\x3e\r\n',
"url:esri/dijit/templates/Measurement.html":"\x3cdiv class\x3d\"esriMeasurement\"\x3e\r\n  \x3cdiv dojoType\x3d'dijit.layout.ContentPane' class\x3d'esriMeasurementButtonContainer'\x3e\r\n    \x3cdiv dojoType\x3d'dijit.form.ToggleButton' baseClass\x3d'esriButton' dojoAttachPoint\x3d'_areaButton' iconClass\x3d'areaIcon' showLabel\x3d'false' dojoAttachEvent\x3d'onClick:_areaButtonToggle'\x3e\x3c/div\x3e\r\n    \x3cdiv dojoType\x3d'dijit.form.ToggleButton' baseClass\x3d'esriButton' dojoAttachPoint\x3d'_distanceButton' iconClass\x3d'distanceIcon' showLabel\x3d'false' dojoAttachEvent\x3d'onClick:_distanceButtonToggle'\x3e\x3c/div\x3e\r\n    \x3cdiv dojoType\x3d'dijit.form.ToggleButton' baseClass\x3d'esriButton' dojoAttachPoint\x3d'_locationButton' iconClass\x3d'locationIcon' showLabel\x3d'false' dojoAttachEvent\x3d'onClick:_locationButtonToggle'\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d\"esriMeasurementSeparator\"\x3e|\x3c/div\x3e\r\n    \x3cbutton dojoType\x3d'dijit.form.DropDownButton' baseClass\x3d'esriToggleButton' dojoAttachPoint\x3d'_unitDropDown' label\x3d'unit' value\x3d'unit' style\x3d'visibility:hidden;'\x3e\x3c/button\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv dojoType\x3d'dijit.layout.ContentPane' dojoAttachPoint\x3d'resultLabel' class\x3d'resultLabel esriMeasurementResultLabel'\x3e\x3c/div\x3e\r\n  \x3cdiv dojoType\x3d'dijit.layout.ContentPane' dojoAttachPoint\x3d'resultValueContainer' align\x3d'leading' class\x3d\"esriMeasurementResultValue\"\x3e\r\n    \x3cdiv dojoType\x3d'dijit.layout.ContentPane' dojoAttachPoint\x3d'resultValue' class\x3d'result'\x3e\x26nbsp;\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv dojoType\x3d'dijit.layout.ContentPane' dojoAttachPoint\x3d'resultTable' align\x3d'leading' class\x3d\"resultTable esriMeasurementTableContainer\" style\x3d\"display:none;\"\x3e\r\n    \x3ctable class\x3d\"esriMeasurementResultTable\"\x3e\r\n      \x3ctr\x3e\r\n        \x3ctd class\x3d\"esriMeasurementTableHeader\" colspan\x3d\"2\"\x3e${_NLS_Lat}\x3c/td\x3e\x3ctd class\x3d\"esriMeasurementTableHeader\"\x3e${_NLS_Lon}\x3c/td\x3e\r\n      \x3c/tr\x3e\r\n      \x3ctr class\x3d\"esriMeasurementTableRow\" dojoAttachPoint\x3d\"_mouseRow\"\x3e\r\n        \x3ctd dojoAttachPoint\x3d\"mouseCell\"\x3e\x3c/td\x3e\r\n        \x3ctd class\x3d\"esriMeasurementTableCell\"\x3e\r\n          \x3cspan dojoAttachPoint\x3d\"mouseLatitude\" dir\x3d'ltr'\x3e\x3c/span\x3e\r\n        \x3c/td\x3e\r\n        \x3ctd class\x3d\"esriMeasurementTableCell\"\x3e\r\n          \x3cspan dojoAttachPoint\x3d\"mouseLongitude\" dir\x3d'ltr'\x3e\x3c/span\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n      \x3ctr class\x3d\"esriMeasurementTableRow\"\x3e\r\n        \x3ctd dojoAttachPoint\x3d\"pinCell\"\x3e\x3c/td\x3e\r\n        \x3ctd class\x3d\"esriMeasurementTableCell\"\x3e\r\n          \x3cspan dojoAttachPoint\x3d\"markerLatitude\" dir\x3d'ltr'\x3e\x3c/span\x3e\r\n        \x3c/td\x3e\r\n        \x3ctd class\x3d\"esriMeasurementTableCell\"\x3e\r\n          \x3cspan dojoAttachPoint\x3d\"markerLongitude\" dir\x3d'ltr'\x3e\x3c/span\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n    \x3c/table\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e",
"*noref":1}});
define("esri/dijit/Measurement","require dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/Color dojo/debounce dojo/sniff dojo/dom-style dojo/dom-construct dojox/gfx dijit/_Widget dijit/registry dijit/Menu dijit/MenuItem ../symbols/PictureMarkerSymbol ../symbols/SimpleLineSymbol ../symbols/SimpleFillSymbol ../symbols/jsonUtils ../geometry/geodesicUtils ../geometry/webMercatorUtils ../geometry/Point ../geometry/Polyline ../geometry/Polygon ../graphic ../tasks/AreasAndLengthsParameters ../tasks/LengthsParameters ../tasks/GeometryService ../kernel ../config ../domUtils ../numberUtils ../lang ../units ../WKIDUnitConversion ../SpatialReference dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin ./_EventedWidget dojo/text!./templates/Measurement.html dojo/i18n!../nls/jsapi dijit/form/ToggleButton dijit/form/DropDownButton dijit/layout/ContentPane".split(" "),function(x,
D,n,q,k,t,g,e,c,r,m,A,l,B,y,f,h,w,u,v,z,I,G,J,F,E,Q,T,U,V,M,N,W,O,X,R,Y,Z,aa,ba,L){D=D([aa,A,Y,Z],{declaredClass:"esri.dijit.Measurement",widgetsInTemplate:!0,templateString:ba,_map:null,_geometryService:null,_interpolatedMap:null,_mouseImgURL:null,_defaultPinURL:null,_measureGraphics:[],_measureGraphic:null,_locationGraphic:null,_tempGraphic:null,_polylineGraphics:null,_polygonGraphic:null,_pointSymbol:null,_useDefaultPointSymbol:!0,_defaultLineSymbol:null,_lineSymbol:null,_areaLineSymbol:null,_defaultFillSymbol:null,
_fillSymbol:null,_borderlessFillSymbol:null,_defaultCustomPointSymbolHeight:25,_defaultCustomPointSymbolWidth:25,_userGeometry:null,_currentGeometry:null,_inputPoints:[],_unitDictionary:[],_densificationRatio:.07848050723825097,numberPattern:"#,###,###,##0.0",result:null,_defaultDistanceUnit:null,_defaultAreaUnit:null,_defaultLocationUnit:null,currentDistanceUnit:null,currentAreaUnit:null,currentLocationUnit:null,_unitStrings:{},_locationUnitStrings:[],_locationUnitStringsLong:[],_distanceUnitStrings:[],
_distanceUnitStringsLong:[],_areaUnitStrings:[],_areaUnitStringsLong:[],_calculatingMsg:null,_gsErrorMsg:null,_NLS_Lat:null,_NLS_Lon:null,_mouseMoveMapHandler:null,_mouseClickMapHandler:null,_doubleClickMapHandler:null,_mouseDragMapHandler:null,_clickMapHandler:null,_mapExtentChangeHandler:null,_geometryAreaHandler:null,_snappingCallback:null,_calcTimer:null,_buttonDijits:{},previousTool:null,activeTool:null,markerLongitude:null,markerLatitude:null,mouseLongitude:null,mouseLatitude:null,_eventMap:{"measure-start":["toolName",
"unitName"],measure:["toolName","geometry","values","unitName","segmentLength"],"measure-end":["toolName","geometry","values","unitName"],"tool-change":["toolName","unitName","previousToolName"],"unit-change":["unitName","toolName"]},constructor:function(a,b){if(a&&a.map){this._map=a.map;if(this._map.loaded)this._map.cs=this._checkCS(this._map.spatialReference),this._interpolatedMap=!("Web Mercator"===this._map.cs||"PCS"===this._map.cs);else var d=k.connect(this._map,"onLoad",this,function(){k.disconnect(d);
d=null;this._map.cs=this._checkCS(this._map.spatialReference);this._interpolatedMap=!("Web Mercator"===this._map.cs||"PCS"===this._map.cs)});this._geometryService=V.defaults.geometryService;this._mouseImgURL=x.toUrl("./images/cursor16x24.png");this._defaultPinURL=x.toUrl("./images/esriGreenPin16x26.png");this._defaultLineSymbol=new h(h.STYLE_SOLID,new t([0,128,255]),3);this._defaultFillSymbol=new w(h.STYLE_SOLID,this._defaultLineSymbol,new t([0,0,0,.5]));a.pointSymbol?(this._pointSymbol=a.pointSymbol,
this._useDefaultPointSymbol=!1):(this._pointSymbol=new f(this._defaultPinURL,16,26),this._pointSymbol.setOffset(0,12));this._fillSymbol=b=a.fillSymbol||this._defaultFillSymbol;this._areaLineSymbol=b.outline||this._defaultLineSymbol;this._borderlessFillSymbol=u.fromJson(b.toJson());this._borderlessFillSymbol.setOutline(null);this._lineSymbol=a.lineSymbol?a.lineSymbol:this._defaultLineSymbol;this._defaultDistanceUnit=a.defaultLengthUnit?a.defaultLengthUnit:O.MILES;this._defaultAreaUnit=a.defaultAreaUnit?
a.defaultAreaUnit:O.ACRES;this._defaultLocationUnit=a.defaultLocationUnit?a.defaultLocationUnit:O.DECIMAL_DEGREES;this._snappingCallback=n.hitch(this,this._snappingCallback);a.geometry&&(this._userGeometry=a.geometry);this._calcTimer=null;this.advancedLocationUnits=a.advancedLocationUnits||!1;this._NLS_Lon=L.widgets.measurement.NLS_longitude;this._NLS_Lat=L.widgets.measurement.NLS_latitude;this._gsErrorMsg=L.widgets.measurement.NLS_geometry_service_error;this._calculatingMsg=L.widgets.measurement.NLS_calculating;
this._geometryServiceLength=g(this._geometryServiceLength,250)}else console.log("Unable to find the required 'map' property in widget parameters")},startup:function(){this._setupDictionaries();r.create("img",{src:this._mouseImgURL,style:"vertical-align: middle"},this.mouseCell);this._useDefaultPointSymbol?r.create("img",{src:this._defaultPinURL,style:"vertical-align: middle"},this.pinCell):this._drawPointGraphics(this.pinCell);if(this._userGeometry)if(this._map.loaded)this._measureCustomGeometry(this._userGeometry),
this._userGeometry=null;else var a=k.connect(this._map,"onLoad",this,function(){k.disconnect(a);a=null;this._measureCustomGeometry(this._userGeometry);this._userGeometry=null})},destroy:function(){this._resetToolState();this.clearResult();this.inherited(arguments);this._map=this._geometryService=this._measureGraphics=this._measureGraphic=this._tempGraphic=null},setTool:function(a,b){this.previousTool=this.activeTool||null;this._polylineGraphics=[];this._resetToolState();this._polygonGraphic&&(this._map.graphics.remove(this._polygonGraphic),
this._polygonGraphic=null);var d=l.byNode(this._buttonDijits[a].domNode).checked;c.set(this._unitDropDown.domNode,"visibility","visible");l.byNode(this._buttonDijits.area.domNode).set("checked",!1);l.byNode(this._buttonDijits.distance.domNode).set("checked",!1);l.byNode(this._buttonDijits.location.domNode).set("checked",!1);if(!0===b||!1===b)d=b;l.byNode(this._buttonDijits[a].domNode).set("checked",d);this._toggleLocationResultsTable(!1,!0);d?(this.activeTool=a,(this._dblClickZoom=this._map.isDoubleClickZoom)&&
this._map.disableDoubleClickZoom(),"area"===a?this._setupAreaTool():"distance"===a?this._setupDistanceTool():"location"===a&&this._setupLocationTool(),this._map.snappingManager&&(this._map.snappingManager._startSelectionLayerQuery(),this._map.snappingManager._setUpSnapping())):(this.activeTool=null,c.set(this._unitDropDown.domNode,"visibility","hidden"));if(this.activeTool!==this.previousTool)this.onToolChange(this.activeTool,this.getUnit(),this.previousTool)},measure:function(a){a&&this._measureCustomGeometry(a)},
clearResult:function(){var a=this._map,b;this.result=0;this.resultValue.setContent("\x26nbsp");for(b=0;b<this._measureGraphics.length;b++)a.graphics.remove(this._measureGraphics[b]);this._measureGraphic=this._locationGraphic=this._currentGeometry=null;this._measureGraphics=[];a.graphics.remove(this._tempGraphic);k.disconnect(this._mouseMoveMapHandler);this._mouseMoveMapHandler=null},show:function(){M.show(this.domNode)},hide:function(){M.hide(this.domNode)},showTool:function(a){c.set(this._buttonDijits[a].domNode,
"display","inline-block")},hideTool:function(a){c.set(this._buttonDijits[a].domNode,"display","none")},getTool:function(){if(this.activeTool)return{toolName:this.activeTool,unitName:this.getUnit()}},getUnit:function(){if("unit"!==this._unitDropDown.label)return this._unitDropDown.label},_setupLocationTool:function(){this._map.navigationManager.setImmediateClick(!0);this._measureGraphics=[];this._map.graphics.remove(this._locationGraphic);this._createLocationUnitList();"PCS"===this._map.cs&&(this._projectMapExtent(this._map.extent),
this._mapExtentChangeHandler=k.connect(this._map,"onExtentChange",n.hitch(this,this._projectMapExtent)));this._clickMapHandler=k.connect(this._map,"onClick",this,"_locationClickHandler");if("esriDegreeMinuteSeconds"===this.currentLocationUnit||"esriDecimalDegrees"===this.currentLocationUnit)this._mouseMoveMapHandler=k.connect(this._map,"onMouseMove",this,"_locationMoveHandler")},_locationButtonToggle:function(){this.clearResult();this.setTool("location")},_measureCustomPoint:function(a){this.setTool("location",
!0);"Web Mercator"===this._map.cs&&a.spatialReference!==this._map.spatialReference&&(a=z.geographicToWebMercator(a));this._measureGraphic=new F;this._measureGraphic.setSymbol(this._pointSymbol);this._measureGraphic.setGeometry(a);this._measureGraphics.push(this._measureGraphic);this._map.graphics.add(this._measureGraphic);this._currentGeometry=a;this._calculateLocation(a,!0)},_calculateLocation:function(a,b){var d=!("esriDegreeMinuteSeconds"===this.currentLocationUnit||"esriDecimalDegrees"===this.currentLocationUnit);
d&&this._mouseMoveMapHandler&&(k.disconnect(this._mouseMoveMapHandler),this._mouseMoveMapHandler=null);a=n.clone(a);if(b){if("Web Mercator"!==this.map.cs&&this.map.spatialReference&&4326!==this.map.spatialReference.wkid){this._projectLocation(a,d);return}this._updateMarkerLocation(a.x,a.y)}a=this._getGCSLocation(a);this._advancedLocationDisplayHandler(a,d,b)},_projectLocation:function(a,b){this._geometryService.project([a],new R({wkid:4326}),n.hitch(this,function(d){this._advancedLocationDisplayHandler(d[0],
b,!0)}),n.hitch(this,function(d){console.log(this._gsErrorMsg,d)}))},_advancedLocationDisplayHandler:function(a,b,d){b?this._updateGeocoordinateStringLocation({coordinates:[[a.x,a.y]],sr:{wkid:4326},conversionType:this._unitStrings[this.currentLocationUnit]},a):(b=this._calculateXY(a.x,a.y),d?(this._updateClickLocation(b[0],b[1]),this.onMeasureEnd(this.activeTool,a,[b[0],b[1]],this.getUnit())):this._updateMouseLocation(b[0],b[1]))},_updateMarkerLocation:function(a,b){this.markerLocationX=a;this.markerLocationY=
b},_updateMouseLocation:function(a,b){this.mouseLongitude.innerHTML=a;this.mouseLatitude.innerHTML=b},_updateClickLocation:function(a,b){this._updateMouseLocation(a,b);this.markerLongitude.innerHTML=a;this.markerLatitude.innerHTML=b},_updateGeocoordinateStringLocation:function(a,b){this.resultValue.setContent("\x26nbsp");this._geometryService.toGeoCoordinateString(a,n.hitch(this,function(d){clearTimeout(this._calcTimer);d?(this.resultValue.setContent(d[0]),this.onMeasureEnd(this.activeTool,b,d,this.getUnit())):
(this.resultValue.setContent(this._gsErrorMsg),this.onMeasureEnd(this.activeTool,null,null,this.getUnit()))}));clearTimeout(this._calcTimer);this._calcTimer=setTimeout(n.hitch(this,function(){this.resultValue.setContent(this._calculatingMsg)},1E3))},_switchLocationUnit:function(a){l.byNode(this._unitDropDown.domNode).set("label",this._unitStrings[a]);this.currentLocationUnit=a;k.disconnect(this._mouseMoveMapHandler);this._mouseMoveMapHandler=null;this.onUnitChange(this._unitStrings[a],this.activeTool);
if("esriDegreeMinuteSeconds"===a||"esriDecimalDegrees"===a)this._mouseMoveMapHandler=k.connect(this._map,"onMouseMove",this,"_locationMoveHandler"),this._toggleLocationResultsTable(!0,!1),this._locationGraphic&&this._calculateLocation(this._locationGraphic.geometry,!0);else if(this._toggleLocationResultsTable(!1,!1),null!==this.resultValue&&(null!==this.markerLocationX||null!==this.markerLocationY)&&this._locationGraphic){var b=this._getGCSLocation(this._locationGraphic.geometry);this._updateGeocoordinateStringLocation({coordinates:[[b.x,
b.y]],sr:{wkid:4326},conversionType:this._unitStrings[a]},this._locationGraphic.geometry)}},_toggleLocationResultsTable:function(a,b){b&&(this.resultValue.setContent("\x26nbsp"),this.markerLongitude.innerHTML="---",this.markerLatitude.innerHTML="---",this.mouseLongitude.innerHTML="---",this.mouseLatitude.innerHTML="---");a?(M.show(this.resultTable.domNode),M.hide(this.resultValueContainer.domNode)):(M.hide(this.resultTable.domNode),M.show(this.resultValueContainer.domNode),k.disconnect(this._mouseMoveMapHandler));
"PCS"===this._map.cs&&M.hide(this._mouseRow)},_setupDistanceTool:function(){this._map.navigationManager.setImmediateClick(!0);"PCS"===this._map.cs&&(this._projectMapExtent(this._map.extent),this._mapExtentChangeHandler=k.connect(this._map,"onExtentChange",this,"_projectMapExtent"));this._inputPoints=[];this._createDistanceUnitList();this._mouseClickMapHandler=k.connect(this._map,"onClick",this,"_measureDistanceMouseClickHandler");this._doubleClickMapHandler=k.connect(this._map,"onDblClick",this,"_measureDistanceDblClickHandler")},
_distanceButtonToggle:function(){this.clearResult();this.setTool("distance")},_measureCustomDistance:function(a){if(1<a.paths[0].length){this.setTool("distance",!0);this._inputPoints=[];q.forEach(a.paths[0],n.hitch(this,function(d,p){this._inputPoints.push(d);var C=new F(new I(d[0],d[1],a.spatialReference),this._pointSymbol);this._measureGraphics.push(C);this._map.graphics.add(C);0!==p&&(this.result+=this._geodesicDistance(d,a.paths[0][p-1]))}));this._measureGraphic=new F;this._measureGraphic.setSymbol(this._lineSymbol);
this._measureGraphics.push(this._measureGraphic);var b=this._densifyGeometry(a);this._measureGraphic.setGeometry(b);this._map.graphics.add(this._measureGraphic);this._inputPoints=[];b=this._outputResult(this.result,this.getUnit());this._currentGeometry=a;this.onMeasureEnd(this.activeTool,a,b,this.getUnit())}},_showDistance:function(a){a&&this._outputResult(a,l.byNode(this._unitDropDown.domNode).label)},_setupAreaTool:function(){this._map.navigationManager.setImmediateClick(!0);this._inputPoints=[];
this._createAreaUnitList();this._tempGraphic=new F;this._tempGraphic._isSnapTarget=!1;this._tempGraphic.setSymbol(this._areaLineSymbol);this._tempGraphic.setGeometry(new G(this._map.spatialReference));this._map.graphics.add(this._tempGraphic);"PCS"===this._map.cs&&(this._geometryAreaHandler=k.connect(this._geometryService,"onAreasAndLengthsComplete",this,"_outputArea"));this._mouseClickMapHandler=k.connect(this._map,"onClick",this,"_measureAreaMouseClickHandler");this._doubleClickMapHandler=k.connect(this._map,
"onDblClick",this,"_measureAreaDblClickHandler")},_areaButtonToggle:function(){this.clearResult();this.setTool("area")},_generatePolygonFromPaths:function(){var a=[];q.forEach(this._polylineGraphics,n.hitch(this,function(p){q.forEach(p.geometry.paths,n.hitch(this,function(C){q.forEach(C,n.hitch(this,function(H){a.push(H)}))}))}));a.push(a[0]);var b=new J(this._map.spatialReference);b.addRing(a);b=this._densifyGeometry(b);var d=new F;d.setGeometry(b);d.setSymbol(this._borderlessFillSymbol);this._measureGraphic=
d;this._measureGraphics.push(d);return d},_getArea:function(a){var b=[],d=new E;d.areaUnit=T.UNIT_SQUARE_METERS;d.calculationType="geodesic";J.prototype.isSelfIntersecting(a)?this._geometryService.simplify([a],n.hitch(this,function(p){q.forEach(p,n.hitch(this,function(H){"PCS"===this._map.cs?(d.polygons=p,this._geometryService.areasAndLengths(d)):("Web Mercator"===this._map.cs&&(H=z.webMercatorToGeographic(H)),b.push(H))}));var C=v.geodesicAreas(b,O.SQUARE_METERS);this._showArea(C[0])})):("Web Mercator"===
this._map.cs&&(a=z.webMercatorToGeographic(a)),b.push(a),"PCS"===this._map.cs?(d.polygons=b,this._geometryService.areasAndLengths(d)):(a=v.geodesicAreas(b,O.SQUARE_METERS),this._showArea(Math.abs(a[0]))))},_outputArea:function(a){this._showArea(Math.abs(a.areas[0]))},_showArea:function(a){if(a)if(this.result=a,a=l.byNode(this._unitDropDown.domNode).label,a=this._outputResult(this.result,a),this._mouseMoveMapHandler)this.onMeasure(this.activeTool,this._currentGeometry,a,this.getUnit(),null);else this.onMeasureEnd(this.activeTool,
this._currentGeometry,a,this.getUnit())},_measureCustomArea:function(a){this.setTool("area",!0);this._inputPoints=[];var b=this._densifyGeometry(a);this._currentGeometry=a;this._measureGraphic=new F;this._measureGraphic.setGeometry(b);this._measureGraphic.setSymbol(this._fillSymbol);this._measureGraphics.push(this._measureGraphic);this._map.graphics.add(this._measureGraphic);this._getArea(a);this._inputPoints=[]},_resetToolState:function(){var a=this._map;a.navigationManager.setImmediateClick(!1);
this._dblClickZoom&&a.enableDoubleClickZoom();this._inputPoints=[];k.disconnect(this._mouseClickMapHandler);k.disconnect(this._mouseMoveMapHandler);k.disconnect(this._doubleClickMapHandler);k.disconnect(this._mouseDragMapHandler);k.disconnect(this._clickMapHandler);k.disconnect(this._mapExtentChangeHandler);k.disconnect(this._geometryAreaHandler);this._mouseClickMapHandler=this._mouseMoveMapHandler=this._doubleClickMapHandler=this._mouseDragMapHandler=this._clickMapHandler=this._mapExtentChangeHandler=
this._geometryAreaHandler=null;a.snappingManager&&a.snappingManager._snappingGraphic&&a.graphics.remove(a.snappingManager._snappingGraphic);this._map.snappingManager&&(this._map.snappingManager._stopSelectionLayerQuery(),this._map.snappingManager._killOffSnapping());this._unitDropDown._opened&&this._unitDropDown.closeDropDown()},_measureCustomGeometry:function(a){this.clearResult();switch(a.type){case "point":this._measureCustomPoint(a);break;case "polyline":this._measureCustomDistance(a);break;case "polygon":this._measureCustomArea(a)}},
_densifyGeometry:function(a){var b=this._map.cs,d=v.getSpheroidInfo(a.spatialReference).radius*this._densificationRatio;"Web Mercator"===b?(a=z.webMercatorToGeographic(a),d=v.geodesicDensify(a,d),d=z.geographicToWebMercator(d)):d="PCS"===b?a:v.geodesicDensify(a,d);return d},_geodesicDistance:function(a,b){var d=new G(this._map.spatialReference);"PCS"===this._map.cs&&(a=this._getGCSLocation(a),b=this._getGCSLocation(b));d.addPath([a,b]);"Web Mercator"===this._map.cs&&(d=z.webMercatorToGeographic(d));
return v.geodesicLengths([d],O.METERS)[0]},_calculateXY:function(a,b){var d=L.widgets.measurement,p=this._map.getScale();if(this.getUnit()===d.NLS_decimal_degrees){var C=500<=p?6:500>p&&50<=p?7:50>p&&5<=p?8:9;var H=a.toFixed(C);this._map.spatialReference._isWrappable()||(H=this._roundX(H));H=N.format(H);C=N.format(this._roundY(b.toFixed(C)))}else if(this.getUnit()===d.NLS_deg_min_sec){var K=d=!1;C=9E4<=p?0:9E4>p&&9E3<=p?1:9E3>p&&900<=p?2:900>p&&90<p?3:4;0>a&&(d=!0,a=Math.abs(a));0>b&&(K=!0,b=Math.abs(b));
b=this._roundY(b);this._map.spatialReference._isWrappable()||(a=this._roundX(a));var P=Math.floor(b)+"\u00b0";H=Math.floor(a)+"\u00b0";var S=Math.floor(this._getDegreeMinutes(b))+"'";p=Math.floor(this._getDegreeMinutes(a))+"'";b=N.format(this._getDegreeSeconds(b).toFixed(C))+'"';a=N.format(this._getDegreeSeconds(a).toFixed(C))+'"';C=P+S+b;H=H+p+a;d&&(H="-"+H);K&&(C="-"+C)}return[H,C]},_getDegreeMinutes:function(a){return 60*(a-Math.floor(a))},_getDegreeSeconds:function(a){return 60*(60*(a-Math.floor(a))-
Math.floor(60*(a-Math.floor(a))))},_roundY:function(a){90<a?a=90:-90>a&&(a=-90);return a},_roundX:function(a){180<a?a=180:-180>a&&(a=-180);return a},_getGCSLocation:function(a){a=n.clone(a);var b=this._map,d=b.extent,p=b._newExtent;"Web Mercator"===b.cs?a=z.webMercatorToGeographic(a):"PCS"===b.cs?p&&(a=new I((a.x-d.xmin)*Math.abs((p.xmax-p.xmin)/(d.xmax-d.xmin))+p.xmin,(a.y-d.ymin)*Math.abs((p.ymax-p.ymin)/(d.ymax-d.ymin))+p.ymin,b.spatialReference)):a=a.normalize();return a},_projectMapExtent:function(a){a=
new F(a);var b=new R({wkid:4326});this._geometryService.project([a.geometry],b,n.hitch(this,function(d){if(!this._mouseMoveMapHandler&&"location"===this.activeTool){if("esriDegreeMinuteSeconds"===this.currentLocationUnit||"esriDecimalDegrees"===this.currentLocationUnit)this._mouseMoveMapHandler=k.connect(this._map,"onMouseMove",n.hitch(this,this._locationMoveHandler));this._mouseMoveMapHandler=k.connect(this._map,"onMouseMove",n.hitch(this,this._locationMoveHandler))}this._map._newExtent=d[0]}))},
_checkCS:function(a){if(a.wkid)return 3857===a.wkid||102100===a.wkid||102113===a.wkid?"Web Mercator":W.isDefined(X[a.wkid])?"PCS":"GCS";if(a.wkt)return-1!==a.wkt.indexOf("WGS_1984_Web_Mercator")?"Web Mercator":0===a.wkt.indexOf("PROJCS")?"PCS":"GCS"},_switchUnit:function(a){"distance"===this.activeTool?this.currentDistanceUnit=a:"area"===this.activeTool?this.currentAreaUnit=a:"location"===this.activeTool&&(this.currentLocationUnit=a);l.byNode(this._unitDropDown.domNode).set("label",this._unitStrings[a]);
if(null!==this.result){var b=this._outputResult(this.result,this._unitStrings[a]);this.onUnitChange(this._unitStrings[a],this.activeTool);if(null!==this._currentGeometry||null!==this._measureGraphic)if(a=this._currentGeometry||this._measureGraphic.geometry,this._mouseMoveMapHandler)this.onMeasure(this.activeTool,a,b,this.getUnit(),null);else this.onMeasureEnd(this.activeTool,a,b,this.getUnit())}},_setupDictionaries:function(){var a=L.widgets.measurement;this._unitDictionary[a.NLS_length_meters]=1;
this._unitDictionary[a.NLS_length_kilometers]=1E3;this._unitDictionary[a.NLS_length_feet]=.3048;this._unitDictionary[a.NLS_length_miles]=1609.344;this._unitDictionary[a.NLS_length_yards]=.9144;this._unitDictionary[a.NLS_length_nautical_miles]=1852;this._unitDictionary[a.NLS_length_miles_us]=1609.347218694438;this._unitDictionary[a.NLS_length_feet_us]=.3048006096012192;this._unitDictionary[a.NLS_length_yards_us]=.9144018288036576;this._unitDictionary[a.NLS_area_sq_meters]=1;this._unitDictionary[a.NLS_area_sq_kilometers]=
1E6;this._unitDictionary[a.NLS_area_sq_feet]=.09290304;this._unitDictionary[a.NLS_area_acres]=4046.8564224;this._unitDictionary[a.NLS_area_sq_miles]=2589988.110336;this._unitDictionary[a.NLS_area_hectares]=1E4;this._unitDictionary[a.NLS_area_sq_yards]=.83612736;this._unitDictionary[a.NLS_area_acres_us]=4046.872609874252;this._unitDictionary[a.NLS_area_sq_miles_us]=2589998.470319522;this._unitDictionary[a.NLS_area_sq_feet_us]=.09290341161327487;this._unitDictionary[a.NLS_area_sq_yards_us]=.8361307045194736;
this._unitStrings={esriMiles:a.NLS_length_miles,esriKilometers:a.NLS_length_kilometers,esriFeet:a.NLS_length_feet,esriFeetUS:a.NLS_length_feet_us,esriMeters:a.NLS_length_meters,esriYards:a.NLS_length_yards,esriNauticalMiles:a.NLS_length_nautical_miles,esriMilesUS:a.NLS_length_miles_us,esriYardsUS:a.NLS_length_yards_us,esriAcres:a.NLS_area_acres,esriSquareMiles:a.NLS_area_sq_miles,esriSquareKilometers:a.NLS_area_sq_kilometers,esriHectares:a.NLS_area_hectares,esriSquareYards:a.NLS_area_sq_yards,esriSquareFeet:a.NLS_area_sq_feet,
esriSquareFeetUS:a.NLS_area_sq_feet_us,esriSquareMeters:a.NLS_area_sq_meters,esriAcresUS:a.NLS_area_acres_us,esriSquareMilesUS:a.NLS_area_sq_miles_us,esriSquareYardsUS:a.NLS_area_sq_yards_us,esriDecimalDegrees:a.NLS_decimal_degrees,esriDegreeMinuteSeconds:a.NLS_deg_min_sec,esriMGRS:a.NLS_MGRS,esriUSNG:a.NLS_USNG,esriUTM:a.NLS_UTM,esriGARS:a.NLS_GARS,esriGeoRef:a.NLS_GeoRef,esriDDM:a.NLS_DDM,esriDD:a.NLS_DD};this._locationUnitStrings=[a.NLS_decimal_degrees,a.NLS_deg_min_sec,a.NLS_MGRS,a.NLS_USNG,a.NLS_UTM,
a.NLS_GeoRef,a.NLS_GARS];this._locationUnitStringsLong="esriDecimalDegrees esriDegreeMinuteSeconds esriMGRS esriUSNG esriUTM esriGeoRef esriGARS".split(" ");this._distanceUnitStrings=[a.NLS_length_miles,a.NLS_length_kilometers,a.NLS_length_feet,a.NLS_length_feet_us,a.NLS_length_meters,a.NLS_length_yards,a.NLS_length_nautical_miles];this._distanceUnitStringsLong="esriMiles esriKilometers esriFeet esriFeetUS esriMeters esriYards esriNauticalMiles".split(" ");this._areaUnitStrings=[a.NLS_area_acres,
a.NLS_area_sq_miles,a.NLS_area_sq_kilometers,a.NLS_area_hectares,a.NLS_area_sq_yards,a.NLS_area_sq_feet,a.NLS_area_sq_feet_us,a.NLS_area_sq_meters];this._areaUnitStringsLong="esriAcres esriSquareMiles esriSquareKilometers esriHectares esriSquareYards esriSquareFeet esriSquareFeetUS esriSquareMeters".split(" ");this._buttonDijits={area:this._areaButton,distance:this._distanceButton,location:this._locationButton};l.byNode(this._distanceButton.domNode).setLabel(a.NLS_distance);l.byNode(this._areaButton.domNode).setLabel(a.NLS_area);
l.byNode(this._locationButton.domNode).setLabel(a.NLS_location);l.byNode(this.resultLabel.domNode).setContent(a.NLS_resultLabel)},onToolChange:function(){},onUnitChange:function(){},onMeasureStart:function(){},onMeasure:function(){},onMeasureEnd:function(){},_measureAreaMouseClickHandler:function(a){if(this._map.snappingManager)var b=this._map.snappingManager._snappingPoint;b=b||a.mapPoint;this._inputPoints.push(b);this._currentStartPt=b;if(1===this._inputPoints.length){this._tempGraphic.setGeometry(new G(this._map.spatialReference));
for(a=0;a<this._measureGraphics.length;a++)this._map.graphics.remove(this._measureGraphics[a]);this._measureGraphics=[];this.result=0;this._outputResult(this.result,L.widgets.measurement.NLS_area_sq_meters);this._mouseMoveMapHandler=k.connect(this._map,"onMouseMove",this,"_measureAreaMouseMoveHandler");this.onMeasureStart(this.activeTool,this.getUnit())}this._measureGraphic=new F;this._measureGraphic.setSymbol(this._areaLineSymbol);this._measureGraphics.push(this._measureGraphic);if(1<this._inputPoints.length){a=
new G(this._map.spatialReference);a.addPath([this._inputPoints[this._inputPoints.length-2],b]);var d=new G(this._map.spatialReference);d.addPath([this._inputPoints[0],b]);b=this._densifyGeometry(a);d=this._densifyGeometry(d);this._tempGraphic.setGeometry(d);this._measureGraphic.setGeometry(b);this._map.graphics.add(this._measureGraphic);b=new F;b.setGeometry(a);this._polylineGraphics.push(b);if(2<this._inputPoints.length){b=new J(this._map.spatialReference);d=[];for(a=0;a<this._inputPoints.length;a++)d.push([this._inputPoints[a].x,
this._inputPoints[a].y]);d.push([this._inputPoints[0].x,this._inputPoints[0].y]);b.addRing(d);this._currentGeometry=b;this._polygonGraphic?(this._map.graphics.remove(this._polygonGraphic),this._polylineGraphics.push(this._tempGraphic),this._polygonGraphic=this._generatePolygonFromPaths(),this._map.graphics.add(this._polygonGraphic),this._measureGraphic=this._polygonGraphic,this._polylineGraphics.pop()):(this._polygonGraphic=this._generatePolygonFromPaths(),this._map.graphics.add(this._polygonGraphic));
this._getArea(b)}}else this._polygonGraphic&&(this._map.graphics.remove(this._polygonGraphic),this._polygonGraphic=null)},_measureAreaMouseMoveHandler:function(a){if(0<this._inputPoints.length){var b=new G(this._map.spatialReference);if(this._map.snappingManager)var d=this._map.snappingManager._snappingPoint;var p=d||a.mapPoint;b.addPath([this._currentStartPt,p]);a=this._densifyGeometry(b);this._tempGraphic.setGeometry(a)}1<this._inputPoints.length&&(a=new G(this._map.spatialReference),a.addPath([p,
this._inputPoints[0]]),p=this._densifyGeometry(a),this._tempGraphic.setGeometry(this._tempGraphic.geometry.addPath(p.paths[0])))},_measureAreaDblClickHandler:function(a){k.disconnect(this._mouseMoveMapHandler);this._mouseMoveMapHandler=null;"touch"===this._map.navigationManager.eventModel&&e("ios")&&this._measureAreaMouseClickHandler(a);a=new J(this._map.spatialReference);var b=[],d;for(d=0;d<this._inputPoints.length;d++)b.push([this._inputPoints[d].x,this._inputPoints[d].y]);b.push([this._inputPoints[0].x,
this._inputPoints[0].y]);a.addRing(b);this._inputPoints=[];this._currentGeometry=a;this._polygonGraphic&&(this._map.graphics.remove(this._polygonGraphic),this._polylineGraphics.push(this._tempGraphic),this._polygonGraphic=this._generatePolygonFromPaths(),this._map.graphics.add(this._polygonGraphic));this._getArea(a);this._polylineGraphics=[]},_measureDistanceMouseClickHandler:function(a){if(this._map.snappingManager)var b=this._map.snappingManager._snappingPoint;a=b||a.mapPoint;this._inputPoints.push(a);
this._currentStartPt=a;if(1===this._inputPoints.length){for(b=0;b<this._measureGraphics.length;b++)this._map.graphics.remove(this._measureGraphics[b]);this._map.graphics.remove(this._tempGraphic);this._measureGraphics=[];this.result=0;this._outputResult(this.result,L.widgets.measurement.NLS_length_meters);this._tempGraphic=new F;this._tempGraphic._isSnapTarget=!1;this._tempGraphic.setSymbol(this._lineSymbol);this._map.graphics.add(this._tempGraphic);this._mouseMoveMapHandler=k.connect(this._map,"onMouseMove",
this,"_measureDistanceMouseMoveHandler");this.onMeasureStart(this.activeTool,this.getUnit())}this._tempGraphic.setGeometry(new G(this._map.spatialReference));b=new F;b.setSymbol(this._pointSymbol);b.setGeometry(a);this._measureGraphics.push(b);this._map.graphics.add(b);if(1<this._inputPoints.length){this._measureGraphic=new F;this._measureGraphic.setSymbol(this._lineSymbol);this._measureGraphics.push(this._measureGraphic);b=new G(this._map.spatialReference);b.addPath([this._inputPoints[this._inputPoints.length-
2],a]);var d=this._densifyGeometry(b);this._measureGraphic.setGeometry(d);this._map.graphics.add(this._measureGraphic);"PCS"===this._map.cs?this._geometryServiceLength(b,!1):(d=this._geodesicDistance(this._inputPoints[this._inputPoints.length-2],a),b=this._outputResult(d,this.getUnit()),this.result+=d,this._showDistance(this.result),d=this._outputResult(this.result,this.getUnit()),this.onMeasure(this.activeTool,a,d,this.getUnit(),b))}else b.setSymbol(this._pointSymbol)},_measureDistanceMouseMoveHandler:function(a){if(0<
this._inputPoints.length){var b=new G(this._map.spatialReference);if(this._map.snappingManager)var d=this._map.snappingManager._snappingPoint;a=d||a.mapPoint;b.addPath([this._currentStartPt,a]);b=this._densifyGeometry(b);this._tempGraphic.setGeometry(b);"PCS"!==this._map.cs&&(d=this._geodesicDistance(this._currentStartPt,a),b=this._outputResult(d,this.getUnit()),d+=this.result,this._showDistance(d),d=this._outputResult(d,this.getUnit()),this.onMeasure(this.activeTool,a,d,this.getUnit(),b))}},_measureDistanceDblClickHandler:function(a){k.disconnect(this._mouseMoveMapHandler);
this._mouseMoveMapHandler=null;"touch"===this._map.navigationManager.eventModel&&e("ios")&&this._measureDistanceMouseClickHandler(a);a=new G(this._map.spatialReference);a.addPath(this._inputPoints);this._currentGeometry=a;var b=this._densifyGeometry(a);this._measureGraphic.geometry=b;"PCS"===this._map.cs?this._geometryServiceLength(a,!0):(this._inputPoints=[],this.onMeasureEnd(this.activeTool,a,this._outputResult(this.result,this.getUnit()),this.getUnit()))},_geometryServiceLength:function(a,b){var d=
new Q;d.polylines=[a];d.lengthUnit=9001;d.calculationType="geodesic";this._geometryService.lengths(d,n.hitch(this,function(p){p=p.lengths[0];if(b)this.result=p,this._showDistance(this.result),this._inputPoints=[],this.onMeasureEnd(this.activeTool,a,this._outputResult(this.result,this.getUnit()),this.getUnit());else{var C=this._outputResult(p,this.getUnit());this.result+=p;this._showDistance(this.result);this.onMeasure(this.activeTool,a,this._outputResult(this.result,this.getUnit()),this.getUnit(),
C)}}))},_locationClickHandler:function(a){if(this._map.snappingManager)var b=this._map.snappingManager._snappingPoint;a=b||a.mapPoint;this._locationButtonToggle();this._locationGraphic=new F;this._locationGraphic.setGeometry(a);this._locationGraphic.setSymbol(this._pointSymbol);this._map.graphics.add(this._locationGraphic);this._measureGraphics.push(this._locationGraphic);this._calculateLocation(a,!0)},_locationMoveHandler:function(a){if(this._map.snappingManager)var b=this._map.snappingManager._snappingPoint;
this._calculateLocation(b||a.mapPoint,!1)},_outputResult:function(a,b){a/=this._unitDictionary[b];0===a?this.resultValue.setContent("\x26nbsp"):1E6<a?this.resultValue.setContent(N.format(a.toPrecision(9),{pattern:this.numberPattern})+" "+b):10>a?this.resultValue.setContent(N.format(a.toFixed(2),{pattern:this.numberPattern+"0"})+" "+b):this.resultValue.setContent(N.format(a.toFixed(2),{pattern:this.numberPattern})+" "+b);return a},_createDistanceUnitList:function(){var a=new B({style:"display: none;"});
q.forEach(this._distanceUnitStrings,n.hitch(this,function(d,p){d=new y({label:d,onClick:n.hitch(this,function(){this._switchUnit(this._distanceUnitStringsLong[p])})});d.set("class","unitDropDown");a.addChild(d)}));l.byNode(this._unitDropDown.domNode).set("dropDown",a);if(this.currentDistanceUnit){var b=this._unitStrings[this.currentDistanceUnit];l.byNode(this._unitDropDown.domNode).set("label",b)}else b=this._unitStrings[this._defaultDistanceUnit],l.byNode(this._unitDropDown.domNode).set("label",
b),this.currentDistanceUnit=this._defaultDistanceUnit},_createAreaUnitList:function(){var a=new B({style:"display: none;"});q.forEach(this._areaUnitStrings,n.hitch(this,function(d,p){d=new y({label:d,onClick:n.hitch(this,function(){this._switchUnit(this._areaUnitStringsLong[p])})});d.set("class","unitDropDown");a.addChild(d)}));l.byNode(this._unitDropDown.domNode).set("dropDown",a);if(this.currentAreaUnit){var b=this._unitStrings[this.currentAreaUnit];l.byNode(this._unitDropDown.domNode).set("label",
b)}else b=this._unitStrings[this._defaultAreaUnit],l.byNode(this._unitDropDown.domNode).set("label",b),this.currentAreaUnit=this._defaultAreaUnit},_createLocationUnitList:function(){var a=this._locationUnitStrings;var b=new B({style:"display: none;"});if(null===this._geometryService||!1===this.advancedLocationUnits)a=a.slice(0,2);q.forEach(a,n.hitch(this,function(d,p){d=new y({label:d,onClick:n.hitch(this,function(){this._switchLocationUnit(this._locationUnitStringsLong[p])})});d.set("class","unitDropDown");
b.addChild(d)}));l.byNode(this._unitDropDown.domNode).set("dropDown",b);this.currentLocationUnit||(this.currentLocationUnit=this._defaultLocationUnit);a=this._unitStrings[this.currentLocationUnit];l.byNode(this._unitDropDown.domNode).set("label",a);"esriDegreeMinuteSeconds"!==this.currentLocationUnit&&"esriDecimalDegrees"!==this.currentLocationUnit||this._toggleLocationResultsTable(!0,!1)},_drawPointGraphics:function(a){var b=this._pointSymbol,d=this._defaultCustomPointSymbolWidth,p=this._defaultCustomPointSymbolHeight;
a=r.create("div",{"class":"esriLocationResultSymbol"},a);a=m.createSurface(a,d,p);if(9>e("ie")){var C=a.getEventSource();c.set(C,"position","relative");c.set(C.parentNode,"position","relative")}b=b.getShapeDescriptors();try{var H=a.createShape(b.defaultShape).setFill(b.fill).setStroke(b.stroke)}catch(S){a.clear();a.destroy();return}var K=H.getBoundingBox();b=K.width;C=K.height;var P=-(K.x+b/2);K=-(K.y+C/2);a=a.getDimensions();a={dx:P+a.width/2,dy:K+a.height/2};if(b>d||C>p)P=b/d>C/p,d=((P?d:p)-5)/
(P?b:C),n.mixin(a,{xx:d,yy:d});H.applyTransform(a)}});e("extend-esri")&&n.setObject("dijit.Measurement",D,U);return D});