// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/3.38/esri/copyright.txt for details.
//>>built
define("esri/dijit/RasterFunctionEditor/RFxWeightedSumTableEditor","dojo/_base/declare dojo/has ../../kernel dojo/i18n!../../nls/jsapi dojo/_base/lang dojo/Evented dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin ./EditableGridMixin ./RFxGridBase ./utils".split(" "),function(g,k,l,m,n,p,q,r,t,u,h,v){g=g([q,r,t,p,u],{templateString:"\x3cdiv\x3e\x3cdiv data-dojo-attach-point\x3d'gridNode'\x3e\x3c/div\x3e\x3c/div\x3e",baseClass:"esriRFxWeightedSumTableEditor",dataTypes:[h.DATA_TYPES.raster,
"field",h.DATA_TYPES.double],fieldNames:["layer","field","weight"],value:null,_store:null,_grid:null,postCreate:function(){this.inherited(arguments);this._i18n=m.widgets.rasterFunctionEditor.rfxWeightedSumTableEditor;this._initializeGrid();this._grid.on("grid-data-change",function(b){this._updateArgValues(b)}.bind(this));this._grid.startup()},_initializeGrid:function(){var b=this._getGridSchema(),d=this._readArgValues();this._grid=new h({schema:b,data:d,hasIdColumn:!0,inputLayers:this.inputLayers,
allowScalar:this.allowScalar,browseProperties:this.browseProperties},this.gridNode)},_getGridSchema:function(){var b=[];return b=this.fieldNames.map(function(d,a){return{label:this._i18n[d],name:d,dataType:this.dataTypes[a]}},this)},_updateArgValues:function(){var b=this.inputArgs,d=this._grid._store.data;if(b){var a=b.Rasters,c=b.Weights,e=b.Fields;a&&(a.value={},a.value.elements=[],a.value.type=v.ARGUMENT_ARRAY_TYPE);c&&(c.value=[]);e&&(e.value=[]);d&&Array.isArray(d)&&d.forEach(function(f){if("*"!==
f.idNum){var w=f.layer;a&&a.value&&a.value.elements.push(w);c&&c.value&&c.value.push(f.weight);e&&e.value&&e.value.push(f.fieldArg.value)}})}},_readArgValues:function(){if(this.inputArgs){var b=0,d=[],a=this.inputArgs,c=a.Rasters,e=a.Weights;a=a.Fields;if(c&&e&&a){var f=Math.max(c.value&&c.value.elements&&c.value.elements.length,e.value&&e.value.length,a.value&&a.value.length);if(isNaN(f))return d}for(;b<f;)d.push({layer:c.value&&c.value.elements&&c.value.elements[b],field:a.value&&a.value[b],weight:e.value&&
e.value[b]}),b+=1;return d}}});k("extend-esri")&&n.setObject("dijit.RasterFunctionEditor.RFxWeightedSumTableEditor",g,l);return g});