// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/3.38/esri/copyright.txt for details.
//>>built
require({cache:{"url:esri/dijit/RasterFunctionEditor/templates/RFxAttributeTable.html":'\x3cdiv class\x3d"esriRFxAttributeTable"\x3e\r\n    \x3ctable class\x3d"esriRFxAttributeTable__table"\x3e\r\n      \x3ctr class\x3d"esri-rfx-args-editor__tr--arg-name" data-dojo-attach-point\x3d"rasterName"\x3e\r\n          \x3ctd data-dojo-attach-point\x3d"rasterLabel"\x3e\x3c/td\x3e\r\n      \x3c/tr\x3e\r\n      \x3ctr class\x3d"esri-rfx-args-editor__tr--arg-widget" data-dojo-attach-point\x3d"rasterInput"\x3e\r\n        \x3ctd\x3e\r\n            \x3cdiv data-dojo-type\x3d"esri/dijit/RasterFunctionEditor/RFxRasterInput" data-dojo-attach-point\x3d"_layerSelect" data-dojo-props\x3d"inputLayers: this.inputLayers, allowScalar: this.allowScalar"\x3e\x3c/div\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n    \x3c/table\x3e\r\n  \r\n    \x3cdiv data-dojo-attach-point\x3d"attributeTable"\x3e\x3c/div\x3e\r\n    \r\n    \x3cdiv class\x3d"esriGenerateTableOptions" data-dojo-attach-point\x3d"generateOptions" data-dojo-type\x3d"dijit/TitlePane" data-dojo-props\x3d"title: \'${_i18n.generateTable}\', open: false"\x3e\r\n      \x3ctable\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd\x3e\r\n            ${_i18n.minVal}\r\n          \x3c/td\x3e\r\n          \x3ctd\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"minValSelect"\x3e\x3c/div\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd\x3e\r\n            ${_i18n.maxVal}\r\n          \x3c/td\x3e\r\n          \x3ctd\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"maxValSelect"\x3e\x3c/div\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd\x3e\r\n            ${_i18n.baseClassName}\r\n          \x3c/td\x3e\r\n          \x3ctd\x3e\r\n            \x3cdiv data-dojo-type\x3d"dijit/form/TextBox" data-dojo-attach-point\x3d"baseClassNameInput" value\x3d"${_i18n.defaultClassName}"\x3e\x3c/div\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd\x3e\r\n            ${_i18n.colorScheme}\r\n          \x3c/td\x3e\r\n          \x3ctd\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"colorRampNode"\x3e\x3c/div\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n      \x3c/table\x3e\r\n      \x3cbutton class\x3d"esriAttributeTableGenerateTable" data-dojo-attach-point\x3d"generateButton" data-dojo-type\x3d"dijit/form/Button" type\x3d"button"\x3e${_i18n.generateTable}\x3c/button\x3e\r\n    \x3c/div\x3e\r\n   \r\n  \x3c/div\x3e\r\n  '}});
define("esri/dijit/RasterFunctionEditor/RFxAttributeTable","dojo/_base/declare dojo/_base/lang dojo/has dojo/i18n!../../nls/jsapi dojo/text!./templates/RFxAttributeTable.html dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dijit/form/NumberSpinner ./EditableGridMixin ./RFxGridBase ./utils ../ColorRampSelector ../../renderers/colorRampUtils ../../kernel".split(" "),function(g,e,l,m,n,p,q,r,t,u,h,v,w,x,y){g=g([p,q,r,u],{templateString:n,baseClass:"esriRFxAttributeTable",nCols:0,
dataTypes:[h.DATA_TYPES.string,h.DATA_TYPES.string,"color"],fieldNames:["Value","ClassName","Color"],isExternalTable:!1,_store:null,_grid:null,defaults:{min:1,max:7},fields:[{name:"ObjectID",type:"esriFieldTypeOID",alias:"OID"},{name:"Value",type:"esriFieldTypeInteger",alias:"Value"},{name:"ClassName",type:"esriFieldTypeString",alias:"ClassName",length:256},{name:"Red",type:"esriFieldTypeInteger",alias:"Red"},{name:"Green",type:"esriFieldTypeInteger",alias:"Green"},{name:"Blue",type:"esriFieldTypeInteger",
alias:"Blue"},{name:"Alpha",type:"esriFieldTypeInteger",alias:"Alpha"}],fieldTypeMap:{esriFieldTypeOID:"double",esriFieldTypeInteger:"double",esriFieldTypeDouble:"double",esriFieldTypeString:"string",esriFieldTypeDate:"string"},constructor:function(b){this.inherited(arguments);this._i18n=m.widgets.rasterFunctionEditor.rfxAttributeTable},postCreate:function(){this.inherited(arguments);this._validateInputArgs();this._setLabels();this._setupLayerSelect();this._setupValueControls();this._setupColorRamp();
this._initializeGrid();this.generateButton.on("click",e.hitch(this,this._onGenerateTableClick));this._grid.on("grid-data-change",e.hitch(this,this._updateValue))},_validateInputArgs:function(){var b=Object.keys(this.inputArgs).some(function(a){if("AttributeTableAsRecordSet"===a)return!0});if(!b){var c={name:"AttributeTableAsRecordSet",isPublic:!1,type:"RecordSet"};this.rfxArgs.AttributeTableAsRecordSet=c;this.inputArgs.AttributeTableAsRecordSet=c}b&&(this.isExternalTable=this._isExternalTable())&&
(this.generateOptions.domNode.style.display="none")},_setupLayerSelect:function(){this.rasterArg=this.inputArgs&&this.inputArgs.Raster;this._layerSelect.set("inputLayers",this.inputLayers);this._layerSelect.set("allowScalar",this.allowScalar);this._layerSelect.set("rfxVariable",this.rasterArg);v.getArgRFT(this.rasterArg)?this._hideLayerSelect():(this.own(this._layerSelect.on("change",this._updateRasterInputArg.bind(this))),this._updateRasterInputArg())},_hideLayerSelect:function(){this.rasterName.style.display=
"none";this.rasterInput.style.display="none"},_updateRasterInputArg:function(){this.rasterArg.value=this._layerSelect.get("value")},_setupValueControls:function(){this.minVal=this._createValueControl(this.minValSelect,this.defaults.min);this.maxVal=this._createValueControl(this.maxValSelect,this.defaults.max)},_setupColorRamp:function(){this.colorRampSelect=new w({maxHeight:200,includeDefault:!1},this.colorRampNode);this.colorRampSelect.startup();this.colorRampSelect.setSelected("Aspect")},_createValueControl:function(b,
c){b=new t({value:c,smallDelta:1,constraints:{min:-255,max:255,places:0}},b);b.startup();return b},_initializeGrid:function(){var b=this._getGridSchema(),c=this._createDataObject();this._grid=this.isExternalTable?new h({schema:b,data:c,hasIdColumn:!1,isEditable:!1},this.attributeTable):new h({schema:b,data:c,hasIdColumn:!0,defaultBlankObject:this._getDefaultValueObject()},this.attributeTable)},_getGridSchema:function(){var b=[];return b=this.isExternalTable?(this.inputArgs&&this.inputArgs.AttributeTableAsRecordSet&&
this.inputArgs.AttributeTableAsRecordSet.fields).map(e.hitch(this,function(c){return{label:this._i18n[c.name.toLowerCase()]||c.name,name:c.name,dataType:this.fieldTypeMap[c.type]}})):this.fieldNames.map(function(c,a){return{label:this._i18n[c.toLowerCase()],name:c,dataType:this.dataTypes[a]}},this)},_isExternalTable:function(){var b=!1,c=this.inputArgs&&this.inputArgs.AttributeTableAsRecordSet&&this.inputArgs.AttributeTableAsRecordSet.fields;if(!c)return b;c.length===this.fields.length?c.forEach(e.hitch(this,
function(a){"oid"===a.name.toLowerCase()||this.fields.some(e.hitch(this,function(d){return d.name===a.name&&d.type===a.type&&d.alias===a.alias}))||(b=!0)})):b=!0;return b},_createDataObject:function(){var b=[];if((this.recordSetArg=this.inputArgs&&this.inputArgs.AttributeTableAsRecordSet)&&this.recordSetArg.features&&this.recordSetArg.features.length){var c=this.recordSetArg.features;this.isExternalTable?b=c.map(function(a){return a.attributes}):c.forEach(function(a){a=a.attributes;null!=a.Alpha&&
1>=a.Alpha&&(a.Alpha=Math.round(255*a.Alpha));b.push({Value:a.Value,ClassName:a.ClassName,colorObject:{r:a.Red,g:a.Green,b:a.Blue,a:a.Alpha,id:a.ObjectID}})})}return b},_getDefaultValueObject:function(){if(!this.isExternalTable)return{Value:0,ClassName:"",colorObject:{r:0,g:0,b:0,a:255}}},_onGenerateTableClick:function(){var b=this._getGridData();this._grid.updateStoreValue(b);this._updateValue(b)},_getGridData:function(){for(var b=this.minVal.value,c=this.maxVal.value,a=this.baseClassNameInput.value,
d=[],k=x.convertColorRampToColormap(this.colorRampSelect.colorRamp,c-b+1),f=0;b<=c;b++)d.push({Value:b,ClassName:a+b,colorObject:{r:k[f][1],g:k[f][2],b:k[f][3],a:255,id:f}}),f++;return d},_updateValue:function(b){var c=[];b.forEach(function(a,d){a&&"*"!==a.idNum&&(a={attributes:{ObjectID:d,Value:parseInt(a.Value,10),ClassName:a.ClassName,Red:a.colorObject.r,Green:a.colorObject.g,Blue:a.colorObject.b,Alpha:a.colorObject.a}},c.push(a))});this.recordSetArg.fields||(this.recordSetArg.fields=this.fields);
this.recordSetArg.features=c},_setLabels:function(){this.inputArgs&&this.inputArgs.Raster&&(this.rasterLabel.innerHTML=this.inputArgs.Raster.displayName||this.inputArgs.Raster.name)}});l("extend-esri")&&e.setObject("dijit.RasterFunctionEditor.RFxAttributeTable",g,y);return g});