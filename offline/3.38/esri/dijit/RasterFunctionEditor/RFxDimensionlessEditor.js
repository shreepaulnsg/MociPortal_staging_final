// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/3.38/esri/copyright.txt for details.
//>>built
require({cache:{"url:esri/dijit/RasterFunctionEditor/templates/RFxDimensionlessEditor.html":'\x3cdiv class\x3d"esri-rfx-dimensionless-editor"\x3e\r\n  \x3ctable class\x3d"esri-rfx-args-editor__table"\x3e\r\n    \x3ctr class\x3d"esri-rfx-args-editor__tr--arg-name"\x3e\r\n      \x3ctd data-dojo-attach-point\x3d"_templateContainer"\x3e\r\n        \x3cinput type\x3d"checkbox" data-dojo-attach-point\x3d"_templateInput" data-dojo-type\x3d"dijit/form/CheckBox"\x3e\r\n        ${_i18n.dimensionlessName}\r\n      \x3c/td\x3e\r\n    \x3c/tr\x3e\r\n  \x3c/table\x3e\r\n\x3c/div\x3e\r\n'}});
define("esri/dijit/RasterFunctionEditor/RFxDimensionlessEditor","dojo/_base/declare dojo/dom-style dojo/_base/array dojo/has dojo/i18n!../../nls/jsapi dojo/text!./templates/RFxDimensionlessEditor.html dojo/_base/lang dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin ./utils ../../kernel".split(" "),function(g,u,v,k,l,m,f,n,p,q,h,r){g=g("RFxDimensionlessEditor",[n,p,q],{widgetsInTemplate:!0,templateString:m,isRasterSingleSlice:!1,mdimDefLeadsToSingleSlice:!1,multidimensionalInfo:null,
constructor:function(){this.inherited(arguments);this._i18n=l.rasterFunctions.rfxArgs},postCreate:function(){this.inherited(arguments);this._attachInputToRFxArg();this._attachChangeListener()},startup:function(){this.inherited(arguments);var a=this.triggerArgs.Raster&&this.triggerArgs.Raster.input;a&&a.value?(a=a.getSelectedLayer(a.get("value").name),this._setInitialSate(a)):(this.mdimDefLeadsToSingleSlice=this.isRasterSingleSlice=!1,this._processDimensionlessArgState())},_isArrayUnique:function(a){return a.every(function(b,
c,d){return 0<=d.indexOf(b,c+1)?!1:!0}.bind(this))},_isItemInArray:function(a,b){return 0<=a.indexOf(b)},_setInitialSate:function(a){a.getMultidimensionalInfo().then(f.hitch(this,function(b){a.multidimensionalInfo=b;this.isRasterSingleSlice=this._checkIfRasterIsSingleSlice(a);this.multidimensionalInfo=h.filterMDInfoIfMosiacRuleIsSet(a);b=this.triggerArgs.Filter&&this.triggerArgs.Filter.input;var c=b.value||b.get("value")||this.triggerArgs.Filter.value;this.mdimDefLeadsToSingleSlice=b&&c?this._isMultidimensionalDefinitionAppliedSingleSlice(c):
!1;this._processDimensionlessArgState()})).catch(f.hitch(this,function(b){console.error("Error: Layer does not support multidimensional info");this.isRasterSingleSlice=this.mdimDefLeadsToSingleSlice=!1;this._processDimensionlessArgState()}))},_attachInputToRFxArg:function(){var a=this.inputArgs&&this.inputArgs.Dimensionless;a.input=this._templateInput;this._templateInput.set("checked",a.value?!0:!1);this._templateInput.startup()},_attachChangeListener:function(){(this.triggerArgs&&this.triggerArgs.Raster).input.on("change",
this._handleRasterChange.bind(this));(this.triggerArgs&&this.triggerArgs.Filter).input.on("change",this._handleFilterArgChange.bind(this))},_handleRasterChange:function(a){var b=a.detail.widget.getSelectedLayer(a.name);b.getMultidimensionalInfo().then(f.hitch(this,function(c){b.multidimensionalInfo=c;this.multidimensionalInfo=h.filterMDInfoIfMosiacRuleIsSet(b);this.isRasterSingleSlice=this._checkIfRasterIsSingleSlice(b);this._processDimensionlessArgState()})).catch(f.hitch(this,function(c){console.error("Error: Layer does not support multidimensional info");
this.isRasterSingleSlice=this.mdimDefLeadsToSingleSlice=!1;this._processDimensionlessArgState()}))},_handleFilterArgChange:function(a){this.mdimDefLeadsToSingleSlice=this._isMultidimensionalDefinitionAppliedSingleSlice(a);this._processDimensionlessArgState()},_checkIfRasterIsSingleSlice:function(a){var b=(a=this.multidimensionalInfo)&&a.variables;return a&&b&&1===b.length?b[0].dimensions.every(function(c){return c?1===(c&&c.values).length:!1}.bind(this)):!1},_isMultidimensionalDefinitionAppliedSingleSlice:function(a){if(0<=
["BY_ITERATION"].indexOf(a.definitionType)||1<a.variables.length||!this.multidimensionalInfo)return!1;var b=a.dimensions;if(!b)return this._isVariableSingleSlice(this.multidimensionalInfo,a.variables[0]);if(!this._isArrayUnique(b))return!1;var c=this._getDimensionNameOfVariable(this.multidimensionalInfo,a.variables[0]).every(function(e){return this._isItemInArray(b,e)}.bind(this));if(!c)return!1;if("BY_RANGES"!==a.definitionType)return c;var d=a.minValues;return a.maxValues.every(function(e,t){return d[t]===
e})},_processDimensionlessArgState:function(){var a=this._templateContainer;switch(this.isRasterSingleSlice||this.mdimDefLeadsToSingleSlice?"show":"hide"){case "show":a.classList.remove("hidden");break;default:a.classList.add("hidden")}},_getDimensionNameOfVariable:function(a,b){a=(a&&a.variables).filter(function(c){return b===c.name}.bind(this));if(!a||0===a.length)return[];a=a[0];return a.dimensions.reduce(function(c,d){d=d.name;-1==c.indexOf(d)&&c.push(d);return c}.bind(this),[])},_isVariableSingleSlice:function(a,
b){a=(a&&a.variables).filter(function(d){return b===d.name}.bind(this));if(!a||0===a.length)return!1;a=a[0];var c=a.dimensions.reduce(function(d,e){d[e.name]=e.values.length;return d}.bind(this),{});return Object.keys(c).every(function(d){return 1===c[d]}.bind(this))}});k("extend-esri")&&f.setObject("dijit.RasterFunctionEditor.RFxDimensionlessEditor",g,r);return g});