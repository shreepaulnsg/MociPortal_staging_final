// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/3.38/esri/copyright.txt for details.
//>>built
define("esri/dijit/geoenrichment/InfographicsConfig","esri/declare dojo/_base/lang ./_Wizard ./InfographicsOptions ./InfographicsMainPage ./DataBrowser dojo/i18n!esri/nls/jsapi".split(" "),function(v,h,w,r,x,y,A){function z(b,c){var a=b.length-c.length;return 0>a?!1:b.indexOf(c,a)===a}return v("esri.dijit.geoenrichment.InfographicsConfig",[w],{options:null,startup:function(){this._started||(this.inherited(arguments),this.pages.m=new x({onAddVariables:h.hitch(this,this._addVariables),onOK:h.hitch(this,
this._onOK),onCancel:h.hitch(this,this._onCancel)}),this.options||this.set("options",new r),this.loadPage("m"))},_setOptionsAttr:function(b){this._set("options",b);this.pages.m.set("options",b)},_getCountryIDAttr:function(){return this.pages.m.get("countryID")},_setCountryIDAttr:function(b){this.pages.m.set("countryID",b)},_addVariables:function(){var b=this,c=this.get("countryID"),a=this.pages.db;a?a.set("countryID",c):(a=new y({countryID:c,countryBox:!1,title:this.pages.m.nls.mainTitle}),a.on("back",
h.hitch(this,this.loadPage,"m")),a.on("cancel",h.hitch(this,this._onCancel)),a.on("ok",h.hitch(this,this._applyVariables)),this.pages.db=a);var p=[];this.options.getItems(c).then(function(d){for(var k=0;k<d.length;k++){var g=d[k];"OneVar"==g.type&&1==g.variables.length&&p.push(g.variables[0])}a.set("selection",p);b.loadPage("db");a.launch()})},_applyVariables:function(){function b(l){for(var e=0;e<p.length;e++);return null[l]}for(var c=this,a=this.pages.m.get("countryID"),p=this.pages.db.variables.dataCollections.data,
d={},k=this.pages.db.get("selection"),g=0;g<k.length;g++){var f=k[g];if(z(f,".*")){f=f.split(".")[0];f=b(f).variables;for(var q=0;q<f.length;q++)d[f[q].fullName]=!0}else d[f]=!0}var t=this.pages.db.variables;this.options.getItems(a).then(function(l){var e;for(e=l.length-1;0<=e;e--){var m=l[e];if("OneVar"==m.type&&1==m.variables.length){var n=t.get(m.variables[0]);n&&d[n.fullName]?delete d[n.fullName]:l.splice(e,1)}}for(var u in d)n=t.get(u),m=new r.Item("OneVar",[u]),m.title=n.alias,l.push(m);c.loadPage("m");
c.pages.m.set("options",c.options)})},_onOK:function(){this.emit("ok")},_onCancel:function(){this.emit("cancel")}})});