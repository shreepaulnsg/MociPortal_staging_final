// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/3.38/esri/copyright.txt for details.
//>>built
define("esri/dijit/geoenrichment/utils/requests/DataResource","dojo/_base/declare esri/dijit/geoenrichment/Deferred esri/dijit/geoenrichment/when ./UniversalClient ./FileContent ./BinaryData ./ErrorUtil".split(" "),function(l,f,g,h,d,m,e){function k(c,a){a=a||function(b){return b};return g(c,function(b){if(b instanceof Error)return a(e.makeError(b));"object"===typeof b&&b.hasOwnProperty("result")||(b={taskName:"executeTask",result:b});return a(b)},function(b){return a(e.makeError(b))})}return l(null,
{url:null,allowProxy:!1,data:null,constructor:function(c){"string"==typeof c?this.url=c:void 0!==c&&(this.data=c)},_fileContentPromise:null,getFileContent:function(c){var a=this._fileContentPromise;if(!a||c){var b=new f;a=b.promise;c||(this._fileContentPromise=a);this.getResource("bin",this._getFileContent.bind(this,b))}return a},_getFileContent:function(c,a){if(a instanceof Error)c.reject(a);else{a=a.result;if(a instanceof m){var b=a.type;a=a.data}"string"===typeof a?c.resolve(new d(a,b)):window.Blob&&
a instanceof Blob?d.fromBlob(a,b).then(c.resolve,c.reject):window.ArrayBuffer&&a instanceof ArrayBuffer?c.resolve(d.fromArrayBuffer(a,b)):a instanceof d?c.resolve(a):c.reject(e.makeError("The resource data isn't binary."))}},getResource:function(c,a){c||(c="json");if(this.data){var b="function"==typeof this.data?this.data(c):this.data;return k(b,a)}if(this.url){var n=this;b=h.request(this.url,{handleAs:c}).otherwise(function(p){return n.allowProxy?h.request(this.url,{handleAs:c,useProxy:!0}):new f.reject(p)});
return k(b,a)}b=e.makeError("Missing data and url.");return g(a?a(b):b)}})});