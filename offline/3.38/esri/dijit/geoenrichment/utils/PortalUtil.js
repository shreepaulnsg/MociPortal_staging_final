// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/3.38/esri/copyright.txt for details.
//>>built
define("esri/dijit/geoenrichment/utils/PortalUtil","dojo/_base/lang esri/kernel esri/request ./requests/EveryRequest ./requests/UniversalClient ../ReportPlayer/dataProvider/commands/mapToImage/MapToURLUtil ./CacheUtil ./ProjectionUtil ./UrlUtil".split(" "),function(n,p,r,t,l,u,v,w,m){var k={query:function(a,b,c,d){b=b||{};c=c||"results";d=d||100;var e="number"===typeof b.num?b.num:-1,g=b.num=0>e||b.num>d?d:b.num;b.start=b.start||1;return a(b).then(function(h){var x=h[c],f=h.total-b.start+1;0<=e&&
f>e&&(f=e);f-=g;if(0>=f)return h;b.num=g;for(var q=[];0<f;)b.start+=g,q.push(a.bind(null,n.mixin({},b))),f-=g;return t(q,{stopOnError:!0}).then(function(y){y.forEach(function(z){Array.prototype.push.apply(x,z[c])});return h})})},queryCommon:function(a,b){return k.query(function(c){var d=p.id.findCredential(a)||p.id.credentials[0];return r({url:a,content:n.mixin({f:"json",token:d?d.token:void 0},b,c),handleAs:"json"},{usePost:!0})}).then(function(c){return c.results})},getPortalSelf:function(a){return l.requestPublicFirst(m.combine(a,
"sharing/rest/portals/self"),{})},getDefaultBasemaps:function(a){var b=v.get("PortalUtil.basemaps");b[a]||(b[a]=k.getPortalSelf(a).then(function(c){return l.request(m.combine(a,"sharing/rest/community/groups"),{content:{q:c.useVectorBasemaps?c.vectorBasemapGalleryGroupQuery:c.basemapGalleryGroupQuery,f:"json"},handleAs:"json"}).then(function(d){return(d=d.results[0])?l.request(m.combine(a,"sharing/rest/search"),{content:{q:"group:"+d.id+' AND type:"web map"',num:100,f:"json"},handleAs:"json"}).then(function(e){return e.results}):
null})}));return b[a]},tryConfigureServicesFromAGOLPublic:function(){return k.getPortalSelf("https://www.arcgis.com").then(function(a){if(a=a&&a.helperServices)a.geometry&&w.setGeometryServiceUrl(a.geometry.url),a.printTask&&u.setPrintMapTaskUrl(a.printTask.url)}).otherwise(function(a){console.log(a)})}};return k});