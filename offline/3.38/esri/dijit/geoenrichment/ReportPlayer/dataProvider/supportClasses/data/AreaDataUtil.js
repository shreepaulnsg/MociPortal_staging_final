// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/3.38/esri/copyright.txt for details.
//>>built
define("esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/data/AreaDataUtil",["dojo/_base/lang","../../../core/supportClasses/templateJsonUtils/fieldInfo/FieldInfoNameUtil","../../../_devConfig"],function(r,u,v){var l={getAreaDataValue:function(a){function c(n){!1!==q&&(g=n[q]);void 0===g&&(g=n[b])}function e(){if(m)c(m);else{var n=f[h];n&&c(n.data)}}var b=a.fieldName,d=a.fieldData,f=a.areaDataObject,h=a.calculatorName,k=a.featureIndex,m=a.featureAttributes,t=a.ignoreMetadata,w=a.isMultiFeature;
if(!v.showAreaDataUtilUndefinedData&&b){var p=b.indexOf("."),q=!1;-1!==p&&(q=b.substr(p+1));h||-1===p||(h=b.substr(0,p));k=void 0===k?0:Number(k)||0;if((f=a.areaDataObject||d.areaData[k])||m){var g;w&&h===u.AREA_ATTRIBUTES_CALCULATOR_NAME&&!t&&d&&c(d.metadata);void 0===g&&e();if(h)return g;void 0===g&&!t&&d&&c(d.metadata);if(void 0===g&&!m)for(var x in f)if(c(f[x].data),void 0!==g)break;return g}}},getAreaDataObjectCalculator:function(a,c,e){if(!a)return null;var b=a[c];!b&&e&&(b=a[c]=l.createCalculator());
return b},createCalculator:function(a,c){return{data:a||{},comparisonLevels:c||[]}},combineAreaDataObjectCalculators:function(a,c,e){var b=[],d=[];a.forEach(function(f){if(f=l.getAreaDataObjectCalculator(f,c))b.push(f.data),d=d.concat(f.comparisonLevels)});e&&e.removeDuplicates&&(d=l.removeDuplicacatedCalcData(d));return{thisAreas:b,comparisonLevels:d}},removeDuplicacatedCalcData:function(a){if(!a.length)return a;var c=[],e={},b=Object.keys(a[0]);a.forEach(function(d){var f=function(h){var k="";b.forEach(function(m){k+=
h[m]+";"});return k}(d);e[f]||(e[f]=!0,c.push(d))});return c},setAreaDataValue:function(a,c,e,b,d){d=void 0===d?0:Number(d)||0;l.setAreaDataObjectValue(a,c,e[d],b)},setAreaDataObjectValue:function(a,c,e,b){e&&b&&null!==c&&void 0!==c&&(l.getAreaDataObjectCalculator(e,b,!0).data[a]=c)},mergeAreaData:function(a,c){c.forEach(function(e,b){(b=a[b])&&l.mergeAreaDataObjects(b,e)})},mergeAreaDataObjects:function(a,c){for(var e in a){var b=a[e],d=c[e];d?b.comparisonLevels.length!==d.comparisonLevels.length?
console.log("Error: can't merge calculators with different comparison levels!"):(r.mixin(d.data,b.data),b.comparisonLevels.forEach(function(f,h){r.mixin(d.comparisonLevels[h],f)})):c[e]=b}console.log("AreaDataUtil.js merging area data \x3d\x3e areaData");console.log(c)}};return l});