// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/3.38/esri/copyright.txt for details.
//>>built
define("esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/areas/AnalysisAreaUtil",["dojo/_base/lang","esri/geometry/webMercatorUtils","esri/dijit/geoenrichment/utils/CoordinateUtil"],function(m,n,k){var l={geometryToLatLong:function(a){var f=a.spatialReference.wkid;return f===k.WGS_84_WKID?{STORE_LONG:a.x,STORE_LAT:a.y}:k.isWebMercator(f)?(a=n.xyToLngLat(a.x,a.y),{STORE_LONG:a[0],STORE_LAT:a[1]}):null},populateCombinedAreasInfo:function(a,f){var e={},b={};f.forEach(function(c){c.latitude&&
(e[c.latitude]=1);c.longitude&&(b[c.longitude]=1)});a.name=a.name||f.map(function(c){return c.name}).join(", ");a.shortName=a.shortName||f.map(function(c){return c.shortName||c.name}).join(", ");a.description=a.description||f.map(function(c){return c.description||c.name}).join(", ");a.address=a.address||f.map(function(c){return c.address||c.name}).join(", ");a.latitude=a.latitude||Object.keys(e).join(", ");a.longitude=a.longitude||Object.keys(b).join(", ");return a},groupAreas:function(a){function f(d){var g=
d.locationName||d.name;return{isSingleAreaGroup:!0,label:g,hideGroupLabel:g===(d.shortName||d.name),areas:[d]}}var e=a.combinedAreasInfo&&a.combinedAreasInfo.groups||[],b=[],c=[],h={};a.analysisAreas.forEach(function(d){if((!a.filter||a.filter(d))&&!d.hidden)if(d.isGrouped){if(!h[d.groupIndex]){var g=e[d.groupIndex];g=h[d.groupIndex]={isRealGroup:!0,label:g.locationName||g.name,areas:[]};c.push(g);b.push(g)}h[d.groupIndex].areas.push(d)}else b.push(f(d))});if(1===b.length&&b[0].isRealGroup){b=b[0].areas.map(f);
c.length=0;var p=!0}return{groupInfos:b,isOnlyAreasInOnlyGroup:p}},parseSites:function(a){if(a.sites){a.analysisAreas=[];a.sites.forEach(function(e){e.areas.forEach(function(b){a.analysisAreas.push(b)})});a.combinedAreasInfo={groups:a.sites.map(function(e){var b=m.mixin({},e);delete b.areas;delete b.attributes;delete b.notes;delete b.images;b.indexes=e.areas.map(function(c){return a.analysisAreas.indexOf(c)});return b})};l.populateCombinedAreasInfo(a.combinedAreasInfo,a.sites);if(!a.attachmentsProvider||
!a.attachmentsProvider.getAttributesForAreaAt){a.attachmentsProvider={};a.attachmentsProvider.supportsMultipleAreas=1<a.sites.length;var f=a.attachmentsProvider.areaAttachments=[];a.sites.forEach(function(e){e.areas.forEach(function(b){f.push({attributes:e.attributes,notes:e.notes,images:e.images})})})}delete a.sites}}};return l});