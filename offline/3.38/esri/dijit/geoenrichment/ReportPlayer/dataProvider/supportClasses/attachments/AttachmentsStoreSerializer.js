// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/3.38/esri/copyright.txt for details.
//>>built
define("esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/attachments/AttachmentsStoreSerializer","esri/dijit/geoenrichment/when esri/dijit/geoenrichment/promise/all ./AttributesUtil ./NotesUtil ./CustomAttachmentsStore esri/dijit/geoenrichment/utils/ImageInfoUtil".split(" "),function(g,h,t,u,v,p){return{getAttachmentsStoreJson:function(c,k){function q(b){if(k.noCache)return b;f=f||{};for(var d in f)if(f[d]===b)return d;d="image_"+w++;f[d]=b;return d}function r(){return h([k.saveImages&&
c.getImages(),c.getAttributes(),c.getNotes()]).then(function(b){var d=b[0]||[],x=b[1]||[],y=b[2]||[];return h(d.map(function(a){return h([g(a.getThumbnail(),function(e){return p.ensureDataUrlForRemoveImage(e)}),g(a.getUrl(),function(e){return p.ensureDataUrlForRemoveImage(e)})]).then(function(e){a.__thumbnail=q(e[0]);a.__url=q(e[1])})})).then(function(){return{images:d.map(function(a){var e=a.__thumbnail,z=a.__url;delete a.__thumbnail;delete a.__url;return{description:a.description,thumbnail:e,url:z,
filename:a.filename,imageViewType:a.imageViewType}}),attributes:x.map(function(a){return t.attributeToJson(a)}),notes:y.map(function(a){return u.noteToJson(a)})}})})}if(!c)return null;var w=0,f,l=[],m=[];if(c.supportsMultipleAreas)for(var n=0;n<k.numAreas;n++)c.setCurrentAnalysisAreaIndex(n),m.push(g(r(),function(b){l.push(b)}));else m.push(g(r(),function(b){l.push(b)}));return h(m).then(function(){return{supportsMultipleAreas:c.supportsMultipleAreas,areaAttachments:l,imageDataCache:f}})},getAttachmentsStoreFromJson:function(c){return c&&
new v(c)}}});