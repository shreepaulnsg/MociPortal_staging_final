// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/3.38/esri/copyright.txt for details.
//>>built
define("esri/dijit/geoenrichment/ReportPlayer/dataProvider/commands/imageUtils/ImageSaveUtil","esri/dijit/geoenrichment/when esri/dijit/geoenrichment/Deferred esri/dijit/geoenrichment/utils/FileUtil esri/dijit/geoenrichment/utils/DataUtil esri/dijit/geoenrichment/utils/ImageUtil esri/dijit/geoenrichment/utils/async/AsyncQueue".split(" "),function(g,p,q,m,r,n){return{saveImages:function(h,a){if(h&&h.length){var t=1<h.length,k=0,b=[],c=new p,l={};g(n.executeFunctions(h.map(function(e){return function(){var f=
r.base64DataFromDataURL(e.dataURL||e),u=m.binaryStringToByteArray(atob(f)).buffer;b.push({name:function(){var d=a.reportTitle;t&&(d+="_"+a.analysisAreas[Math.floor(k/a.numPages)].name+"_Page "+(k%a.numPages+1),l[d]?d+=" ("+ ++l[d]+")":l[d]=1);return d+".png"}(),data:m.arrayBuffersToBlob([u],"image/png"),base64Data:f});k++}}),0),function(){1===b.length&&a.saveImageFunc?g(a.saveImageFunc(b[0]),c.resolve,c.reject):1<b.length&&a.saveMultipleImagesFunc?g(a.saveMultipleImagesFunc(b),c.resolve,c.reject):
g(n.executeFunctions(b.map(function(e){return function(){if(!a.skipSavingFile){var f=1===b.length&&a.fileName||e.name;return a.confirmSaveFile(f,function(){q.saveAs(e.data,f)})}}}),100),function(){c.resolve(b)},c.reject)});return c.promise}}}});