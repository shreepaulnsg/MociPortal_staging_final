// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/3.38/esri/copyright.txt for details.
//>>built
define("esri/dijit/geoenrichment/ReportPlayer/dataProvider/commands/mapToImage/DotDensityToImageUtil",["dojo/string","esri/dijit/geoenrichment/utils/ImageUtil","esri/dijit/geoenrichment/utils/ImageLayerUtil","../imageUtils/NodeToCanvasUtil"],function(l,m,k,n){var g={svgNodeToCanvasFunc:n.svgNodeToCanvasFunc,_createDotDensityImage:function(c,e,a){var b=c.getNode(),f=b.ownerSVGElement,d=document.createElementNS("http://www.w3.org/2000/svg","svg");c=c.getNavigationTransform();d.setAttribute("width",
a.width+"px");d.setAttribute("height",a.height+"px");d.setAttribute("viewBox",l.substitute("${dx} ${dy} ${width} ${height}",{dx:-c.dx,dy:-c.dy,width:a.width,height:a.height}));b=b.cloneNode(!0);b.hasAttribute&&b.hasAttribute("transform")&&b.removeAttribute("transform");d.appendChild(b);b=f.getElementsByTagName("defs");for(f=0;f<b.length;f++)d.appendChild(b[f].cloneNode(!0));return g.svgNodeToCanvasFunc(d,a.width,a.height).then(function(h){try{var p=h.toDataURL("image/png");return k.clipImageByExtent(p,
e,a.extent)}catch(q){return console.log(q),null}}).otherwise(function(h){console.log(h);return null})},isDotDensity:function(c){return c.renderer&&"esri.renderer.DotDensityRenderer"===c.renderer.declaredClass},createDotDensityImage:function(c,e,a){if(!c)return null;a=a||c.getMap();return g._createDotDensityImage(c,e,a).then(function(b){return b?{extent:b.extent,imageData:m.base64DataFromDataURL(b.dataURL)}:null})},createPictureMarkersFromDotDensityLayer:function(c,e,a){a=a||c.getMap();return g._createDotDensityImage(c,
e,a).then(function(b){return b?k.dataURLToPictureMarkers(a,b.dataURL,a.width,a.height):null})}};return g});