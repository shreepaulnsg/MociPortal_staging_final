// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/3.38/esri/copyright.txt for details.
//>>built
define("esri/dijit/geoenrichment/ReportPlayer/core/grid/valueField/ValueField","dojo/_base/Color dojo/_base/declare dojo/_base/lang dojo/on dojo/sniff dojo/dom-construct dojo/dom-class dojo/dom-geometry dijit/Destroyable ./supportClasses/TextRenderer ./supportClasses/TextEditor ./supportClasses/NumberAnimator esri/dijit/geoenrichment/utils/DomUtil esri/dijit/geoenrichment/utils/MathUtil esri/dijit/geoenrichment/utils/MouseUtil esri/dijit/geoenrichment/utils/UrlUtil".split(" "),function(z,d,g,r,A,
e,t,u,l,h,B,C,v,D,E,w){function F(a){a.domNode=e.toDom("\x3cdiv class\x3d'esriGEAdjustableGridValueField'\x3e\x3cdiv class\x3d'valueField_contentBlock'\x3e\x3cdiv class\x3d'valueField_valueBlock'\x3e\x3cdiv class\x3d'valueField_valueLabel'\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e");a.contentBlock=a.domNode.children[0];a.valueContainer=a.contentBlock.children[0];a.valueLabel=a.valueContainer.children[0]}var G=d(l,{_buildLayoutFunc:null,_parentNode:null,constructor:function(a,b){g.mixin(this,
a);this._parentNode=b;this.postCreate()},postCreate:function(){this._buildLayoutFunc(this);this["class"]&&t.add(this.domNode,this["class"]);this._parentNode&&this.placeAt(this._parentNode);this.value&&this.set("value",this.value)},get:function(a){return"value"===a?this._getValueAttr?this._getValueAttr():this.value:this[a]},set:function(a,b){"value"===a?this._setValueAttr?this._setValueAttr(b):this.value=b:this[a]=b},placeAt:function(a){e.place(this.domNode,a);return this},on:function(a,b){this.own(r(this.domNode,
a,b))},isLeftToRight:function(){return u.isBodyLtr(document)},destroy:function(){e.destroy(this.domNode);this._buildLayoutFunc=this.domNode=this._parentNode=null}});l={width:1,height:1,angle:1,opacity:1};var p={color:1,fontSize:1,lineHeight:1,fontFamily:1,fontWeight:1,fontStyle:1,textDecoration:1,backgroundColor:1,verticalAlign:1,horizontalAlign:1,horizontalPadding:1,verticalPadding:1,overrideStyle:1},m={borderTopColor:1,borderTopWidth:1,borderTopOpacity:1,borderTopStyle:1,borderRightColor:1,borderRightWidth:1,
borderRightOpacity:1,borderRightStyle:1,borderBottomColor:1,borderBottomWidth:1,borderBottomOpacity:1,borderBottomStyle:1,borderLeftColor:1,borderLeftWidth:1,borderLeftOpacity:1,borderLeftStyle:1},H=g.mixin({},l,p,m),n={verticalAlign:"top",horizontalAlign:"left",horizontalPadding:0,verticalPadding:0,angle:0,opacity:1};d=d(G,{isValueField:!0,DEFAULT_STYLES:n,viewModel:null,trimTextIfOverflows:!1,autoDetectUrl:!1,valueLabel:null,fieldStyle:null,defaultBorderStyle:null,_borderStyle:null,content:null,
postCreate:function(){this._buildLayoutFunc=this._buildLayoutFunc||F;this.inherited(arguments);this.setStyle(this.fieldStyle);this.setContent(this.content)},_destroyExistingContent:function(){this.content&&(this.content.destroy&&this.content.destroy(),this.contentContainer&&(this.contentContainer.innerHTML=""),this.content=null)},getContentContainerNode:function(a){a||this._destroyExistingContent();this.contentContainer||(this.contentContainer=e.create("div",{"class":"valueField_valueBlock"},this.contentBlock,
"first"));v.show(this.contentContainer);return this.contentContainer},setContent:function(a){this._destroyExistingContent();if(this.content=a)this.getContentContainerNode(!0),(a=this.content.domNode||this.content)&&a.parentNode!==this.contentContainer&&e.place(a,this.contentContainer);this.content?(e.destroy(this.valueContainer),this.valueContainer=null):(e.destroy(this.contentContainer),this.contentContainer=null,this._restoreValueContainer()?(a=this._value,this._value=null,this.set("value",a)):
this.set("value",this._value))},_restoreValueContainer:function(){if(this.valueContainer)return!1;this.valueContainer=e.toDom("\x3cdiv class\x3d'valueField_valueBlock'\x3e\x3cdiv class\x3d'valueField_valueLabel'\x3e\x3c/div\x3e\x3c/div\x3e");this.contentBlock.appendChild(this.valueContainer);this.valueLabel=this.valueContainer.children[0];this.setStyle(this.fieldStyle);return!0},_value:null,_getValueAttr:function(){return this._value},_setValueAttr:function(a){this._value!==a&&(this._value=a,this._setValueLabelText(a))},
_setValueLabelText:function(a){this.valueLabel&&(h.renderText(this,a,this._benchmarkInfo),this.parentGrid&&this.parentGrid.viewModel&&this.parentGrid.viewModel.isReportPlayerViewModel&&(this.row.fieldInfos&&this.row.fieldInfos[this.column.field]||!this.row.editInfo||!this.row.editInfo[this.column.field]||B.setTextEditing(this)));return a},hasOverflowText:function(){return!this.content&&h.hasOverflowText(this)},_benchmarkInfo:null,setBenchmarkInfo:function(a){this._benchmarkInfo=a},currentNumberValue:null,
numberFormatFunction:null,_canAnimate:!1,setNumberValue:function(a,b,c){this.currentNumberValue=a;this.numberFormatFunction=b;this._canAnimate=c&&this.viewModel.isAnimationAllowed();this.currentNumberValue&&this.numberFormatFunction&&this._canAnimate&&this._animateNumber()},notifyShown:function(){this.currentNumberValue&&this.numberFormatFunction&&this._canAnimate&&this._animateNumber()},_animateNumber:function(){C.animateNumber(this,this.currentNumberValue,this.numberFormatFunction)},appliedConditionalStyle:null,
getFullStyle:function(){return g.mixin({},n,this.fieldStyle)},setStyle:function(a){a=a||{};this.fieldStyle=g.mixin(this.fieldStyle||{},a);"number"===typeof this.fieldStyle.opacity&&(this.fieldStyle.opacity=Math.max(0,Math.min(1,this.fieldStyle.opacity)));a=void 0!==a.width||void 0!==a.height;this._applyAlignAndPaddingStyles();this._applyTransformStyles();this._applyTextStyleToDom(this.domNode);(a=this._setBorderStyle()||a)&&this._refreshLayout()},_applyAlignAndPaddingStyles:function(){this.domNode.style.textAlign=
this.fieldStyle.horizontalAlign||n.horizontalAlign;var a=this.fieldStyle.verticalAlign||n.verticalAlign;this.valueLabel&&(this.valueLabel.style.paddingLeft="",this.valueLabel.style.paddingRight="",this.valueLabel.style.paddingTop="","number"===typeof this.fieldStyle.horizontalPadding&&(this.valueLabel.style.paddingLeft=this.fieldStyle.horizontalPadding+"px",this._allowRightPadding()&&(this.valueLabel.style.paddingRight=this.fieldStyle.horizontalPadding+"px")),"number"===typeof this.fieldStyle.verticalPadding&&
"top"===a&&(this.valueLabel.style.paddingTop=this.fieldStyle.verticalPadding+"px"));this.valueContainer&&(this.valueContainer.style.verticalAlign=a);this.contentContainer&&(this.contentContainer.style.verticalAlign=a);this.domNode.style.opacity="number"===typeof this.fieldStyle.opacity?this.fieldStyle.opacity:""},_allowRightPadding:function(){return this.viewModel&&this.viewModel.isGraphicStyle()},_applyTransformStyles:function(){if(this.valueContainer){var a=A("webkit")?"webkitTransform":"transform";
this.valueContainer.style[a]=0!==(Number(this.fieldStyle.angle)||0)?"rotate("+this.fieldStyle.angle+"deg)":""}},_supportedTextStyles:"color fontSize lineHeight fontFamily fontWeight fontStyle textDecoration backgroundColor".split(" "),_applyTextStyleToDom:function(a){var b=this;this._supportedTextStyles.forEach(function(c){if(b.fieldStyle[c]){var k=b.fieldStyle[c]+("fontSize"===c||"lineHeight"===c?"px":"");"backgroundColor"===c?b._setNodeBackgroundColor(a,k):a.style[c]=k}else a.style[c]=""})},_setNodeBackgroundColor:function(a,
b){var c=a===this.domNode&&this.fieldStyle.angle?this.valueContainer:a;c&&(c.style.backgroundColor=b);a===this.domNode&&this.fieldStyle.angle&&(this.domNode.style.backgroundColor="transparent")},clearTextStyle:function(){for(var a in p)delete this.fieldStyle[a];this.setStyle()},clearLineHeight:function(){delete this.fieldStyle.lineHeight;this.setStyle()},_currentBorderKey:null,_SIDES:["Top","Right","Bottom","Left"],setDefaultBorderStyle:function(a){this.defaultBorderStyle=a;this._setBorderStyle()&&
this._refreshLayout()},clearBorder:function(){for(var a in m)delete this.fieldStyle[a];this.setStyle()},_setBorderStyle:function(){var a=g.mixin({},this.defaultBorderStyle,this.fieldStyle);this._borderStyle=a;var b=this._getBorderKey(a);if(this._currentBorderKey===b)return!1;this._currentBorderKey=b;this.domNode.style.border="";this._SIDES.forEach(function(c){var k="none",f=a["border"+c+"Color"],x=a["border"+c+"Width"],y=a["border"+c+"Style"]||"solid",q=a["border"+c+"Opacity"];f&&0<x&&0!==q&&"none"!==
y&&(1>q&&(f=new z(f),f.a=q,f=f.toCss(!0)),k=x+"px "+y+" "+f);this.domNode.style["border"+c]=k},this);return!0},_getBorderKey:function(a){var b="",c;for(c in m)b+=a[c]+"_";return b},_getLeftBorder:function(){return this._borderStyle?this._borderStyle.borderLeftWidth||0:0},_getLeftPadding:function(){return this.fieldStyle.horizontalPadding||0},_getRightBorder:function(){return this._borderStyle?this._borderStyle.borderRightWidth||0:0},_getRightPadding:function(){return this._allowRightPadding()?this.fieldStyle.horizontalPadding||
0:0},_getTopBorder:function(){return this._borderStyle?this._borderStyle.borderTopWidth||0:0},_getTopPadding:function(){return this.fieldStyle.verticalPadding||0},_getBottomBorder:function(){return this._borderStyle?this._borderStyle.borderBottomWidth||0:0},_getBottomPadding:function(){return this.fieldStyle.verticalPadding||0},getWidth:function(){return this.fieldStyle.width||0},getContentWidth:function(){return this.getWidth()-this._getLeftBorder()-this._getRightBorder()-this._getLeftPadding()-
this._getRightPadding()},setWidth:function(a){this.contentBlock&&this.domNode&&(a=Math.max(0,a),this.fieldStyle.width=a,this.domNode.style.width=a+"px",a=this.getWidth()-this._getLeftBorder()-this._getRightBorder(),this.contentBlock.style.width=a+"px",this.valueContainer&&(this.valueContainer.style.width=a+"px"),this.valueLabel&&(this.valueLabel.style.width=a-this._getLeftPadding()-this._getRightPadding()+"px"),this.contentContainer&&(this.contentContainer.style.width=a+"px"),h.renderText(this),this.onWidthChanged(),
this.onSizeChanged())},getHeight:function(){return this.fieldStyle.height||0},getContentHeight:function(){return this.getHeight()-this._getTopBorder()-this._getBottomBorder()-this._getTopPadding()-this._getBottomPadding()},setHeight:function(a){this.contentBlock&&this.domNode&&(a=Math.max(0,a),void 0!==this._minHeight&&(a=Math.max(a,this._minHeight)),this.fieldStyle.height=a,this.domNode.style.height=a+"px",a=this.getHeight()-this._getTopBorder()-this._getBottomBorder(),this.contentBlock.style.height=
a+"px",this.valueContainer&&(this.valueContainer.style.height=a+"px"),this.contentContainer&&(this.contentContainer.style.height=a+"px"),h.renderText(this),this.onHeightChanged(),this.onSizeChanged())},getMinHeight:function(){return this._minHeight||0},_minHeight:void 0,setMinHeight:function(a){this._minHeight=a;this.domNode.style.minHeight=a+"px";a=a-this._getTopPadding()-this._getBottomPadding();this.contentBlock.style.minHeight=a+"px";this.valueContainer&&(this.valueContainer.style.minHeight=a+
"px");this.contentContainer&&(this.contentContainer.style.minHeight=a+"px");h.renderText(this)},_refreshLayout:function(){this.setWidth(this.getWidth());this.setHeight(this.getHeight());void 0!==this._minHeight&&this.setMinHeight(this.getMinHeight())},getAngle:function(){return this.content&&this.content.getAngle?this.content.getAngle()||0:this.fieldStyle.angle||0},setAngle:function(a){this.content&&this.content.setAngle?this.content.setAngle(a):this.setStyle({angle:a||0})},isMouseOver:function(a){return this.domNode&&
E.isMouseOverBox(this.getBBox())},getBBox:function(a){a=a&&a.noTransformation?v.noTransformPosition(this.domNode):u.position(this.domNode);return 0===this.getAngle()?a:D.getRotatedRectBox(a,this.getAngle())},_urlClickHandle:null,setUrl:function(a){this._urlClickHandle&&this._urlClickHandle.remove();this.valueLabel&&(t[a?"add":"remove"](this.valueLabel,"esriGEAdjustableGridValueFieldHyperLink"),a&&(this._urlClickHandle=r(this.valueLabel,"click",function(){w.openUrl(w.toHttpUrl(a))})))},onWidthChanged:function(){},
onHeightChanged:function(){},onSizeChanged:function(){},destroy:function(){this.viewModel=null;this._destroyExistingContent();this.inherited(arguments)}});d.SUPPORTED_LAYOUT_STYLES=l;d.SUPPORTED_TEXT_STYLES=p;d.SUPPORTED_BORDER_STYLES=m;d.SUPPORTED_STYLES=H;return d});