// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/3.38/esri/copyright.txt for details.
//>>built
define("esri/dijit/geoenrichment/ReportPlayer/core/grid/coreUtils/GridFilterUtil","dojo/string ../../supportClasses/tableJson/TableJsonResizeUtil ../../supportClasses/tableJson/TableJsonUtil ./sorting/GridSortUtil ./sorting/GridRowStyler ./GridDataUtil esri/dijit/geoenrichment/utils/ObjectUtil esri/dijit/geoenrichment/utils/JsonXmlConverter dojo/i18n!esri/nls/jsapi".split(" "),function(w,x,y,z,A,n,B,C,p){p=p.geoenrichment.dijit.ReportPlayer.Grid;var t={collectStatsForVariables:function(a){var c=0,
d=[],l={};if(2>a.columns.length||3>a.rows.length)return null;var m=t.getFirstFilterableRowIndex(a)-1;a.columns.forEach(function(e,g){var q,b={alias:null,fieldName:e.field,columnIndex:g,min:Infinity,max:-Infinity,decimals:0,dataArray:[]};a._getOriginalData().forEach(function(f,h){f=n.getRenderedValue(a,f,e);h<=m?b.alias=b.alias||h===m&&C.unrichHTML(f.formattedValue):"number"===typeof f.numericValue&&(f=f.numericValue,b.min=Math.min(b.min,f),b.max=Math.max(b.max,f),b.decimals=Math.max(b.decimals,B.getPlaces(f)),
b.dataArray.push(f),c++,q=!0,l[h]=!0)});q&&(b.alias=b.alias||w.substitute(p.columnN,[g+1]),d.push(b),b._cIndex=g)});var k={};d.forEach(function(e){(k[e.alias]=k[e.alias]||[]).push(e)});for(var r in k)1<k[r].length&&k[r].forEach(function(e){e.alias+=" ("+w.substitute(p.columnN,[e._cIndex+1])+")"});d.forEach(function(e){delete e._cIndex});return 1<c&&{filterRanges:d,numVariablesTotal:c,numRowsTotal:Object.keys(l).length}},getFirstFilterableRowIndex:function(a){var c=a._getOriginalData(),d=a.columns[0].field,
l=(d=n.getDataColumnSpan(c[0],d)===a.columns.length&&!n.getDataRowSpan(c[0],d))?1:0;a=a.columns.some(function(m){return n.isVariableLikeFieldCell(n.getFieldInfo({row:c[l],column:m}))});return d?a?1:2:a?0:1},filterGridData:function(a,c){var d=[],l=0,m=0,k={};c.forEach(function(g){k[g.fieldName]=g});a._saveOriginalData();var r=t.getFirstFilterableRowIndex(a)-1;c=z.getSortableDataInfo(a);a.rows.forEach(function(g,q){var b=!0,f;q>r&&a.columns.forEach(function(h){var u=k[h.field];if(u){var v=n.getRenderedValue(a,
g,h);"number"===typeof v.numericValue&&(f=!0,v.numericValue<u.min||v.numericValue>u.max?(delete g.fieldInfos[h.field],delete g[h.field],b=!1):l++)}});b&&(d.push(g),f&&m++)});x.resizeTableJsonToFitHeight({rows:d,columns:a.columns},y.getTableHeight({rows:a.rows}));if(c&&c.styleInfo){var e=d.slice(c.topData.length);A.setAlternatingColors(e,a.columns,c.styleInfo)}a.rows=d;return{numValuesShown:l,numRowsShown:m}}};return t});