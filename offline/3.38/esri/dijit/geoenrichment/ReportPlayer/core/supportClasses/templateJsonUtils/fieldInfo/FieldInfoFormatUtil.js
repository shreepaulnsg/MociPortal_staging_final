// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/3.38/esri/copyright.txt for details.
//>>built
define("esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/templateJsonUtils/fieldInfo/FieldInfoFormatUtil",["esri/dijit/geoenrichment/ReportPlayer/countryConfig","esri/dijit/geoenrichment/utils/ObjectUtil","../../../grid/coreUtils/GridDataUtil","dojo/i18n!esri/nls/jsapi"],function(f,k,l,g){function h(a,b){b.showCurrency=-1!==a.indexOf("$");b.showPercent=-1!==a.indexOf("%");b.useThousandsSeparator=-1!==a.indexOf("#,#");b.decimals=0;-1!==a.indexOf("0.")&&(b.decimals=a.split("0").length-2);b.unitPrefix=
void 0;b.unitPrefixSymbol=void 0;if(-1!==a.indexOf("(")){var c=a.match(m)[1];-1!==c.indexOf(";")?(c=c.split(";"),b.unitPrefix=c[0],b.unitPrefixSymbol=c[1]):b.unitPrefix=c}b.isCompact=!b.unitPrefix&&-1!==a.indexOf("c")||void 0;return b}g=g.geoenrichment.dijit.ReportPlayer.ReportPlayer;var e={processFieldInfoTagAttributes:function(a){a=a||{};var b="string"===typeof a.m?h(a.m,{}):{showCurrency:"currency"===a.symbol,showPercent:"percent"===a.symbol,useThousandsSeparator:!1!==a.thousands,decimals:Number(a.decimals)||
0};return a.mObj=b},buildFormatStringFromFieldInfo:function(a){if(a&&l.isNumericVariableFieldCell(a))return e.buildFormatStringFromObject(a)},buildFormatStringFromObject:function(a){if(a){var b=a.decimals,c=a.showCurrency,n=a.showPercent,p=!!a.useThousandsSeparator,d="";c&&(d+="\\$");p&&(d+="#,#");d+="0";if(0<b)for(d+=".";b--;)d+="0";!c&&n&&(d+="\\%");a.isCompact?d+="c":a.unitPrefix&&(d+=a.unitPrefixSymbol?"("+a.unitPrefix+";"+a.unitPrefixSymbol+")":"("+a.unitPrefix+")");return d}},setFieldInfoFormat:function(a,
b){b&&"object"===typeof b?(a.showCurrency=b.showCurrency,a.showPercent=b.showPercent,a.useThousandsSeparator=!!b.useThousandsSeparator,a.decimals=Number(b.decimals)||0,a.isCompact=b.isCompact,a.unitPrefix=b.unitPrefix,a.unitPrefixSymbol=b.unitPrefixSymbol):"string"===typeof b&&h(b,a);return a}},m=/\((.+?)\)/;e.formatNumber=function(a,b,c){if(b.isMissing)return g.missingVariable;a=k.formatNumber(a,{places:b.decimals||0,noSeparator:!b.useThousandsSeparator,preserveTrailingZeroes:!0});return e.providePercentCurrencySymbols(a,
b,c)};e.providePercentCurrencySymbols=function(a,b,c){if(!a)return a;if(b.showCurrency)return b=!1,"-"===a.charAt(0)&&(b=!0,a=a.substr(1)),c&&c.placePercentCurrencyInFront?b?"-"+f.getCurrencySymbol()+a:f.getCurrencySymbol()+a:f.getCurrencyFormat().split(";")[b?1:0].replace("0",a);b.showPercent&&(a=c&&c.placePercentCurrencyInFront?"%"+a:a+"%");return a};return e});