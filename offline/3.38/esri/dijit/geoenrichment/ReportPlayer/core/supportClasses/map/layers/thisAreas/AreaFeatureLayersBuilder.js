// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/3.38/esri/copyright.txt for details.
//>>built
define("esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/map/layers/thisAreas/AreaFeatureLayersBuilder","dojo/_base/lang esri/Color esri/graphic esri/layers/GraphicsLayer esri/renderers/SimpleRenderer esri/symbols/jsonUtils ./DefaultSymbolRenderer ../../Projector esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/areas/AreasInfoTemplateBuilder esri/dijit/geoenrichment/utils/ColorUtil".split(" "),function(p,r,x,y,z,t,u,v,A,w){var m={addAreaFeatures:function(a,f){var c=a.features.filter(function(b){return"polygon"===
b.geometry.type}),l=a.features.filter(function(b){return"point"===b.geometry.type}),e=[],g=[],h={},k=new v;c.forEach(function(b,d){d=m._addFeaturesToNewLayer(b,!1,a,k,f,d);h[g.length]=a.featureIndexToAreaIndexMap[a.features.indexOf(b)];g.push(d)});l.forEach(function(b,d){b=m._addFeaturesToNewLayer(b,!0,a,k,f,d);e.push(b)});k.project();return{pointLayers:e,polygonLayers:g,polygonLayerIndexToAreaIndex:h}},_addFeaturesToNewLayer:function(a,f,c,l,e,g){var h=new y,k=c.featureIndexToAreaIndexMap[c.features.indexOf(a)],
b=c.analysisAreas[k];b=f&&(a.locationName||b.locationName)||b.name;var d=new x(null,m._getSymbolForGraphic(a,k,c),a.attributes),n=a.getLayer();d.setInfoTemplate(n&&n.infoTemplate||a.infoTemplate);!d.infoTemplate&&c.attachmentsStore&&A.buildInfoTemplateForFeature(c.attachmentsStore,d,k,b);h.name=d.infoTemplate&&d.infoTemplate.info&&d.infoTemplate.info.title||b;h.setRenderer(new z(d.symbol));v.needProject(a.geometry,c.map)?l.addForProjection(a.geometry,c.map).then(function(q){d.setGeometry(q);h.add(d)}):
(d.setGeometry(a.geometry),h.add(d));e.registerLayerInfo({layer:h,type:f?e.AREA_FEATURE_POINTS:e.AREA_FEATURE_POLYGONS,preferredIndex:g});return h},_getSymbolForGraphic:function(a,f,c){var l="point"===a.geometry.type,e=a.getLayer();if(a=e&&e.renderer&&e.renderer.getSymbol(a)||a.symbol)return t.fromJson(p.clone(a.toJson()));if(l)var g=c.pinSymbolJson;else if(a=c.areaSymbolJsons||[],e=a[f])g=e;else if(c.areaSymbolRamp&&2===c.areaSymbolRamp.length){var h=c.analysisAreas.length-a.length,k=f-a.length;
3>h?g=c.areaSymbolRamp[k]:(f=p.clone(c.areaSymbolRamp[0]),g=c.areaSymbolRamp.map(function(b){return b.color}).filter(function(b){return!!b}),a=c.areaSymbolRamp.map(function(b){return b.outline&&b.outline.color}).filter(function(b){return!!b}),e=function(b,d){var n=b[3];b=r.toJsonColor(w.toColor(w.generateGradient(d.map(function(q){return r.toDojoColor(q)}),h)[k]));b[3]=n;return b},g.length===c.areaSymbolRamp.length&&(f.color=e(f.color,g)),a.length===c.areaSymbolRamp.length&&(f.outline.color=e(f.outline.color,
a)),g=f)}return g?t.fromJson(p.clone(g)):l?u.generateSMS():u.generateSFS()}};return m});