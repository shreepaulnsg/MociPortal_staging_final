// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/3.38/esri/copyright.txt for details.
//>>built
define("esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/map/layers/LayersSorter",["dojo/_base/declare","./LayerInfoTemplateProvider","esri/dijit/geoenrichment/utils/InvokeUtil"],function(e,f,g){return e(null,{AREA_FEATURE_POINTS:"areaFeaturePoints",LOCATOR_POINTS:"locatorPoints",ADDITIONAL_LAYER_POINTS:"additionalLayerPoints",STD_POLYGON_LABELS:"stdPolygonLabels",AREA_FEATURE_POLYGONS:"areaFeaturePolygons",STD_POLYGONS:"stdPolygons",ADDITIONAL_LAYER_POLYGONS:"additionalLayerPolygons",_map:null,
_infos:null,constructor:function(b){this._map=b;this._infos=[]},registerLayerInfo:function(b){switch(b.type){case this.AREA_FEATURE_POINTS:case this.LOCATOR_POINTS:case this.ADDITIONAL_LAYER_POINTS:case this.STD_POLYGON_LABELS:b.geometryType="esriGeometryPoint";break;case this.AREA_FEATURE_POLYGONS:case this.STD_POLYGONS:case this.ADDITIONAL_LAYER_POLYGONS:b.geometryType="esriGeometryPolygon";break;default:b.geometryType=b.geometryType||("esriGeometryPoint"===b.layer.geometryType?"esriGeometryPoint":
"esriGeometryPolygon")}this._map.removeLayer(b.layer);this._infos.push(b);this.sortLayers()},addFromAdditionalLayerInfos:function(b){var c=this;b&&b.forEach(function(d){c._map.graphicsLayerIds.some(function(a){a=c._map.getLayer(a);if(a.url===d.url&&(!a.renderer||"heatmap"!==a.renderer.type))return f.provideInfoTemplate(a),c.registerLayerInfo({layer:a,type:"esriGeometryPoint"===a.geometryType?c.ADDITIONAL_LAYER_POINTS:c.ADDITIONAL_LAYER_POLYGONS,preferredIndex:d.index}),!0})})},sortLayers:function(){return g.invoke(this,
"_doSortLayers",50)},_doSortLayers:function(){function b(d){if(c._isHeatmapLayer(d))return 0;var a=0;"esriGeometryPoint"===d.geometryType&&(a+=1E6);switch(d.type){case c.STD_POLYGON_LABELS:a+=1E3;break;case c.ADDITIONAL_LAYER_POINTS:a+=2E3;break;case c.LOCATOR_POINTS:a+=3E3;break;case c.AREA_FEATURE_POINTS:a+=4E3;break;case c.ADDITIONAL_LAYER_POLYGONS:a+=1E3;break;case c.STD_POLYGONS:a+=2E3;break;case c.AREA_FEATURE_POLYGONS:a+=3E3}return a+(d.preferredIndex||0)}var c=this;this._infos.sort(function(d,
a){return b(d)-b(a)});this._infos.forEach(function(d,a){c._map.addLayer(d.layer);c._isHeatmapLayer(d)&&d.layer.setRenderer(d.layer.renderer)})},_isHeatmapLayer:function(b){return b.layer.renderer&&("heatmap"===b.layer.renderer.type||"esri.renderer.HeatmapRenderer"===b.layer.renderer.declaredClass)}})});