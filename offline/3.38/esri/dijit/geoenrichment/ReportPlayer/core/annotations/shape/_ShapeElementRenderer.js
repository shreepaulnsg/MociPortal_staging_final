// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/3.38/esri/copyright.txt for details.
//>>built
define("esri/dijit/geoenrichment/ReportPlayer/core/annotations/shape/_ShapeElementRenderer",["dojo/dom-construct","esri/dijit/geoenrichment/utils/ShapeUtil","./ShapeBarFlowDirections","./ShapeScaleAnchorPositions"],function(t,y,m,r){function A(b){function c(a){function g(k,l){"number"===typeof k&&(k=Math.round(k)+"px");"string"===typeof k&&(h.style[l]=k)}var h=t.create("div",{"class":"esriGEAbsoluteStretched shapeContainer_svgContainer shapeContainer_svgContainerShowAsBar"},b.content),f=a?d.bg:d.v;
g(f.t,"top");g(f.r,"right");g(f.b,"bottom");g(f.l,"left");g(f.w,"width");g(f.h,"height");var e=w(b,a?b.bgStyle:b.shapeStyle,h);e.style.top="auto";e.style.left="auto";switch(b.bar.flowDirection){case m.UP:e.style.bottom=(a?-f.b:0)-f.childBox.t+"px";e.style.left=f.childBox.l+"px";break;case m.DOWN:e.style.top=(a?-f.t:0)+f.childBox.t+"px";e.style.left=f.childBox.l+"px";break;case m.LEFT:e.style.top=f.childBox.t+"px";e.style.right=(a?-f.r:0)-f.childBox.l+"px";break;default:e.style.top=f.childBox.t+"px",
e.style.left=(a?-f.l:0)+f.childBox.l+"px"}}var d=B(b);b.bar.showBackground&&c(!0);c()}function B(b){var c=Math.max(0,Math.min(1,b.value)),d={t:0,r:0,b:0,l:0,w:void 0,h:void 0,childBox:{l:0,t:0}},a={t:0,r:0,b:0,l:0,w:void 0,h:void 0,childBox:{l:0,t:0}},g=b.shapeW,h=b.shapeH,f=x(b),e=b.borderWidth/2;switch(b.bar.flowDirection){case m.UP:g=f.b+c*f.h;d.t="auto";d.h=g+e;d.l=-e;d.r=-e;d.b=-e;d.childBox.t=-e;d.childBox.l=e;a.t="auto";a.b=g;a.h=h-g+e;a.l=-e;a.r=-e;a.childBox.t=0;a.childBox.l=e;break;case m.DOWN:g=
f.y+c*f.h;d.b="auto";d.h=g+e;d.l=-e;d.r=-e;d.t=-e;d.childBox.t=e;d.childBox.l=e;a.b="auto";a.t=g;a.h=h-g+e;a.l=-e;a.r=-e;a.childBox.t=0;a.childBox.l=e;break;case m.LEFT:h=f.r+c*f.w;d.l="auto";d.w=h+e;d.t=-e;d.b=-e;d.r=-e;d.childBox.t=e;d.childBox.l=-e;a.l="auto";a.r=h;a.w=g-h+e;a.t=-e;a.b=-e;a.childBox.t=e;a.childBox.l=0;break;default:h=f.x+c*f.w,d.r="auto",d.w=h+e,d.t=-e,d.b=-e,d.l=-e,d.childBox.t=e,d.childBox.l=e,a.r="auto",a.l=h,a.w=g-h+e,a.t=-e,a.b=-e,a.childBox.t=e,a.childBox.l=0}return{v:d,
bg:a}}function C(b){function c(h){function f(q){var p=w(b,h?b.bgStyle:b.shapeStyle,k);p.style.top="auto";p.style.left="auto";var u=b.bar.spaceBetween||0;switch(b.bar.flowDirection){case m.UP:p.style.bottom=q*(a+u)+(h?-l.b:0)-l.childBox.t+"px";p.style.left=l.childBox.l+"px";break;case m.DOWN:p.style.top=q*(a+u)+(h?-l.t:0)+l.childBox.t+"px";p.style.left=l.childBox.l+"px";break;case m.LEFT:p.style.top=l.childBox.t+"px";p.style.right=q*(d+u)+(h?-l.r:0)-l.childBox.l+"px";break;default:p.style.top=l.childBox.t+
"px",p.style.left=q*(d+u)+(h?-l.l:0)+l.childBox.l+"px"}}function e(q,p,u){"number"===typeof q&&(q=Math.round(q+p)+"px");"string"===typeof q&&(k.style[u]=q)}var k=t.create("div",{"class":"esriGEAbsoluteStretched shapeContainer_svgContainer shapeContainer_svgContainerShowAsBar"},b.content),l=h?g.bg:g.v;e(l.t,l.offset.t,"top");e(l.r,l.offset.r,"right");e(l.b,l.offset.b,"bottom");e(l.l,l.offset.l,"left");e(l.w,0,"width");e(l.h,0,"height");for(var n=h?g.bg.numShapes:g.v.numShapes,v=0;v<n;v++)f(v)}var d=
b.shapeW,a=b.shapeH,g=D(b);b.bar.showBackground&&c(!0);c()}function D(b){var c=x(b),d=Math.max(0,Math.min(1,b.value)),a=1,g=1,h=b.bar.spaceBetween||0,f=!b.bar.flowDirection||m.isHorizontal(b.bar.flowDirection),e=f?b.shapeW:b.shapeH;g=Math.max(1,Math.floor(((f?b.width:b.height)+h)/(Math.max(e,1)+h)));a=b.bar.wholeIcons?Math.round(d*g):Math.ceil(d*g);a={t:0,r:0,b:0,l:0,w:void 0,h:void 0,offset:{t:0,r:0,b:0,l:0},childBox:{l:0,t:0},numShapes:a};var k={t:0,r:0,b:0,l:0,w:void 0,h:void 0,offset:{t:0,r:0,
b:0,l:0},childBox:{l:0,t:0},numShapes:g},l=(b.shapeW+h)*(f?g:1)-h,n=(b.shapeH+h)*(f?1:g)-h,v=Math.floor(g*d);d=g*d-v;b.bar.wholeIcons&&(d=Math.round(d));g=0;switch(b.bar.flowDirection){case m.UP:g=c.b;break;case m.DOWN:g=c.y;break;case m.LEFT:g=c.r;break;default:g=c.x}d=(v*(e+h)+g+c[f?"w":"h"]*d)/(f?l:n);h=(b.width-b.shapeW)/2;f=(b.height-b.shapeH)/2;c=b.borderWidth/2;switch(b.bar.flowDirection){case m.UP:l=d*n;a.t="auto";a.h=l+c;a.offset.l=h;a.l=-c;a.r=-c;a.b=-c;a.childBox.t=-c;a.childBox.l=c;k.t=
"auto";k.b=l;k.h=n-l+c;k.offset.l=h;k.l=-c;k.r=-c;k.childBox.t=0;k.childBox.l=c;break;case m.DOWN:l=d*n;a.b="auto";a.h=l+c;a.offset.l=h;a.l=-c;a.r=-c;a.t=-c;a.childBox.t=c;a.childBox.l=c;k.b="auto";k.t=l;k.h=n-l+c;k.offset.l=h;k.l=-c;k.r=-c;k.childBox.t=0;k.childBox.l=c;break;case m.LEFT:n=d*l;a.l="auto";a.w=n+c;a.offset.t=f;a.t=-c;a.b=-c;a.r=-c;a.childBox.t=c;a.childBox.l=-c;k.l="auto";k.r=n;k.w=l-n+c;k.offset.t=f;k.t=-c;k.b=-c;k.childBox.t=c;k.childBox.l=0;break;default:n=d*l,a.r="auto",a.w=n+c,
a.offset.t=f,a.t=-c,a.b=-c,a.l=-c,a.childBox.t=c,a.childBox.l=c,k.r="auto",k.l=n,k.w=l-n+c,k.offset.t=f,k.t=-c,k.b=-c,k.childBox.t=c,k.childBox.l=0}return{v:a,bg:k}}function E(b){function c(a){var g=t.create("div",{"class":"esriGEAbsoluteStretched shapeContainer_svgContainer"},b.content),h=a?{l:0,t:0}:d,f=b.borderWidth/2;f&&(g.style.left=-f+"px",g.style.top=-f+"px",g.style.right=-f+"px",g.style.bottom=-f+"px",h.t+=f,h.l+=f);w(b,a?b.bgStyle:b.shapeStyleBuilder(d),g,h)}var d=F(b);b.scale.showBackground&&
c(!0);c()}function F(b){var c=x(b),d=Math.max("number"===typeof b.scale.minScale?b.scale.minScale:z.MIN_SCALE,Math.min(1,b.value)),a=b.shapeW,g=b.shapeH,h=a*d,f=g*d,e={t:0,l:0,w:h,h:f};switch(b.scale.anchorPosition){case r.TOP_LEFT:e.t=c.y*(1-d);e.l=c.x*(1-d);break;case r.TOP:e.t=c.y*(1-d);e.l=(a-h)/2;break;case r.TOP_RIGHT:e.t=c.y*(1-d);e.l=a-h-c.r*(1-d);break;case r.LEFT:e.t=(g-f)/2;e.l=c.x*(1-d);break;case r.CENTER:e.t=(g-f)/2;e.l=(a-h)/2;break;case r.RIGHT:e.t=(g-f)/2;e.l=a-h-c.r*(1-d);break;
case r.BOTTOM_LEFT:e.t=g-f-c.b*(1-d);e.l=c.x*(1-d);break;case r.BOTTOM_RIGHT:e.t=g-f-c.b*(1-d);e.l=a-h-c.r*(1-d);break;default:e.t=g-f-c.b*(1-d),e.l=(a-h)/2}return e}function w(b,c,d,a){var g=a?a.l:0,h=a?a.t:0,f=a&&a.w||b.shapeW;a=a&&a.h||b.shapeH;d=t.create("div",{"class":"shapeContainer_svgContainerElement"},d);d.style.top=h+"px";d.style.left=g+"px";d.style.width=f+"px";d.style.height=a+"px";c=y.createSVGFromJson({viewBox:b.viewBox,g:b.g},f,a,c,{noDefaults:!0,preserveAspectRatio:b.preserveAspectRatio,
ignoreFillOpacity:!0,borderScale:!b.supportNonScalingStroke});t.place(c,d);b._svgNode=c;return d}function x(b){return y.calcContentBox({viewBox:b.viewBox,g:b.g},b.shapeW,b.shapeH,b.shapeStyle,{preserveAspectRatio:b.preserveAspectRatio})}var z={renderElements:function(b){if(b.bar)b.bar.singleIcon?A(b):C(b);else if(b.scale)E(b);else{var c=t.create("div",{"class":"esriGEAbsoluteStretched shapeContainer_svgContainer"},b.content),d=b.borderWidth/2;if(d){c.style.left=-d+"px";c.style.top=-d+"px";c.style.right=
-d+"px";c.style.bottom=-d+"px";var a={l:d,t:d}}w(b,b.shapeStyle,c,a)}},MIN_SCALE:.2};return z});