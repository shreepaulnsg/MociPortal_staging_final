// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/3.38/esri/copyright.txt for details.
//>>built
define("esri/dijit/geoenrichment/ReportPlayer/core/infographics/comparison/jsonBuilder/_VariablesInRowsBuilder",["dojo/_base/lang","./_Util","../../../sections/SectionTypes"],function(q,y,C){function z(b,d,n,r){var e=q.clone(n);e.field+="_"+r;d.push(e);b.style.width+=e.style.width;b.rows.forEach(function(f,p){f.style.fields[e.field]=q.clone(f.style.fields[n.field]);(p=f.fieldInfos[n.field])&&(f.fieldInfos[e.field]=q.clone(p))});return e}return{buildForVariablesInRows:function(b,d,n){var r=d.thisAreas,
e=d.shownGeographiesInGroup,f=[],p=d.groups,t=[],u=[],A=[],v=[],m=[];b.columns.forEach(function(c,a){0<a&&delete b.rows[0][c.field]});m.push(b.columns.shift());for(var D=b.columns.length-n.numLevels,w=[],B=0;B<D;B++)w.push(b.columns.shift());r.forEach(function(c,a){if(c){var k=w[a%w.length];f.push(c);0===a?(m.push(k),k.currentFeatureIndex=a):z(b,m,k,"thisArea"+a).currentFeatureIndex=a}});b.columns.forEach(function(c,a){if(a=e[a]){f.push(a);v.push(a);a=a.StdGeographyLevel;var k=n.additionalColumnsCache[a],
l=p[a];t.push(l);m.push(c);k&&k.forEach(function(g){var h=l.cache[g];h&&(f.push(h.attributes),v.push(h.attributes),t.push({label:l.label,levelId:l.levelId,isRemovable:!0,additionalFeatureId:g,features:[h]}),z(b,m,c,g))})}});b.columns=m;if(1===m.length)return null;b.columns.forEach(function(c,a){if(0===a){var k=b.columns[1];b.rows.forEach(function(g,h){if(0!==h){u.push({label:g[c.field],points:[]});var x=g.fieldInfos[k.field];A.push({label:g[c.field],name:x.name,decimals:x.decimals,formatFunction:function(E){return y.valueFormatFunction(E,
x)}})}})}else{var l=f[a-1];c.__attributes=l;b.rows.forEach(function(g,h){0!==h&&u[h-1].points.push({label:l.StdGeographyName,value:y.setValueToGridData(l,g,c.field)})})}});return{sectionJson:{type:C.DETAILS,stack:[b]},groups:t,chartSeriesItems:u,fields:A,ranges:d.ranges,numThisAreas:d.numThisAreas,numAreasTotal:d.numAreasTotal,numAreasShown:d.numAreasShown,geographiesInTable:v,allGeographies:d.allGeographies}}}});