// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/3.38/esri/copyright.txt for details.
//>>built
define("esri/dijit/geoenrichment/ReportPlayer/core/infographics/utils/InfographicVariableLayoutUtil",["esri/dijit/geoenrichment/utils/DomUtil","esri/dijit/geoenrichment/utils/MathUtil","../../annotations/shape/ShapeJsonUtil"],function(r,n,p){var k={VARIABLE_LAYOUTS:[{value:"v1",hasIcon:!0,hasDesc:!0},{value:"v1-d",hasIcon:!0,hasDesc:!1},{value:"v2",hasIcon:!0,hasDesc:!0},{value:"v3",hasIcon:!0,hasDesc:!0},{value:"v4",hasIcon:!1,hasDesc:!0},{value:"v5",hasIcon:!1,hasDesc:!1}],getIdObj:function(b){return k.VARIABLE_LAYOUTS.filter(function(f){return f.value===
b})[0]},getClosestId:function(b,f){var c=k.hasIcon(b),g=!!b.description;if(b.shape&&b.shape.shapeJson.isPlaceholder)return"v1";if(!c&&!g)return"v5";var a=k.getBoxes(b);return c?a.variableCenter.y>a.iconBox.y+a.iconBox.h?g?"v1":"v1-d":a.variableCenter.x>a.iconBox.x+a.iconBox.w?"v3":k.isVariableInShape(b)?"v2":void 0!==f?f:g?"v1":"v1-d":"v4"},hasIcon:function(b){return b&&(b.shape&&!p.isEmptyShapeJson(b.shape.shapeJson)||b.image)},isVariableInShape:function(b){if(!k.hasIcon(b))return!1;b=k.getBoxes(b);
return n.isPointInRect(b.iconBox,b.variableCenter)&&n.isPointInRect(b.variableBox,b.iconCenter)},getBoxes:function(b){var f={};if(k.hasIcon(b)){var c=b.image?b.image.style:b.shape.style;c={x:c.left,y:c.top,w:c.width,h:c.height};f.iconBox=c;f.iconCenter={x:c.x+c.w/2,y:c.y+c.h/2}}c=b.variable.style;c={x:c.left,y:c.top,w:c.width,h:c.height};f.variableBox=c;f.variableCenter={x:c.x+c.w/2,y:c.y+c.h/2};b.description&&(b=b.description.style,b={x:b.left,y:b.top,w:b.width,h:b.height},f.descriptionBox=b,f.descriptionCenter=
{x:b.x+b.w/2,y:b.y+b.h/2});return f},getActualShapeBox:function(b,f){if(p.isEmptyShapeJson(b.shapeJson))return null;f=f.layoutBuilder.createElement("shape",{node:document.body,json:b.shapeJson,creationParams:{viewModel:f,applyThemeStyle:!1}});var c=f.getSvgNode();c=r.getNodesBox(c.children);f.destroy();return c&&{x:c.x+(b.style.width-c.w)/2,y:c.y+(b.style.height-c.h)/2,w:c.w,h:c.h}},calcLayout:function(b,f,c){function g(t,u){var q=(Math.max(50,Math.min(200,a.height))-50)/150;return t*(1-q)+u*q}var a=
b.style,h=b.shape?b.shape.style:b.image&&b.image.style,d=b.variable&&b.variable.style,e=b.description&&b.description.style;c=c&&c.noPadding;if("v1"===f){var l=a.width*(c?0:.1),m=a.width-2*l;h.left=l;h.top=0;h.width=m;h.height=g(.35*a.height,.55*a.height);d.left=l;d.top=g(.35*a.height,.55*a.height);d.width=m;d.height=g(.35*a.height,.2*a.height);d.verticalAlign="middle";e.left=l;e.top=g(.7*a.height,.75*a.height);e.width=m;e.height=g(.3*a.height,.25*a.height);e.horizontalAlign="center";e.verticalAlign=
"top"}"v1-d"===f?(l=a.width*(c?0:.1),m=a.width-2*l,h.left=l,h.top=0,h.width=m,h.height=g(.6*a.height,.8*a.height),d.left=l,d.top=g(.6*a.height,.8*a.height),d.width=m,d.height=g(.4*a.height,.2*a.height),d.verticalAlign="middle"):"v2"===f?(h.left=.15*a.width,h.top=0,h.width=.7*a.width,h.height=.725*a.height,b=.3625*a.height,f=30<=b?1:30/b,d.left=.2*a.width,d.top=.18125*a.height/f,d.width=.6*a.width,d.height=b*f,d.verticalAlign="middle",e.left=.1*a.width,e.top=g(.725*a.height,.75*a.height),e.width=a.width-
2*e.left,e.height=g(.275*a.height,.25*a.height),e.horizontalAlign="center",e.verticalAlign="top"):"v3"===f?(b.shape&&b.shape.shapeJson.showAsBar?(h.left=.03*a.width,h.top=.1*a.height,h.width=.65*a.width,h.height=.5*a.height,d.left=.65*a.width,d.top=.1*a.height,d.width=.35*a.width,d.height=.5*a.height,d.verticalAlign="middle",e.left=.03*a.width,e.top=.6*a.height,e.width=.65*a.width,e.height=.33*a.height,e.horizontalAlign="left"):(h.left=.025*a.width,h.top=0*a.height,h.width=.5*a.width,h.height=.725*
a.height,d.left=.525*a.width,d.top=0*a.height,d.width=.475*a.width,d.height=.725*a.height,d.verticalAlign="middle",e.left=.025*a.width,e.top=g(.725*a.height,.75*a.height),e.width=.5*a.width,e.height=g(.275*a.height,.25*a.height),e.horizontalAlign="center"),e.verticalAlign="top"):"v4"===f?(d.left=0,d.top=0,d.width=a.width,d.height=g(.5*a.height,.725*a.height),d.verticalAlign="middle",d=b.variable,!d.style.fontSize&&d.themeStyle&&d.themeStyle.fontSize&&(d.style.fontSize=Math.round(1.33*d.themeStyle.fontSize)),
e.left=a.width*(c?0:.1),e.top=g(.5*a.height,.75*a.height),e.width=a.width-2*e.left,e.height=g(.5*a.height,.25*a.height),e.horizontalAlign="center",e.verticalAlign="top"):"v5"===f&&(d.left=0,d.top=0,d.width=a.width,d.height=g(.7*a.height,.725*a.height),d.verticalAlign="middle")}};return k});