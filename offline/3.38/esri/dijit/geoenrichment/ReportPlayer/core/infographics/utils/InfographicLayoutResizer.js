// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/3.38/esri/copyright.txt for details.
//>>built
define("esri/dijit/geoenrichment/ReportPlayer/core/infographics/utils/InfographicLayoutResizer",["dojo/_base/lang","../../supportClasses/tableJson/TableJsonUtil","esri/dijit/geoenrichment/utils/ObjectUtil"],function(E,F,G){function x(a){var b={l:1E6,t:1E6,w:0,h:0};a.forEach(function(c){b.l=Math.min(b.l,c.left);b.t=Math.min(b.t,c.top);b.w=Math.max(b.w,c.left+c.width);b.h=Math.max(b.h,c.top+c.height)});b.w-=b.l;b.h-=b.t;return b}function B(a){var b=[];y.forEach(function(c){a[c]&&b.push(a[c].style)});
return b}function H(a,b,c,g){g=g||{};y.forEach(function(f){var d=a[f]&&a[f].style;if(d)if(g.preserveElementsSize){var n=d.left+d.width/2,w=d.top+d.height/2;n*=b;w*=c;d.left=n-d.width/2;d.top=w-d.height/2}else n=function(){var h=a[f].themeStyle;return d.fontSize||h&&h.fontSize},w=n()?n()/d.height:1,d.left*=b,d.width*=b,d.top*=c,d.height*=c,g.updateFontSize&&("description"===f||"variable"===f)&&n()&&(d.fontSize=G.roundNumber(w*d.height,2))})}var p={getContentDim:function(a){var b=a.header?F.getTableHeight(a.header)+
(a.header.style.top||0):5;b={w:a.style.width,h:a.style.height-b,t:b,l:0,prettyBoxConstraints:{minW:"number"===typeof a.style.minWidth?a.style.minWidth:50,maxW:"number"===typeof a.style.maxWidth?a.style.maxWidth:1E6,minH:"number"===typeof a.style.minHeight?a.style.minHeight:50,maxH:"number"===typeof a.style.maxHeight?a.style.maxHeight:1E6},hasHeader:!!a.header};if(a.variableTables){var c=[],g=[];a.variableTables.forEach(function(f){c.push(f.style);B(f).forEach(function(d){d=E.mixin({},d);d.left+=f.style.left;
d.top+=f.style.top;g.push(d)})});b.vtInnerBox=x(c);b.innerBox=x(g)}return b},resizeLayout:function(a,b,c,g){g=g||{};var f=p.getContentDim(a);a.style.width=b;a.style.height=c;a.header&&(a.header.columns[0].style.width="100%",g.preserveHeaderPosition?(b/=f.w,a.header.style.left*=b,a.header.style.width*=b):(a.header.style.left=0,a.header.style.top=0,a.header.style.width=a.style.width));a.variableTables&&a.variableTables.length&&p._resizeVariableTables(a,f,g)},_resizeVariableTables:function(a,b,c){function g(u,
t){a.variableTables.forEach(function(e){e.style.left+=u;e.style.top+=t})}function f(u,t){a.variableTables.forEach(function(e){e.style.left*=u;e.style.top=(e.style.top-C)*t+C;p.resizeVariableTable(e,e.style.width*u,e.style.height*t,{preserveElementsSize:!d,updateFontSize:w})})}c=c||{};var d=c.allowResizeInnerElements,n=c.ignoreMinMaxConstraints,w=c.updateFontSize,h=p.getContentDim(a),C=h.t,q=1,z=1;q=h.w/b.w;z=h.h/b.h;if(n)f(q,z);else{n=function(u,t,e,k,l,m){var v=1,r=0,A=!1;1<t?e>=m?r=(k-e)/2:k<=l?
r=(k-e)/2:e>l&&k<m?v=t:e<l&&k>l?(r=(l-e)/2,A=!0,v=k/l):e<m&&k>m&&(v=m/u,r=(k-m)/2):k>=m?r=(k-e)/2:e<=l?r=(k-e)/2:e<m&&k>l?v=t:k<l&&e>l?(v=l/u,r=(k-l)/2):e>m&&k<m&&(r=(m-e)/2,A=!0,v=k/m);return{scale:v,delta:r,shiftFirst:A}};var D=h.vtInnerBox;q=n(D.w,q,b.w,h.w,h.prettyBoxConstraints.minW,h.prettyBoxConstraints.maxW);b=n(D.h,z,b.h,h.h,h.prettyBoxConstraints.minH,h.prettyBoxConstraints.maxH);q.shiftFirst?(g(q.delta,0),f(q.scale,1)):(f(q.scale,1),g(q.delta,0));b.shiftFirst?(g(0,b.delta),f(1,b.scale)):
(f(1,b.scale),g(0,b.delta))}c.headerChanged&&(c.headerPreChangeDim.hasHeader?g(0,-(c.headerPreChangeDim.t-h.t)):g(0,h.t-c.headerPreChangeDim.t),f(1,h.h/c.headerPreChangeDim.h))}},y=["shape","image","variable","description"];p.getVariableTableContentDim=function(a){return x(B(a))};p.resizeVariableTable=function(a,b,c,g){b=b||a.style.width;c=c||a.style.height;var f=b/a.style.width||1,d=c/a.style.height||1;a.style.width=b;a.style.height=c;H(a,f,d,g)};p.fitVariableTableInBox=function(a,b){p.resizeVariableTable(a,
b.w,b.h);a.style.left=0;a.style.top=0};p.VARIABLE_TABLE_ELEMENTS=y;return p});