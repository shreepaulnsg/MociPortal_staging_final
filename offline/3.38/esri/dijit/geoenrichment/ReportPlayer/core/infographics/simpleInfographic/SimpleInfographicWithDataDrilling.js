// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/3.38/esri/copyright.txt for details.
//>>built
define("esri/dijit/geoenrichment/ReportPlayer/core/infographics/simpleInfographic/SimpleInfographicWithDataDrilling","dojo/_base/declare esri/dijit/geoenrichment/when dojo/on dojo/dom-class esri/dijit/geoenrichment/utils/DeviceUtil esri/dijit/geoenrichment/utils/TooltipUtil ../../grid/coreUtils/GridDataUtil ../utils/InfographicJsonUtil ./SimpleInfographic ./SimpleInfographicViewModes ../../dataDrilling/DataDrillingVisualizer ../../dataDrilling/DataDrillingButtonsBuilder ../../supportClasses/WidgetQueryUtil dojo/i18n!esri/nls/jsapi".split(" "),
function(l,m,n,p,q,r,t,u,v,e,w,x,y,z){return l(v,{allowDataDrilling:!0,ddVisualizer:null,ddButtonsBuilder:null,postCreate:function(){var a=this;this.inherited(arguments);q.isMobileDevice()&&this.own(n(window,"resize, orientationchange",function(){a._setViewMode({mode:e.VIEW_MAIN,showAnimation:!1})}));this.ddVisualizer=new w({viewModel:this.viewModel,theme:this.theme,parentWidget:this,currentFeatureIndex:this.currentFeatureIndex,domNode:this.domNode,closeZoomedDDWhenClickedOutside:!0,closeZoomedDDOnEsc:!0,
getInfographicJson:function(){return a._currentInfographicJson},onClose:function(){a._setViewMode({mode:e.VIEW_MAIN,showAnimation:!0})}});this.own(this.ddVisualizer);this.ddButtonsBuilder=new x({parentWidget:this});this._setViewMode({mode:e.VIEW_MAIN,skipVisualizer:!0})},_destroySections:function(){this.ddVisualizer.destroyContent();this.ddButtonsBuilder.destroyButtons();this.inherited(arguments)},_createSection:function(a,b,h,f,g,c,d){var k=this.inherited(arguments);this.allowDataDrilling&&this.viewModel.dynamicReportInfo&&
this.viewModel.enableDataDrilling&&!y.isDataDrillingView(this)&&d&&this._addDataDrillingHandlers(k,k.getTrueTables()[d.variableIndex]);return k},_addDataDrillingHandlers:function(a,b){var h=this,f=t.getFieldInfo(b.getFirstCell()),g=(b=u.getDataDrilling(this._currentInfographicJson,f.templateName))&&b.sectionJson?b:null;g&&(p.add(this.domNode,"hasDataDrilling"),a.getTrueTables().forEach(function(c){c.getCells().forEach(function(d){r.setTooltipToNode(d.domNode,null)})}),this.ddButtonsBuilder.setDataDrillingButtonForSection(a,
function(c){h._setViewMode({mode:e.VIEW_DATA_DRILLING,showAnimation:!0,triggerButton:c,customSectionJson:g.sectionJson,fieldInfo:f})}))},_mode:null,_isAnimationRunning:!1,_setViewMode:function(a){var b=a.mode,h=a.showAnimation,f=a.triggerButton,g=a.customSectionJson,c=a.fieldInfo;a=a.skipVisualizer;if(this._mode!==b&&!this._isAnimationRunning){this._isAnimationRunning=!0;var d=b===e.VIEW_DATA_DRILLING;return m(!a&&this.ddVisualizer.play(d,h,f,g,c),function(){this._isAnimationRunning=!1;this._mode=
b;this.onViewModeChanged(b)}.bind(this))}},notifyPanelScaleChanged:function(a){this.ddButtonsBuilder.notifyPanelScaleChanged(a)},onViewModeChanged:function(a){}})});