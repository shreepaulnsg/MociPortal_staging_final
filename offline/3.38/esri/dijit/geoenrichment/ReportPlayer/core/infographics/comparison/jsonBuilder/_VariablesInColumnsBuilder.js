// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/3.38/esri/copyright.txt for details.
//>>built
define("esri/dijit/geoenrichment/ReportPlayer/core/infographics/comparison/jsonBuilder/_VariablesInColumnsBuilder",["dojo/_base/lang","./_Util","../../../sections/SectionTypes","../../../grid/coreUtils/sorting/GridRowStyler"],function(w,x,C,y){return{buildForVariablesInColumns:function(b,f,z){var m=f.thisAreas,D=f.shownGeographiesInGroup,n=[],E=f.groups,p=[],q=[],A=[],r=[],k=[],t=!1,l=b.rows.slice();l.shift();l=y.getStyleInfo(l,b.columns);k.push(b.rows.shift());for(var F=b.rows.length-z.numLevels,
u=[],B=0;B<F;B++)u.push(b.rows.shift());m.forEach(function(c,a){if(c){var g=u[a%u.length];n.push(c);0===a?(k.push(g),g.currentFeatureIndex=a):(c=w.clone(g),k.push(c),c.currentFeatureIndex=a,t=!0)}});b.rows.forEach(function(c,a){if(a=D[a]){n.push(a);r.push(a);a=a.StdGeographyLevel;var g=z.additionalColumnsCache[a],h=E[a];p.push(h);k.push(c);g&&g.forEach(function(d){var e=h.cache[d];e&&(n.push(e.attributes),r.push(e.attributes),p.push({label:h.label,levelId:h.levelId,isRemovable:!0,additionalFeatureId:d,
features:[e]}),d=w.clone(c),k.push(d),t=!0)})}});b.rows=k;if(1===k.length)return null;t&&l&&(m=b.rows.slice(),m.shift(),y.setAlternatingColors(m,b.columns,l,{forceOverrideOriginal:!0}));b.rows.forEach(function(c,a){if(0===a){var g=b.rows[1];b.columns.forEach(function(d,e){if(0!==e){q.push({label:c[d.field],points:[]});var v=g.fieldInfos[d.field];A.push({label:c[d.field],name:v.name,decimals:v.decimals,formatFunction:function(G){return x.valueFormatFunction(G,v)}})}})}else{var h=n[a-1];c.__attributes=
h;b.columns.forEach(function(d,e){0!==e&&q[e-1].points.push({label:h.StdGeographyName,value:x.setValueToGridData(h,c,d.field)})})}});return{sectionJson:{type:C.DETAILS,stack:[b]},groups:p,chartSeriesItems:q,fields:A,ranges:f.ranges,numThisAreas:f.numThisAreas,numAreasTotal:f.numAreasTotal,numAreasShown:f.numAreasShown,geographiesInTable:r,allGeographies:f.allGeographies}}}});