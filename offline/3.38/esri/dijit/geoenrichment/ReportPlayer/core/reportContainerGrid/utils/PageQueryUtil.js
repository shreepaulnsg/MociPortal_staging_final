// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/3.38/esri/copyright.txt for details.
//>>built
define("esri/dijit/geoenrichment/ReportPlayer/core/reportContainerGrid/utils/PageQueryUtil",["dojo/dom-geometry","esri/dijit/geoenrichment/utils/ColorUtil","esri/dijit/geoenrichment/utils/DomUtil"],function(u,x,v){var w={getElementPageInfo:function(a){function f(b,c){b=u.position(b.domNode);c=u.position(c.domNode);d.x+=b.x-c.x;d.y+=b.y-c.y}function n(b){g||(b=b.getFullStyle().backgroundColor)&&!x.isTransparent(b)&&(g=b)}function k(b){if(b)if(b.parentGridCell&&n(b.parentGridCell),b.parentElementInPageInfo)b=
b.parentElementInPageInfo,h=b.reportContainer,g=g||b.panelBackgroundColor,d.x+=b.pos.x,d.y+=b.pos.y,p=b.pageGrid,m=b.gridContainer,r=b.pageIndex,q=b.layoutCell,t=b.isBackgroundFloatingPanel,e=b.isForegroundFloatingPanel,l=b.panelIndex;else{var c=b.parentWidget;c&&c.isReportContainerGrid?(h=c,b=w.getNodePositionOnPage(h,b.domNode),c=w.getNodePositionOnPage(h,a.domNode),b&&c&&(d.x+=b.x,d.y+=b.y,p=b.pageGrid,m=b.gridContainer,r=b.pageIndex,q=c.layoutCell,t=c.isBackgroundFloatingPanel,e=c.isForegroundFloatingPanel,
l=c.panelIndex)):c&&(f(b,c),k(c))}}if(a&&a.parentWidget&&(!a.viewModel||a.viewModel.isGraphicStyle())){var h,d={x:0,y:0},p,m,r,q,g,t,e,l;a.isValueField&&a.parentGrid&&a.row&&a.column?(n(a),f(a,a.parentGrid),k(a.parentGrid)):k(a);return h&&q?{reportContainer:h,documentOptions:h.documentOptions,pos:d,zoom:h.getZoomInfo().scale,pageGrid:p,gridContainer:m,pageIndex:r,layoutCell:q,panelBackgroundColor:g,isFloatingPanel:t||e,isBackgroundFloatingPanel:t,isForegroundFloatingPanel:e,panelIndex:l}:null}},getReportContainerPageNode:function(a){for(;a;){if(a.reportContainerPageNode)return a.reportContainerPageNode;
a=a.parentWidget||a.parentGrid}return null},getParentReportContainerGrid:function(a){if(a&&a.isReportContainerGrid)return a;for(;a;){if(a.parentWidget&&a.parentWidget.isReportContainerGrid)return a.parentWidget;if(a.parentElementInPageInfo)return a.parentElementInPageInfo.reportContainer;a=a.parentWidget||a.parentGrid}return null},getParentReportPlayer:function(a){if(a&&a.isPlayer)return a;for(;a;){if(a.parentWidget&&a.parentWidget.isPlayer)return a.parentWidget;a=a.parentWidget||a.parentGrid}return null},
getNodePositionOnPage:function(a,f){if(!f)return null;var n,k=-1,h,d,p,m;a.getGrids().some(function(g,t){if(g.domNode===f||v.isChildOf(f,g.domNode))return n=g,h=t,g.getCells().some(function(e,l){if(e.domNode===f||v.isChildOf(f,e.domNode))return k=l,m=e,!0}),-1===k&&g.getBackgroundFloatingCells().some(function(e,l){if(e.domNode===f||v.isChildOf(f,e.domNode))return k=l,d=!0,m=e,!0}),-1===k&&g.getForegroundFloatingCells().some(function(e,l){if(e.domNode===f||v.isChildOf(f,e.domNode))return k=l,p=!0,
m=e,!0}),!0});if(!n)return null;a=a.getGridContainer(n);var r=u.position(a),q=u.position(f);return{x:q.x-r.x,y:q.y-r.y,pageGrid:n,gridContainer:a,pageIndex:h,layoutCell:m,isFloatingPanel:d||p,isBackgroundFloatingPanel:d,isForegroundFloatingPanel:p,panelIndex:k}}};return w});