// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/3.38/esri/copyright.txt for details.
//>>built
require({cache:{"url:esri/dijit/geoenrichment/ReportPlayer/core/templates/ReportContainerGrid.html":'\x3cdiv class\x3d"esriGEReportPlayer_reportContainerGrid esriGENonSelectable"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"mainContainer" class\x3d"reportContainerGrid_mainContainer"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"fillerContainer" class\x3d"reportContainerGrid_gridZoomFillerContainer"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"scalableContainer" class\x3d"reportContainerGrid_gridZoomScalableContainer"\x3e\r\n                \x3cdiv data-dojo-attach-point\x3d"stackContainer" class\x3d"reportContainerGrid_gridStackContainer"\x3e\x3c/div\x3e\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e'}});
define("esri/dijit/geoenrichment/ReportPlayer/core/reportContainerGrid/ReportContainerGrid","dojo/_base/declare dojo/_base/lang esri/dijit/geoenrichment/promise/all esri/dijit/geoenrichment/Deferred esri/dijit/geoenrichment/when dojo/dom-construct dojo/dom-class dojo/dom-geometry dojo/dom-style dijit/_WidgetBase dijit/_TemplatedMixin ./_HiddenContentSupport ./_ScrollSupport ./_ZoomSupport ./utils/QueryUtil ./utils/SerializationManager ../supportClasses/DocumentOptions ../themes/BackgroundThemeUtil esri/dijit/geoenrichment/utils/DomUtil esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/ViewModes dojo/text!../templates/ReportContainerGrid.html".split(" "),
function(r,n,p,t,h,d,k,f,e,u,v,w,x,y,l,z,A,B,C,q,D){return r([u,v,w,x,y],{templateString:D,isReportContainerGrid:!0,viewModel:null,theme:null,parentWidget:null,currentFeatureIndex:null,renderOptions:null,documentOptions:null,tooltipInfo:null,serializationManager:null,_grids:null,_enableAsyncRendering:!0,postCreate:function(){this.renderOptions=n.mixin({center:!1,minTop:0,minRight:0,minBottom:0,minLeft:0},this.renderOptions);this.serializationManager=(new this._getSerializationManagerClass)(this);
this._grids=[];this.inherited(arguments);this.setViewMode(q.PREVIEW_VALUES)},_getSerializationManagerClass:function(){return z},getFirstPageNode:function(){var a=this.stackContainer.children[0];return a&&a.children[0]},getPageNodes:function(){for(var a=[],b=0;b<this.stackContainer.children.length;b++)a.push(this.stackContainer.children[b].children[0]);return a},getPageRowNodes:function(){for(var a=[],b=0;b<this.stackContainer.children.length;b++)a.push(this.stackContainer.children[b]);return a},_placeGridContainer:function(a,
b){var c=d.create("div",{"class":"reportContainerGrid_gridContainerWrapper"});(b=void 0!==b&&this.stackContainer.children[b])?d.place(c,b,"before"):d.place(c,this.stackContainer);d.place(a,c);a.backgroundImage=d.create("div",{"class":"reportContainerGrid_stackContainerBackgroundImage esriGEAbsoluteStretched"},a)},getGridContainer:function(a){return this._getGridContainer(a)},_getGridContainer:function(a){a=a.isFloatingTable?a.parentGrid:a;return a.domNode&&a.domNode.parentNode},_getGridContainerWrapper:function(a){return(a=
this._getGridContainer(a))&&a.parentNode},_updateGridWrappingNodeForCurrentDocumentLayout:function(a){a.isEmptyTable()&&e.set(a.domNode,{width:this._getAllowedPageWidth()+"px",height:this._getPageHeight()+"px"});if(a=this._getGridContainer(a)){var b=this.viewModel.getDocumentDefaultStyles(this.theme);e.set(a,{paddingLeft:(this.documentOptions.left||0)+"px",paddingRight:(this.documentOptions.right||0)+"px",paddingTop:(this.documentOptions.top||0)+"px",paddingBottom:(this.documentOptions.bottom||0)+
"px",backgroundColor:this.documentOptions.backgroundColor||b&&b.backgroundColor})}B.renderThemeBackgroundImage(a.backgroundImage,b&&b.backgroundImage)},getCurrentPageDim:function(){return A.getPageBox(this.documentOptions)},_getAllowedPageWidth:function(){return this.getCurrentPageDim().contentW},_getPageHeight:function(){return this.getCurrentPageDim().contentH},getTemplateVisibleBox:function(){var a=f.position(this.mainContainer),b=f.position(this.fillerContainer),c={x:Math.max(a.x,b.x),y:a.y,h:a.h};
c.w=Math.min(a.x+a.w,b.x+b.w)-c.x;return c},_currentPageIndex:-1,getFullWidth:function(){var a=this.getFirstPageNode();return f.getMarginBox(a).w+f.getMarginExtents(this.stackContainer).w},getFullHeight:function(){var a=this.getFirstPageNode();return f.getMarginBox(a).h+f.getMarginExtents(this.stackContainer).h},getNumberOfPages:function(){return this._grids.length},showAllPages:function(){this.showPageAt(-1)},showPageAt:function(a){this._grids.forEach(function(b,c){var g=-1===a||a===c;(c=C[g?"showNodeFromBackground":
"hideNodeInBackground"](this._getGridContainerWrapper(b),"reportContainerPage_"+c))&&this.own(c);this.isCurrentContainer()&&g&&b.notifyShown()},this);this._currentPageIndex=a;this._syncFillerContainer();this.onShownPageIndexChanged(this._currentPageIndex)},getShownGrid:function(){return this._grids[this._currentPageIndex]},getShownGrids:function(){return-1===this._currentPageIndex?this._grids:[this.getShownGrid()]},getCurrentPageIndex:function(){return this._currentPageIndex},getGrids:function(){return this._grids},
isCurrentContainer:function(){return!1},getLayersOpacity:function(a){return(a=this.getGrids()[a])&&{foregroundCells:a.foregroundFloatingTablesSection?a.foregroundFloatingTablesSection.getStyle().opacity:void 0,fixedCells:a.getSettings().style.fixedCellsOpacity,backgroundCells:a.backgroundFloatingTablesSection?a.backgroundFloatingTablesSection.getStyle().opacity:void 0}},setLayersOpacity:function(a,b){a&&(b=this.getGrids()[b])&&(void 0!==a.foregroundCells&&b.foregroundFloatingTablesSection&&b.foregroundFloatingTablesSection.setStyle({opacity:a.foregroundCells}),
void 0!==a.fixedCells&&b.setOpacity({fixedCellsOpacity:a.fixedCells}),void 0!==a.backgroundCells&&b.backgroundFloatingTablesSection&&b.backgroundFloatingTablesSection.setStyle({opacity:a.backgroundCells}))},_width:0,_heigth:0,resize:function(a,b){this._width=void 0===a?this._width:a;this._heigth=void 0===b?this._heigth:b;void 0!==a&&e.set(this.domNode,"width",0===this._width?"auto":this._width+"px");void 0!==b&&e.set(this.domNode,"height",0===this._heigth?"auto":this._heigth+"px");this._updateContainerSize();
this.onResized()},_updateContainerSize:function(){e.set(this.mainContainer,"height",0===this._heigth?"auto":this.domNode.clientHeight+"px");e.set(this.mainContainer,"maxWidth",this._maxWidth?this._maxWidth+"px":"");e.set(this.mainContainer,"maxHeight",this._maxHeight?this._maxHeight+"px":"");this._syncFillerContainer()},_maxWidth:0,_maxHeight:0,setMaxWidth:function(a){this._maxWidth=a},setMaxHeight:function(a){this._maxHeight=a},screenToPageCoords:function(a,b){return l.screenToPageCoords(this,a,
b)},getLayoutCells:function(a){a=a||{};return l.getLayoutCells(this,{sectionFuncName:a.sectionFuncName,floatingCells:!1!==a.floatingCells,topFirst:a.topFirst,visibleOnly:a.visibleOnly})},getCellPageGrid:function(a){return a&&a.parentGrid?a.parentGrid.isFloatingTable?a.parentGrid.parentGrid:a.parentGrid:null},getFloatingTables:function(a){return l.getFloatingTables(this,a)},clear:function(){this._grids.forEach(function(a,b){a.destroy()},this);this._grids.length=0;this.stackContainer&&(this.stackContainer.innerHTML=
"");this._syncFillerContainer()},_removeGrid:function(a){if(a){var b=this._getGridContainerWrapper(a);a.destroy();b&&d.destroy(b);this._grids.splice(this._grids.indexOf(a),1);this._syncFillerContainer()}},removeGridAt:function(a){this._removeGrid(this._grids[a])},getGridJsonAt:function(a){return this._grids[a].toJson()},setHeight:function(a){e.set(this.mainContainer,"height",a+"px")},_viewMode:null,getViewMode:function(){return this._viewMode},setViewMode:function(a){this._viewMode!==a&&(this._viewMode=
a,a===q.EDIT?(k.add(this.domNode,"reportContainerEditMode"),k.remove(this.domNode,"reportContainerPreviewMode")):(k.remove(this.domNode,"reportContainerEditMode"),k.add(this.domNode,"reportContainerPreviewMode")),this._grids.forEach(function(b,c){b.setViewMode(a)},this))},createGridFromSectionTableJson:function(a,b,c){void 0!==b&&"replace"===c&&this._removeGrid(this._grids[b]);c=d.create("div",{"class":"reportContainerGrid_stackContainer"});this._placeGridContainer(c,b);c=this._createGridFromTableJson(a,
c);c.setMaxWidth(this._getAllowedPageWidth());c.setSettings({style:{width:this._getAllowedPageWidth(),left:0,top:0,spaceAfter:0,fixedCellsOpacity:a.style.fixedCellsOpacity},viewMode:this._viewMode});this._updateGridWrappingNodeForCurrentDocumentLayout(c);void 0!==b?this._grids.splice(b,0,c):this._grids.push(c);this._syncFillerContainer();return c},_getGridClass:function(){return this.viewModel.layoutBuilder.getClass("grid")},_createGridFromTableJson:function(a,b){return new (this._getGridClass())(n.mixin({"class":"outerAdjustableGrid",
viewModel:this.viewModel,theme:this.theme,currentFeatureIndex:this.currentFeatureIndex,parentWidget:this,viewPortContainer:this.mainContainer,reportContainerPageNode:b,isReportContainerPageGrid:!0,columns:a.columns||[],rows:a.rows||[],backgroundSectionJson:a.backgroundSectionJson,foregroundSectionJson:a.foregroundSectionJson,backgroundFloatingTablesSectionJson:a.backgroundFloatingTablesSectionJson,foregroundFloatingTablesSectionJson:a.foregroundFloatingTablesSectionJson,stickToRight:!0,looseResize:!0,
layoutDefaults:{defaultRowHeight:250,rowMinHeight:30,columnMinWidth:50},renderBordersFromTheme:!0,hasRealBorders:!0,inheritThemeBackground:!1,enableBackgroundForeground:!0,enableAsyncRendering:this._enableAsyncRendering},this._getGridCreationParams(b)),d.create("div",null,b))},_getGridCreationParams:function(a){return null},notifyShown:function(){h(this.serializationManager.notifyShown(),function(){this.getShownGrid()&&this.getShownGrid().notifyShown()}.bind(this))},getVisualState:function(){return{type:"reportContainerGrid",
pages:this._grids.map(function(a,b){return a.getVisualState()})}},setVisualState:function(a){return a&&a.pages&&p(this._grids.map(function(b,c){return b.setVisualState(a.pages[c])}))},_pagePromise:null,_contentPromise:null,fromJson:function(a,b){b=b||{};var c=this;this._enableAsyncRendering=!b.renderSync;this._contentPromise=this._pagePromise=null;var g;b.keepZoom?g=this.getZoomInfo():this.resetZoom();this._currentPageIndex=-1;var m=new t;b.waitUntilAllContentIsReady?(this._pagePromise=this.serializationManager.fromJson(a,
b),this._contentPromise=h(this._pagePromise,function(){return p(this.getGrids().map(function(E){return E.getRenderPromise()}))}.bind(this))):this._pagePromise=this.serializationManager.fromJson(a,b);h(this._pagePromise,function(){this._pagePromise=null}.bind(this));h(b.waitUntilAllContentIsReady?this._contentPromise:this._pagePromise,m.resolve,m.reject);return h(m.promise,function(){g&&c.setZoomInfo(g)})},getPagePromise:function(){return this._pagePromise},getContentPromise:function(){return this._contentPromise},
toJson:function(a){return this.serializationManager.toJson(a)},onPendingDataApplied:function(){},onShownPageIndexChanged:function(a){},onResized:function(){},destroy:function(){this.clear();this.inherited(arguments)}})});