// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/3.38/esri/copyright.txt for details.
//>>built
define("esri/dijit/geoenrichment/ReportPlayer/core/conversion/portalToEditorUtils/metadata/LocatorCalculatorsParser",["esri/dijit/geoenrichment/promise/all","esri/dijit/geoenrichment/when","esri/dijit/geoenrichment/utils/JsonXmlConverter","../variables/VariableUtil"],function(k,l,e,m){return{parseLocatorCalculators:function(f,n,d){f=e.queryJson(f,"Locator");return k(f.map(function(b){var g=[];e.queryJson(b,/^(PointFields|Fields)$/).forEach(function(a){g=g.concat(e.queryJson(a,/^(Field|Direction|Distance)$/))});
var h=[];g.forEach(function(a){"Direction"===a.name?a.attributes.MapTo="DIRECTION":"Distance"===a.name&&(a.attributes.MapTo="DISTANCE");(a=m.fieldTagToVariable(a,b.attributes.Name))&&h.push(a)});var c={calculatorName:b.attributes.Name,variableObjects:h,layerID:null,layerUrl:null,layerName:b.attributes.LayerName};b.attributes.Points&&0===b.attributes.Points.indexOf("std:")?c.layerID=b.attributes.Points.replace("std:",""):c.layerUrl=b.attributes.Layer;n.metadata.locatorCalculatorsHash[b.attributes.Name]=
c;d.variableProvider.isPlayerOnly&&h.forEach(function(a){d.variableProvider.addVariable(a)});return l(!d.validateLocatorCalculator||d.validateLocatorCalculator(c.layerID,c.layerUrl),function(a){c.isValid=a})}))}}});