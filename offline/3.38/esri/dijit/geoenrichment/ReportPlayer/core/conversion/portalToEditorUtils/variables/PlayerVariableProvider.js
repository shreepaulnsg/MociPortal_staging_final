// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/3.38/esri/copyright.txt for details.
//>>built
define("esri/dijit/geoenrichment/ReportPlayer/core/conversion/portalToEditorUtils/variables/PlayerVariableProvider",["dojo/_base/declare","dojo/_base/lang","dojo/string","dojo/i18n!esri/nls/jsapi"],function(f,l,g,e){e=e.geoenrichment.dijit.ReportPlayer.Variables;var m=f(null,{variable:null,constructor:function(a){this.variable=a},calculate:function(a){return 0},getCalcType:function(){return"n/"},getAliasWithType:function(){return this.variable.alias},getDescriptionWithType:function(){return this.variable.alias},
getDecimals:function(){return this.variable.precision||0}});return f(null,{isPlayerOnly:!0,_fieldNameToVariableCache:null,_templateNameToVariableCache:null,constructor:function(a){this._templateNameToVariableCache=a&&a.templateNameToVariableCache||{};this._fieldNameToVariableCache={};for(var b in this._templateNameToVariableCache)a=this._templateNameToVariableCache[b],this._fieldNameToVariableCache[a.fieldName]=a},get:function(a){return this._templateNameToVariableCache[a]||this._fieldNameToVariableCache[a]},
toCalculator:function(a){return(a=this.get(a))&&new m(a)},addVariable:function(a){this._fieldNameToVariableCache[a.fieldName]=a;this._templateNameToVariableCache[a.templateName]=a},addScriptVariable:function(a){this._fieldNameToVariableCache[a.fieldName]=a;this._templateNameToVariableCache[a.templateName]=a},getVariables:function(){return Object.keys(this._fieldNameToVariableCache).map(function(a){return this._fieldNameToVariableCache[a]},this)},getVariablesDataVintageAndSources:function(a){var b=
[],d={},h={};this.getVariables().forEach(function(c){c.fullName&&(h[c.fullName.toLowerCase()]=c)});for(var n in a.usedVariablesCache)if((a=h[n.toLowerCase()])&&a.vintage&&a.source){var k=a.vintage+";"+a.source;d[k]||(d[k]=!0,b.push({vintage:a.vintage,source:a.source}))}d=b.map(function(c){return c.source}).join(", ");b=b.map(function(c){return c.vintage}).join(", ");return{dataVintageDescription:d&&b?g.substitute(e.sourcePattern,{source:d})+" "+g.substitute(e.vintagePattern,{vintage:b}):"",dataSources:d,
dataVintage:b}},toJson:function(){return{templateNameToVariableCache:l.clone(this._templateNameToVariableCache)}}})});