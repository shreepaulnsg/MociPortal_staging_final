// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/3.38/esri/copyright.txt for details.
//>>built
define("esri/dijit/geoenrichment/ReportPlayer/core/conversion/portalToEditorUtils/parsers/infographic/DynamicInfographicParser",["../../../ConversionUtil","esri/dijit/geoenrichment/ReportPlayer/core/infographics/InfographicTypes","../../../../infographics/utils/InfographicJsonUtil","../_FieldInfoBuilder","esri/dijit/geoenrichment/utils/JsonXmlConverter"],function(h,f,m,k,l){function n(a,b){var c=function(g){return h.ptToPxObj(h.parseStyleString(g))};switch(b.type){case f.AGE_PYRAMID:b.showVerticalAxis=
!!a.showVerticalAxis;break;case f.TAPESTRY:case f.PRIZM5:b=b.style;b.titleStyle=a.titleStyle&&c(a.titleStyle);b.tableBackgroundColor=a.tableBackgroundColor;b.tableBorderColor=a.tableBorderColor;b.textStyle=a.textStyle&&c(a.textStyle);b.subtextStyle=a.subtextStyle&&c(a.subtextStyle);b.hyperlinkTextStyle=a.hyperlinkTextStyle&&c(a.hyperlinkTextStyle);b.detailsValueBorderColor=a.detailsValueBorderColor;break;case f.ONE_VAR:b=b.style;b.titleStyle=a.titleStyle&&c(a.titleStyle);b.subtitleStyle=a.subtitleStyle&&
c(a.subtitleStyle);b.valueStyle=a.valueStyle&&c(a.valueStyle);b.valueDescStyle=a.valueDescStyle&&c(a.valueDescStyle);b.tableHeaderStyle=a.tableHeaderStyle&&c(a.tableHeaderStyle);b.tableDefaultStyle=a.tableDefaultStyle&&c(a.tableDefaultStyle);b.tableThisAreaStyle=a.tableThisAreaStyle&&c(a.tableThisAreaStyle);b.tableAltStyle=a.tableAltStyle&&c(a.tableAltStyle);b.tableBorderColor=a.tableBorderColor;b.thisAreaBarColor=a.thisAreaBarColor;b.positiveBarColor=a.positiveBarColor;break;case f.RELATED_VARS:b=
b.style,b.titleStyle=a.titleStyle&&c(a.titleStyle),b.highLabelStyle=a.highLabelStyle&&c(a.highLabelStyle),b.lowLabelStyle=a.lowLabelStyle&&c(a.lowLabelStyle),b.tableHeaderStyle=a.tableHeaderStyle&&c(a.tableHeaderStyle),b.tableDefaultStyle=a.tableDefaultStyle&&c(a.tableDefaultStyle),b.tableAltStyle=a.tableAltStyle&&c(a.tableAltStyle),b.tableBorderColor=a.tableBorderColor,b.positiveBarColor=a.positiveBarColor,b.negativeBarColor=a.negativeBarColor,b.diffPositiveColor=a.diffPositiveColor,b.diffNegativeColor=
a.diffNegativeColor,b.comparisonLabelStyle=a.comparisonLabelStyle&&c(a.comparisonLabelStyle)}}return{portalToEditor:function(a,b){var c=a.attributes.name,g=b.templateJson.metadata.comparisonCalculatorsHash[c],d={type:f.fixTapestryNameToWidget(a.attributes.type),title:a.attributes.title||"",style:{width:h.ptToPx(a.attributes.width),height:h.ptToPx(a.attributes.height),padding:a.attributes.padding?h.ptToPx(a.attributes.padding):void 0,backgroundColor:a.attributes.backgroundColor}};n(a.attributes,d);
if(g){g.levels&&m.setLevels(d,g.levels);a=(a=l.queryTopJson(a,"fields")[0])&&l.queryTopJson(a,"d");d.fieldInfos=a.length?a.map(function(e){return k.getCalculatorOrScriptFieldInfo(e.attributes.f,b,{format:e.attributes.m})}):g.variableObjects.map(function(e){return k.getCalculatorOrScriptFieldInfo(e.templateName,b)});if(d.fieldInfos.some(function(e){return e.isMissing}))return null;d.calcData={calculatorName:c,variables:d.fieldInfos.map(function(e){return e.fullName})}}else d.variables=a.attributes.dataCollectionID?
[a.attributes.dataCollectionID+".*"]:[a.attributes.variableID];return d}}});