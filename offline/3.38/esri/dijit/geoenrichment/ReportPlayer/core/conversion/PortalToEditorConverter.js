// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/3.38/esri/copyright.txt for details.
//>>built
define("esri/dijit/geoenrichment/ReportPlayer/core/conversion/PortalToEditorConverter","esri/dijit/geoenrichment/when esri/dijit/geoenrichment/ReportPlayer/config ./portalToEditorUtils/layout/LayoutParser ./portalToEditorUtils/metadata/MetadataParser ./portalToEditorUtils/ImageCollector ./portalToEditorUtils/parsers/Parsers ./portalToEditorUtils/variables/PlayerVariableProvider ../supportClasses/DefaultStyles ../supportClasses/images/ImageDataHolder ../themes/conversion/CssParser esri/dijit/geoenrichment/utils/async/AsyncQueue esri/dijit/geoenrichment/utils/DelayUtil".split(" "),
function(g,u,v,w,x,p,y,z,q,A,B,C){return{provideEditorJson:function(n,a){function D(){function e(d,b,c){return g(a.preProcessFile&&a.preProcessFile(d,b,f),function(h){if(!1!==h)return g(c&&c(),function(){return a.postProcessFile&&a.postProcessFile(d,b,f)})})}if(k&&k.files&&k.files){var E=a.filesToProcess||["theme.css.txt","metadata.xml","report.xml"],r={"theme.css.txt":function(d){return e(d,"theme.css.txt",function(){f.theme=A.fromCssText(d.data,a)})},"metadata.xml":function(d){return e(d,"metadata.xml",
function(){return w.parseMetadataXML(d,f,a)})},"report.xml":function(d){return e(d,"report.xml",function(){return v.parseReportXML({report:n,parsers:p,file:d,templateJson:f,variableProvider:a.variableProvider,useVariableProviderToCollectOnly:a.useVariableProviderToCollectOnly,tableDefaultStyles:a.tableDefaultStyles,processFileName:m,putImageData:function(b,c){b=m(b);c=c||l[b];q.putImageData(b,c);return c},log:F,queryMetaDataFunc:function(b){return a.queryMetaDataFunc&&a.queryMetaDataFunc(b,f)},postProcessChartJson:function(b,
c){a.postProcessChartJson&&a.postProcessChartJson(f,b,c)},postProcessMapJson:function(b,c){a.postProcessMapJson&&a.postProcessMapJson(f,b,c)},postProcessInfographicJson:function(b,c){a.postProcessInfographicJson&&a.postProcessInfographicJson(f,b,c)},postProcessTableInSection:function(b,c){a.postProcessTableInSection&&a.postProcessTableInSection(f,b,c)}})})},generic:function(d,b){return e(d,b)}},t=new B;E.forEach(function(d){var b=k.files.filter(function(h){return h.name===d})[0],c=b&&(r[d]||r.generic);
c&&t.add(function(){return g(u.isPlayerOnServer?g():C.delay(50)).then(function(){return c(b,d)}).otherwise(function(h){f.metadata.parseErrors.push(h);console.log(h)})})});return t.getPromise()}}a=a||{};a.variableProvider=a.variableProvider||new y;a.tableDefaultStyles=a.tableDefaultStyles||new z;var f={documentOptions:{},metadata:{specialTradeAreaCalculatorName:null,parseErrors:[],mapImageInfosHash:{},comparisonCalculatorsHash:{},locatorCalculatorsHash:{}},theme:null},k=n.portalJson,l={};a.getImageData=
function(e){return l[m(e)]};var m=function(e){return e?e.toLowerCase():""},F=a.log||function(e){};return g(p.initialize(),function(){return g(x.collectImageResources(k,l,m),function(){for(var e in l)q.putImageData(e,l[e]);return g(D(),function(){f.metadata.parseErrors.length||(n.templateJson=f)})})})}}});