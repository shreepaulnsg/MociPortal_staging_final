// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/3.38/esri/copyright.txt for details.
//>>built
define("esri/dijit/geoenrichment/ReportPlayer/core/charts/legends/SelectableLegend","dojo/_base/declare dojo/_base/lang dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/on dijit/_WidgetBase dijit/_TemplatedMixin esri/dijit/geoenrichment/TriStateItem esri/dijit/geoenrichment/lists/FlowList ../utils/ThemeCalculator ./LegendSymbolRenderer".split(" "),function(l,p,k,g,m,q,r,t,u,v,w,x,y){var z=l(null,{createPresentation:function(a,c,b,d,f){var n=this,e=g.create("div",{"class":"selectableLegendRoot "+
(this.isStacked()?"":"dijitInline")},b);e.style.paddingLeft=(this.isStacked()?3:10)+"px";e.style.paddingRight=(this.isStacked()?3:10)+"px";f=this.canSelect()&&new v(e,{"class":"dijitInline selectableLegendRootCheckbox"});d=y.renderSymbol({defaultSymbol:this.getDefaultLegendSymbol(),customSymbol:this.getCusomLegendSymbol(),marker:a.marker,stroke:a.stroke,fill:a.fill,width:8,height:15});c=g.create("div",{innerHTML:a.label,"class":"dijitInline selectableLegendRootLabel TrimWithEllipses"});c.style.maxWidth=
this.getMaxLabelWidth()+"px";if(b=a.valueText&&g.create("div",{innerHTML:this.isStacked()?a.valueText:"("+a.valueText+")","class":"dijitInline selectableLegendRootValue TrimWithEllipses"}))b.style.marginLeft="10px";this.isRtlPlacement()?(g.place(c,e),b&&g.place(b,e),g.place(d,e)):(g.place(d,e),g.place(c,e),b&&g.place(b,e));f&&(f.set("checked",!a.unchecked),k[a.unchecked?"add":"remove"](e,"selectableLegendRoot_unselected"),f.onClick=function(h){k[h.checked?"remove":"add"](e,"selectableLegendRoot_unselected");
n.onSelectionChanged(a.label,h.checked)});(f=this.getItemMaxWidth())&&this.needFormatAsTable()&&(b&&(d=f-m.getMarginBox(d).w-m.getMarginBox(c).w-b.clientWidth,b.style.marginLeft=d+"px"),e.style.width=f+"px");this.setItemWidth(q.get(e,"width"),e.clientWidth);this.canEditLabel(a)&&(k.add(c,"isEditable"),r(c,"click",function(h){h.stopPropagation();n.onLabelClicked(a,e)}));return e},isRtlPlacement:function(){},isStacked:function(){},needFormatAsTable:function(){},canSelect:function(){},onSelectionChanged:function(a,
c){},getDefaultLegendSymbol:function(){},getCusomLegendSymbol:function(){},canEditLabel:function(a){},onLabelClicked:function(a,c){},getItemMaxWidth:function(){},setItemWidth:function(a,c){},getMaxLabelWidth:function(){}});return l([t,u],{templateString:"\x3cdiv class\x3d'esriGESelectableLegend'\x3e\x3cdiv data-dojo-attach-point\x3d'listDiv'\x3e\x3c/div\x3e\x3c/div\x3e",series:null,allowSelect:!0,allowEditLabels:!1,showSeriesData:!1,isRtlPlacement:!1,keepItemsTheSameWidth:!1,customLegendSymbol:null,
defaultLegendSymbol:null,showValues:!1,isStacked:!1,hideLastPoint:!1,chartWidth:0,chartType:null,list:null,_isCollectingWidthsFlag:!1,_uncheckedSeriesHash:null,_itemMaxWidth:0,_itemFullWidths:null,_isFlowStacked:!1,postCreate:function(){var a=this;this._uncheckedSeriesHash={};var c=p.mixin(new z,{onSelectionChanged:function(b,d){d?delete a._uncheckedSeriesHash[b]:a._uncheckedSeriesHash[b]=!0;a.onSeriesExclusionChanged(a._uncheckedSeriesHash)},onLabelClicked:function(b,d){if(a.showSeriesData)a.onPointLabelClickedAt(void 0!==
b.unsortedIndex?b.unsortedIndex:a.list.items.indexOf(b),d);else a.onSeriesLabelClickedAt(a.list.items.indexOf(b),d)},isStacked:function(){return a.isStacked},needFormatAsTable:function(){return a.isStacked||a._isFlowStacked},canSelect:function(){return a.allowSelect},getDefaultLegendSymbol:function(){return a.defaultLegendSymbol},getCusomLegendSymbol:function(){return a.customLegendSymbol},canEditLabel:function(b){return!b.isComparisonSeries&&a.allowEditLabels},isRtlPlacement:function(){return a.isRtlPlacement},
getItemMaxWidth:function(){return a._isCollectingWidthsFlag?0:a._itemMaxWidth},setItemWidth:function(b,d){a._isCollectingWidthsFlag&&(a._itemFullWidths.push(d),a._itemMaxWidth=Math.max(a._itemMaxWidth,b))},getMaxLabelWidth:function(){return a.chartWidth?.75*a.chartWidth:200}});this.list=new w({"class":"selectableLegendFlowList",itemRenderer:c},this.listDiv);this.own(this.list);this.isRtlPlacement&&(this.domNode.style.textAlign="right")},refresh:function(){var a=this._getItems();this.list.domNode.style.width=
"";this._itemMaxWidth=0;this._itemFullWidths=[];this._isCollectingWidthsFlag=!0;this._isFlowStacked=!1;this.list.setItems(a);this._isCollectingWidthsFlag=!1;var c=0;this._itemFullWidths.forEach(function(b){c+=b});this._isFlowStacked=!this.isStacked&&this.chartWidth&&c>this.chartWidth;this.keepItemsTheSameWidth&&this.list.refresh();!this.isStacked&&this.chartWidth&&(this._isFlowStacked?(a=this.list.domNode.children[0].clientWidth,a=Math.max(1,Math.floor(this.chartWidth/a))*a+2):a=c+2,this.list.domNode.style.width=
a+"px")},_getItems:function(){var a=this,c=[];this.showSeriesData?(this.series&&this.series[0]&&this.series[0].data.forEach(function(b){var d={label:b.name||"",valueText:a.showValues?b.tooltip.valueLabel:null,unsortedIndex:b.unsortedIndex};b=a._getDataFillAndStrokeColors(null,b);d.fill=b.fill;d.stroke=b.stroke;d.marker=b.marker;c.push(d)}),this.hideLastPoint&&c.pop()):this.series&&this.series.forEach(function(b){var d={label:b.name,unchecked:!0===a._uncheckedSeriesHash[b.name],isComparisonSeries:b.isComparisonSeries};
b=a._getDataFillAndStrokeColors(b.params,b.data[0]);d.fill=b.fill;d.stroke=b.stroke;d.marker=b.marker;c.push(d)});return c},_getDataFillAndStrokeColors:function(a,c){a=a||{};var b=x.getPointIconStyle(c),d=a.markerFill||a.fill;d||(d=c.point&&c.point.hidden&&c.unhiddenFillColor||c.fill);d||(d=b.fillColor);var f=a.markerStroke&&a.markerStroke.color;f||(f=a.stroke&&a.stroke.color&&0<a.stroke.width?a.stroke.color:c.stroke&&c.stroke.color&&0<c.stroke.width?c.point&&c.point.hidden&&c.unhiddenLineColor||
c.stroke.color:b.borderColor);return{fill:d,stroke:f,marker:a.unscaledMarker||a.marker||c.marker}},resetExclusion:function(){this._uncheckedSeriesHash={}},onSeriesLabelClickedAt:function(a,c){},onPointLabelClickedAt:function(a,c){},onSeriesExclusionChanged:function(a){}})});