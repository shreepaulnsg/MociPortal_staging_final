// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/3.38/esri/copyright.txt for details.
//>>built
define("esri/dijit/geoenrichment/ReportPlayer/core/charts/utils/plots/Gauge","dojo/_base/declare dojox/gfx dojox/gfx/matrix ./Donut ./animation/_GaugeAnimation ./labelsRendering/LabelsUtil ./supportClasses/GaugeLabelPlacements esri/dijit/geoenrichment/utils/ObjectUtil".split(" "),function(v,w,p,x,y,q,r,u){var m={INSIDE_LABEL_DEFAULT_FONT_SIZE:30,OUTSIDE_LABEL_DEFAULT_FONT_SIZE:30,FROM_TO_LABEL_DEFAULT_FONT_SIZE:20,getMainLabelInfo:function(c,a,b,d,e,f,g){var h=g?c[0].tooltip.formatFunc(c[0].tooltip.value*
g.progress):c[0].tooltip.valueLabel;return a.series.gaugeMainLabelPosition===r.INSIDE?this._getMainLabelInfoInside(c,a,b,d,h,g):this._getMainLabelInfoOutside(c,a,b,d,e,f,h,g)},_getMainLabelInfoInside:function(c,a,b,d,e,f){b=(a.series.donutHolePercent||0)/100*b*1.5;a.series.donutShowIcons&&(b/=2);var g=a.series.gaugeMainLabelFont||a.series.dataLabelsFont;c=a.series.gaugeMainLabelFontColorFromConditionalStyling?c[0].fill:a.series.gaugeMainLabelFontColor||a.series.dataLabelsColor;if(!(f=f&&f.fontSize))if(f=
m.INSIDE_LABEL_DEFAULT_FONT_SIZE,a.series.gaugeMainLabelFontSize)f=a.series.gaugeMainLabelFontSize;else{g=g.replace(/\s\w*px/," "+f+"px");var h=w._base._getTextBox(e,{font:g});f=Math.min(100,Math.max(30,f*b/Math.max(h.w,h.h)))}e=q.getSimpleLabelInfo({text:e,font:g,fontSize:f,fontColor:c,textDecoration:a.series.gaugeMainLabelTextDecoration});g=d.cx-e.box.w/2;h=d.cy-e.box.h/2;c=0;a.series.donutShowIcons?(a=a.series.donutArcPercent/100,c=-b/(1.25-(1-a)),h=d.cy+e.box.h*(1.75*a-1)):50===a.series.donutArcPercent&&
(h=d.cy-e.box.h/1.2);return{iconSize:b,iconShift:c,x:g,y:h,text:e.text,fontSize:f}},_getMainLabelInfoOutside:function(c,a,b,d,e,f,g,h){h=h&&h.fontSize||a.series.gaugeMainLabelFontSize||this.OUTSIDE_LABEL_DEFAULT_FONT_SIZE;c=q.getSimpleLabelInfo({text:g,font:a.series.gaugeMainLabelFont||a.series.dataLabelsFont,fontColor:a.series.gaugeMainLabelFontColorFromConditionalStyling?c[0].fill:a.series.gaugeMainLabelFontColor||a.series.dataLabelsColor,fontSize:h,textDecoration:a.series.gaugeMainLabelTextDecoration});
f=p._degToRad(f);e=f+2*e*Math.PI;e=a.series.gaugeShowArrowIndicator?e:(f+e)/2;a=d.cx+(b+10)*Math.cos(e)-(c.box.w/2-c.box.w/2*Math.cos(e));e=d.cy+(b+10)*Math.sin(e)-(c.box.h/2-c.box.h/2*Math.sin(e));pushY=f=0;a<d.cx-b?f=d.cx-b-a:a+c.box.w>d.cx+b&&(f=d.cx+b-(a+c.box.w));e<d.cy-b?pushY=d.cy-b-e:e+c.box.h>d.cy+b&&(pushY=d.cy+b-(e+c.box.h));return{x:a,y:e,pushX:f,pushY:pushY,text:c.text,fontSize:h}},getFromLabelInfo:function(c,a,b,d,e,f,g,h){c=q.getSimpleLabelInfo({text:u.formatNumber(h),font:a.series.gaugeFromLabelFont||
a.series.dataLabelsFont,fontColor:a.series.gaugeFromLabelFontColor||a.series.dataLabelsColor,fontSize:a.series.gaugeFromLabelFontSize||this.FROM_TO_LABEL_DEFAULT_FONT_SIZE,textDecoration:a.series.gaugeFromLabelTextDecoration});f=p._degToRad(f);d=e.cx+b*Math.cos(f)+(b-d-c.box.w)/2;f=e.cy+b*Math.sin(f);g=55>a.series.donutArcPercent?0:-c.box.h;h=0;65<a.series.donutArcPercent?h=0:d<e.cx-b&&(h=e.cx-b-d);return{x:d,y:f,pushX:h,pushY:g,text:c.text}},getToLabelInfo:function(c,a,b,d,e,f,g,h){c=q.getSimpleLabelInfo({text:u.formatNumber(h),
font:a.series.gaugeToLabelFont||a.series.dataLabelsFont,fontColor:a.series.gaugeToLabelFontColor||a.series.dataLabelsColor,fontSize:a.series.gaugeToLabelFontSize||this.FROM_TO_LABEL_DEFAULT_FONT_SIZE,textDecoration:a.series.gaugeToLabelTextDecoration});f=p._degToRad(f)+2*g*Math.PI;d=e.cx+b*Math.cos(f)-c.box.w+(c.box.w-(b-d))/2;f=e.cy+b*Math.sin(f);g=55>a.series.donutArcPercent?0:-c.box.h;h=0;65<a.series.donutArcPercent?h=0:d+c.box.w>e.cx+b&&(h=e.cx+b-(d+c.box.w));return{x:d,y:f,pushX:h,pushY:g,text:c.text}}},
t={renderMainLabel:function(c,a,b,d,e,f,g,h){var k;e=function(l,n){n&&(k=k||m.getMainLabelInfo(a,b,d,f,l,g).fontSize,n.fontSize=k);l=m.getMainLabelInfo(a,b,d,f,l,g,n);n=c.renderLabel(l);return{labelInfo:l,element:n}};h&&h.push({isLabel:!0,func:e});return e},renderFromLabel:function(c,a,b,d,e,f,g,h,k){a=m.getFromLabelInfo(a,b,d,e,f,g,h,k);c=c.renderLabel(a);return{labelInfo:a,element:c}},renderToLabel:function(c,a,b,d,e,f,g,h,k){a=m.getToLabelInfo(a,b,d,e,f,g,h,k);c=c.renderLabel(a);return{labelInfo:a,
element:c}}},z={renderArrow:function(c,a,b,d,e,f){var g=function(h){h=p._degToRad(e)+2*h*Math.PI;var k=[];k.push({x:d.cx+5*Math.cos(h+Math.PI/2),y:d.cy+5*Math.sin(h+Math.PI/2)});k.push({x:d.cx+5*Math.cos(h+Math.PI),y:d.cy+5*Math.sin(h+Math.PI)});k.push({x:d.cx+5*Math.cos(h-Math.PI/2),y:d.cy+5*Math.sin(h-Math.PI/2)});k.push({x:d.cx+b*Math.cos(h),y:d.cy+b*Math.sin(h)});return{shape:c.createPath().moveTo(k[0].x,k[0].y).lineTo(k[1].x,k[1].y).lineTo(k[2].x,k[2].y).lineTo(k[3].x,k[3].y).lineTo(k[0].x,k[0].y).setStroke(a.series.gaugeArrowIndicatorLineColor).setFill(a.series.gaugeArrowIndicatorFillColor)}};
f.push({isArrow:!0,func:g});return g}};return v([x,y],{startAngleOffset:-90,_preprocessParams:function(c,a,b,d,e,f,g,h){if(a.series.gaugeMainLabelPosition===r.OUTSIDE){var k=m.getMainLabelInfo(c,a,b,g,this._getSliceValueAt(h,0,a),this._getStartAngle(a)),l=b;e-=Math.abs(k.pushX/2);f-=Math.abs(k.pushY/2);b=Math.min(e,f);b=Math.max(b,l/2);g.cx+=k.pushX/2;g.cy+=k.pushY/2;this._lastRenderResults.chartShiftX=k.pushX/2;this._lastRenderResults.chartShiftY=k.pushY/2}a.series.gaugeShowFromToLabels&&(l=m.getFromLabelInfo(c,
a,b,d,g,this._getStartAngle(a),this._getSliceValueAt(h,0,a),a.series.gaugeFromLabelValue),a=m.getToLabelInfo(c,a,b,d,g,this._getStartAngle(a),this._getSliceValueAt(h,0,a)+(this._getSliceValueAt(h,1,a)||0),a.series.gaugeToLabelValue),c=(Math.abs(l.pushX)+Math.abs(a.pushX))/2,a=Math.max(Math.abs(l.pushY),Math.abs(a.pushY))/2,l=b,b=Math.min(e-c,f-a),b=Math.max(b,l/2),g.cy-=a,this._lastRenderResults.chartShiftY=-a);return{circle:g,r:b}},_renderAdditionalElements:function(c,a,b,d,e,f,g){this._lastRenderResults.ryMultiplier=
this._getRYMultiplier(b);this._renderGaugeDataLabel(c,b,d,e,f,g);this._renderGaugeFromToLabels(c,b,d,e,f,g);this._renderGaugeArrowIndicator(c,a,b,d,e,f,g)},gaugeLabelElement:null,_renderGaugeDataLabel:function(c,a,b,d,e,f){a.series.gaugeMainLabelPosition!==r.NONE&&(c=t.renderMainLabel(this,c,a,b,d,e,this._getStartAngle(a),this._animationInfos)(this._getSliceValueAt(f,0,a)),this.gaugeLabelElement=c.element,a.series.gaugeMainLabelPosition===r.INSIDE&&(this._lastRenderResults.maxIconSize=c.labelInfo.iconSize,
this._lastRenderResults.chartIconOffset=c.labelInfo.iconShift))},gaugeFromLabelElement:null,gaugeToLabelElement:null,_renderGaugeFromToLabels:function(c,a,b,d,e,f){if(a.series.gaugeShowFromToLabels){var g=t.renderFromLabel(this,c,a,b,d,e,this._getStartAngle(a),this._getSliceValueAt(f,0,a),a.series.gaugeFromLabelValue);this.gaugeFromLabelElement=g.element;g=t.renderToLabel(this,c,a,b,d,e,this._getStartAngle(a),this._getSliceValueAt(f,0,a)+(this._getSliceValueAt(f,1,a)||0),a.series.gaugeToLabelValue);
this.gaugeToLabelElement=g.element}},_renderGaugeArrowIndicator:function(c,a,b,d,e,f,g){b.series.gaugeShowArrowIndicator&&z.renderArrow(a,b,d,f,this._getStartAngle(b),this._animationInfos)(this._getSliceValueAt(g,0,b))}})});