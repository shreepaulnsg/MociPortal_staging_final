// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/3.38/esri/copyright.txt for details.
//>>built
define("esri/dijit/geoenrichment/ReportPlayer/core/charts/_ChartLegendSupport","dojo/_base/declare dojo/_base/lang dojo/dom-class dojo/dom-style ./utils/ChartTypes ./utils/ChartStyleUtil ./utils/ChartCalculator ./legends/ChartLegendTypes ./legends/ChartLegendPlacements ./legends/MinMaxLegend ./legends/SelectableLegend ./legends/ChartLegendSymbols".split(" "),function(k,f,e,g,d,l,m,h,b,n,p,q){return k(null,{legend:null,_placements:[b.LEFT,b.RIGHT,b.TOP,b.BOTTOM],_excludedSeriesHash:null,_createLegend:function(){this._excludedSeriesHash=
{};this._placements.forEach(function(a){e.remove(this.domNode,"legendPlacement"+a)},this);this._currentVisualProperties.legend&&(this._currentVisualProperties.legend.type===h.MIN_MAX?this._createMinMaxLegend():this._createSeriesLegend())},_createSeriesLegend:function(){var a=this._currentVisualProperties.legend.series.placement;a!==b.NONE&&(this.legend=(new p(f.mixin({chart:this.chart,chartType:this._currentChartType,allowSelect:!!this.viewModel.dynamicReportInfo&&(d.isColumnBarLike(this._currentChartType)||
d.isLineLike(this._currentChartType)),isStacked:b.isOnSide(a),isRtlPlacement:a===b.LEFT&&!this.viewModel.isGraphicStyle(),keepItemsTheSameWidth:!0,customLegendSymbol:this._currentVisualProperties.legend.series.symbol,defaultLegendSymbol:q.getDefaultSymbol(this._currentChartType,this.viewModel.isGraphicStyle()),showValues:this._currentChartType===d.WAFFLE,hideLastPoint:this._currentVisualProperties.legend.series.hideOthers,onSeriesExclusionChanged:f.hitch(this,this._onSeriesExclusionChanged)},this._getAdditionalLegendParams()))).placeAt(this.getLegendNode()),
this._applyStyleToSeriesLegend(),e.add(this.domNode,"legendPlacement"+a))},_applyStyleToSeriesLegend:function(){var a=this.viewModel.getChartDefaultStyles(this.theme);a=f.mixin({},a.legendStyle,this._currentVisualProperties.legend.series.style);this.viewModel.isGraphicStyle()||delete a.backgroundColor;g.set(this.legend.domNode,l.getStyleObjWithUnits(a));this._currentVisualProperties.legend.series.hasBorder||g.set(this.legend.domNode,"border","none")},_createMinMaxLegend:function(){this._currentVisualProperties.legend.minMax&&
this._currentVisualProperties.legend.minMax.placement!==b.NONE&&(this.legend=(new n({viewModel:this.viewModel,theme:this.theme,chartType:this._currentChartType})).placeAt(this.getLegendNode()),e.add(this.domNode,"hasMinMaxLegend"),e.add(this.domNode,"legendPlacement"+this._currentVisualProperties.legend.minMax.placement))},_getAdditionalLegendParams:function(){return null},_onSeriesExclusionChanged:function(a){this._excludedSeriesHash=a;this._updateSeries()},_updateLegend:function(){this.legend&&
(this._currentVisualProperties.legend.type===h.MIN_MAX?this._updateMinMaxLegend():this._updateSeriesLegend())},_updateSeriesLegend:function(){this.legend.chartWidth=this.domNode.clientWidth-2*m.PRETTY_PADDING;var a=(!this._isMultiFeatureChart||d.isLineLike(this._currentChartType))&&this._currentComparisonInfo&&this._currentVisualProperties.legend.series.showComparison,c=this._currentSeries.filter(function(r){return!r.isComparisonSeries||a});this.legend.series=c;this.legend.showSeriesData=1===c.length&&
!d.isLineLike(this._currentChartType);c=!!this.viewModel.dynamicReportInfo&&1<c.length;c!==this.legend.allowSelect&&(this.legend.allowSelect=c);this.legend.refresh()},_updateMinMaxLegend:function(){var a=this._currentSeries.filter(function(c){return!c.isComparisonSeries});this.legend.refresh(a,this._currentVisualProperties)},_destroyLegend:function(){this.legend&&this.legend.destroy();this.legend=null}})});