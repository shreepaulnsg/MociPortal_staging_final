// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/3.38/esri/copyright.txt for details.
//>>built
define("esri/dijit/geoenrichment/ReportPlayer/playerSupports/_WaitingSupport","dojo/_base/declare dojo/_base/lang esri/dijit/geoenrichment/when dojo/dom-class dojo/dom-construct ../PlayerResizeModes esri/dijit/geoenrichment/utils/DelayUtil esri/dijit/geoenrichment/utils/DomUtil esri/dijit/geoenrichment/utils/WaitingUtil esri/dijit/geoenrichment/utils/progress/SmoothProgress".split(" "),function(e,k,l,f,g,m,h,n,d,p){var q=e(null,{_dataProgress:0,_areaProgresses:null,_numAreas:0,constructor:function(a){k.mixin(this,
a);this.reset()},reset:function(){this._dataProgress=0;this._areaProgresses={};this._fireProgress()},setLoadDataProgress:function(a){this._dataProgress=a;this._fireProgress()},setNumAreas:function(a){this._numAreas=a},setProgressForAreaAt:function(a,c){this._areaProgresses[c]=a;this._fireProgress()},finalize:function(){this.onChange(1);return h.delay(300)},_fireProgress:function(){var a=.25*this._dataProgress,c=.75/this._numAreas,b;for(b in this._areaProgresses)a+=c*(this._areaProgresses[b]||0);a=
Math.min(.999999,Math.max(0,a));this.onChange(a);this._printProgress()},_printProgress:function(){},onChange:function(a){}});return e(null,{_progressController:null,_initProgressController:function(){var a=this;this.showProgressBar&&(this._progressController=new q,(new p(this._progressController)).onChange=function(c){d.showProgressBar({value:c,node:a.domNode,position:"top"})})},_waitingCount:0,_hideUndoHandle:null,_waitNode:null,getWaitingPromise:function(){return d.getProgressPromiseForNode(this._waitNode||
this.domNode)},_showWaiting:function(a,c){var b=this;if(this.isPlayerOnServer)return a;this.onWaitingShown(a);return this.resizeMode!==m.FIT_WINDOW?(0===this._waitingCount++&&(this._updateElementsVisibility(),this._waitNode=g.create("div",{"class":"esriGEReportPlayerWaitingNode"},this.domNode.parentNode),this._waitNode.style.width=this.domNode.clientWidth?this.domNode.clientWidth+"px":"",this._waitNode.style.height=this.domNode.clientHeight?this.domNode.clientHeight+"px":"",this._waitNode.style.position=
"relative",this._hideUndoHandle=n.hideNodeInBackground(this.domNode)),l(a)["finally"](function(){0===--b._waitingCount&&(b._hideUndoHandle.remove(),b._hideUndoHandle=null,g.destroy(b._waitNode),b._updateElementsVisibility())}),d.showProgressPromise(this._waitNode,a,{progressClass:"esriGEReportPlayerProgress"})):this._showWaitingFullScreen(a,c)},_showWaitingFullScreen:function(a,c){return d.showProgressPromise(this.domNode,a,{progressClass:"esriGEReportPlayerProgress",onShowProgress:function(){this._waitingCount++;
this._updateElementsVisibility()}.bind(this),onRemoveProgress:function(){if(this.domNode){this._waitingCount--;this._updateElementsVisibility();var b=this.getCurrentReportContainer();b&&!b.__isBeingAnimated&&(b.__isBeingAnimated=!0,b.domNode&&f.add(b.domNode,"esriGEReportPlayer_fadeIn1000"),b.notifyShown(),h.delay(1500).then(function(){b.__isBeingAnimated=!1;b.domNode&&f.remove(b.domNode,"esriGEReportPlayer_fadeIn1000")}))}}.bind(this)})},onWaitingShown:function(a){}})});