// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/3.38/esri/copyright.txt for details.
//>>built
define("esri/dijit/metadata/base/xml/XmlFlattener","dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ./xmlUtil ../../../../kernel".split(" "),function(h,l,k,n,m,p){h=h(null,{constructor:function(b){l.mixin(this,b)},flatten:function(b,a){var c={domIndex:{},domList:[],nNsPfx:0,nsPfxByUri:{},gxePfxByUri:{}};a&&(c.gxePfxByUri=this._makeGxePfxByUri(a));this._flattenDom({domData:c},b.documentElement,"");return{valuesByPath:c.domIndex,paths:c.domList,prefixesByUri:c.nsPfxByUri}},flattenNode:function(b,
a){a={domIndex:{},domList:[],nNsPfx:0,nsPfxByUri:{},gxePfxByUri:a};this._flattenDom({domData:a},b,null);return a.domIndex},_flattenDom:function(b,a,c){var d=b.domData,e=m.nodeTypes.ELEMENT_NODE,f=this._flattenDomQN(d,a),q=f;null!=c&&(f=c+"/"+q);this._flattenDomValue(d,a,f);k.forEach(a.attributes,function(g){var r=this._flattenDomQN(d,g);this._flattenDomValue(d,g,f+"/@"+r)},this);k.forEach(a.childNodes,function(g){g.nodeType===e&&this._flattenDom(b,g,f)},this)},_flattenDomQN:function(b,a,c){var d=
c=a.localName,e=null;if(a=a.namespaceURI)a in b.gxePfxByUri?e=b.gxePfxByUri[a]:a in b.nsPfxByUri?e=b.nsPfxByUri[a]:(b.nNsPfx++,e="_"+b.nNsPfx,b.nsPfxByUri[a]=e),d=e+":"+c;return d},_flattenDomValue:function(b,a,c){a=this._getDomNodeText(a);c in b.domIndex?b.domIndex[c].push(a):(b.domIndex[c]=[a],b.domList.push(c))},_getDomNodeText:function(b){return m.getNodeText(b)},_makeGxePfxByUri:function(b){var a={};b&&k.forEach(b.getNamespaces(),function(c){c.prefix&&c.uri&&(a[c.uri]=c.prefix)});return a}});
n("extend-esri")&&l.setObject("dijit.metadata.base.xml.XmlFlattener",h,p);return h});