// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/3.38/esri/copyright.txt for details.
//>>built
define("esri/dijit/metadata/base/xml/XmlGenerator","dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ./xmlUtil ../../../../kernel".split(" "),function(p,v,l,G,w,H){p=p(null,{nl:"\r\n",tb:"\t",xmlHeader:'\x3c?xml version\x3d"1.0" encoding\x3d"UTF-8"?\x3e',constructor:function(a){v.mixin(this,a)},generate:function(a,b,d,e){a={gxeDocument:a,transformer:e};b=this._collect(b,null,{ignoreOptionallyOff:!1,validationTracker:d});b=this._walk(b,!0,a);d&&d.whenComplete();return b},_checkTarget:function(a,
b,d){var e="",c="";var g=b.widget;b=g.target;a.transformer&&(b=a.transformer.checkTarget(g,b));a=[b];g.inputWidget&&g.inputWidget.subTarget&&(g=v.trim(g.inputWidget.subTarget),0<g.length&&(a.push(g),b=g,e=d+"\x3c"+a[0]+"\x3e",c=d+"\x3c/"+a[0]+"\x3e"));return{aNames:a,sBegin:e,sEnd:c,sName:b}},_collect:function(a,b,d){if(a.ignoreContent)return null;var e;var c=e=!1;a._isGxeElement?(c=a._isOptionallyOff,a.multiplicityHeader&&a.multiplicityHeader.useTabs&&(c=a.multiplicityHeader._isOptionallyOff)):c=
a._isOptionallyOff;if(a._isGxeElement){if(d.ignoreOptionallyOff||!c)e={isAttribute:!1,widget:a,depth:0,xvalue:null,serialize:a.serialize,references:[],attributeRefs:[],elementRefs:[]},e.xvalue=a.checkXmlValue(),a.isDocumentTitle&&(d.validationTracker.documentTitle=e.xvalue),a.validateValue(d.validationTracker),b&&(e.depth=b.depth+1,b.references.push(e),b.elementRefs.push(e)),b=e,e=!0}else if(a._isGxeAttribute){if(d.ignoreOptionallyOff||!c)c={isAttribute:!0,widget:a,xvalue:null,serialize:a.serialize},
c.xvalue=a.checkXmlValue(),a.isDocumentTitle&&(d.validationTracker.documentTitle=c.xvalue),a.validateValue(d.validationTracker),b&&(b.references.push(c),b.attributeRefs.push(c),c.serialize&&a.isIsoCodeListValue?(b.xvalue=c.xvalue,null===c.xvalue&&(b.serialize=!1)):!c.serialize&&a.isIsoCodeListValue&&(b.serialize=!1))}else if(d.ignoreOptionallyOff||!c)e=!0;e&&(l.forEach(a.getChildren(),function(g){this._collect(g,b,d)},this),a.validateConditionals&&a.validateConditionals(d.validationTracker));return b},
_renderNamespaces:function(a,b,d,e){if(!b)return a;b=d.getNamespaces();e.transformer&&(b=e.transformer.toDocumentType.getNamespaces());l.forEach(b,function(c){c.prefix&&c.uri&&(a+=" xmlns:"+c.prefix+'\x3d"'+c.uri+'"')});return a},_walk:function(a,b,d){if(!a.serialize)return"";var e=function(f,E,x,y,I,q,z){var h=null;if("TopicCatCd@value"===x)return f+y+"\x3cTopicCatCd value\x3d'"+q+"'/\x3e"+E;h=y+"\x3c"+x+I;0===q.length&&0===z.length?h+="/\x3e":(h+="\x3e",0<q.length&&(h+=q),0<z.length&&(h+=z+y),h+=
"\x3c/"+x+"\x3e");return f+h+E},c,g,m="",r="",n=this.nl,A="",t=[];for(c=0;c<a.depth;c++)n+=this.tb;b&&(m=this._renderNamespaces(m,b,d.gxeDocument,d));a.serialize&&null!==a.xvalue&&(a.xvalue.push?l.forEach(a.xvalue,function(f){t.push(w.escape(f))},this):A=w.escape(a.xvalue));l.forEach(a.attributeRefs,function(f){f.serialize&&null!==f.xvalue&&(g=w.escape(f.xvalue),m+=" "+f.widget.target.replace("@","")+'\x3d"'+g+'"')},this);l.forEach(a.elementRefs,function(f){f=this._walk(f,!1,d);null!==f&&0<f.length&&
(r+=f)},this);var F=0===m.length&&0===A.length&&0===t.length&&0===r.length;if(F&&!a.widget.serializeIfEmpty)return null;var u=this._checkTarget(d,a,n),B=u.sBegin,C=u.sEnd,D=u.sName;for(c=0;c<u.aNames.length-1;c++)n+=this.tb;var k=null;F&&a.widget.serializeIfEmpty?k=B+n+"\x3c"+D+"/\x3e"+C:0===t.length?k=e(B,C,D,n,m,A,r):(k="",l.forEach(t,function(f){k+=e(B,C,D,n,m,f,r)}));b&&(k=this.xmlHeader+k);return k}});G("extend-esri")&&v.setObject("dijit.metadata.base.xml.XmlGenerator",p,H);return p});