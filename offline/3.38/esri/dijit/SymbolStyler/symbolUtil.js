// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/3.38/esri/copyright.txt for details.
//>>built
define("esri/dijit/SymbolStyler/symbolUtil","../../symbol ../../symbols/utils dojo/Deferred dojo/dom-construct dojo/on dojox/gfx".split(" "),function(h,k,n,l,m,p){var e={_pureOutlineStyles:"x,cross",isPoint:function(a){return e.isType(a,"marker")},isType:function(a,b){return a&&-1<a.type.indexOf(b+"symbol")},isLine:function(a){return e.isType(a,"line")},isPolygon:function(a){return e.isType(a,"fill")},hasPureOutlineStyle:function(a){return a&&-1<e._pureOutlineStyles.indexOf(a.style)},getOutline:function(a){return"simplelinesymbol"===
a.type||"cartographiclinesymbol"===a.type?a:a.outline},cloneSymbol:function(a){return h.jsonUtils.fromJson(a.toJson())},setOutlineWidth:function(a,b){a=a&&e.getOutline(a);!isNaN(b)&&a&&a.setWidth(b)},setOutlineStyle:function(a,b){a=a&&e.getOutline(a);b&&a&&(b=a.color?b:h.SimpleLineSymbol.STYLE_NULL,a.setStyle(b))},setLineMarker:function(a,b){(a=e.getOutline(a))&&a.setMarker(b)},setSize:function(a,b){if(a&&!isNaN(b)){var c=a.width;if(c!=b)if("picturemarkersymbol"===a.type){var d=a.url;b=e.preserveAspectRatio({dimensions:a,
targetDimension:"width",targetSize:b});a.setHeight(b.height);a.setWidth(b.width);!d||"http://"===d||-1===d.indexOf("http://")&&-1===d.indexOf("data:")||!a.xoffset&&!a.yoffset||(b=a.width,c=b/c,a.setOffset(Math.round(a.xoffset*c),Math.round(a.yoffset*c)))}else a.setSize(b)}},getMarkerLength:function(a){return isNaN(a.width)?a.size:a.width},hasColor:function(a){return a&&a.color},setFillColor:function(a,b){a.setColor(b)},setOutlineColor:function(a,b){(a=e.getOutline(a))&&a.setColor(b)},renderOnSurface:function(a,
b){if(a){var c=80,d=30,g=e.isLine(a),f=a.outline?1.5*a.outline.width:1;if(g)c=250,d=a.marker?5.5*a.width:a.width;else if("simplemarkersymbol"===a.type)d=c=a.size;else if("picturemarkersymbol"===a.type){if(!a.url||"http://"===a.url||-1===a.url.indexOf("http://")&&-1===a.url.indexOf("https://")&&-1===a.url.indexOf("data:"))return;c=a.width;d=a.height}c+=f;d+=f;b=p.createSurface(b,c,d);f=h.jsonUtils.getShapeDescriptors(a);g&&(f.defaultShape.path="M -90,0 L 90,0 E");f=b.createShape(f.defaultShape).setFill(f.fill).setStroke(f.stroke);
g&&k.applyLineMarker(f,a,null,this._acquireSVGMarker);f.applyTransform({dx:.5*c,dy:.5*d});return b}},_acquireSVGMarker:function(a,b,c,d){b=k.createSVGMarker(b,"symbol-util__marker--"+d,c,d);a.getParent().defNode.appendChild(b);return b},preserveAspectRatio:function(a){var b=a.dimensions,c=a.targetSize;return"height"===("height"===a.targetDimension?"height":"width")?{height:c,width:b.width/b.height*c}:{height:b.height/b.width*c,width:c}},toLineMarker:function(a){return a&&"none"!==a?{style:"arrow",
placement:a}:null},testImageUrl:function(a){var b=new n,c=l.create("img");var d=m(c,"load",function(){0===c.width&&0===c.height?b.reject(Error("image has both width and height of 0")):b.resolve({width:c.width,height:c.height})});var g=m(c,"error",function(){b.reject(Error("could not load image"))});c.src=a;b.promise.always(function(){d.remove();g.remove();l.destroy(c)});return b.promise}};return e});