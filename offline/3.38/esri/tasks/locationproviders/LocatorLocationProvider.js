// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/3.38/esri/copyright.txt for details.
//>>built
define("esri/tasks/locationproviders/LocatorLocationProvider",["../../declare","dojo/_base/lang","dojo/_base/array","../../request","./LocationProviderRemoteBase"],function(p,l,q,r,t){return p("esri.tasks.locationproviders.LocatorLocationProvider",t,{locator:null,addressFields:null,constructor:function(){this.geometryType="esriGeometryPoint"},_getFieldMapping:function(){return this.addressFields},_init:function(){if(this.locator){var a=this.getInherited(arguments);return r({url:this.locator.url,content:{f:"json"},
callbackParamName:"callback"}).then(l.hitch(this,function(b){this._batchSize=b.locatorProperties&&b.locatorProperties.SuggestedBatchSize||1;a.call(this)}))}},_batchWillOverflow:function(a,b){return a.length+1>this._batchSize},_locateBatch:function(a,b){var d=this;b=function(c){for(var f=[],h=0;h<c.length;h++){var g=c[h],m=1===d._batchSize?0:g.attributes.ResultID,e=a[m];if((e=e&&e.features)&&g.score&&g.location){for(var k=0;k<e.length;k++){var n=e[k];n.geometry=g.location;f.push(n)}a[m]=null}}return f};
return 1===this._batchSize?this.locator.addressToLocations({address:a[0].expression,outFields:""}).then(b):this.locator.addressesToLocations({addresses:q.map(a,function(c,f){return l.mixin(c.expression,{OBJECTID:f})}),outFields:""}).then(b)},_createQueryExpression:function(a){for(var b={},d=0;d<this._fields.length;d++){var c=this._fields[d];b[c.outField]=a.attributes[c.inField]}return b}})});