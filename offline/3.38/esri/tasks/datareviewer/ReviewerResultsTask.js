// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/3.38/esri/copyright.txt for details.
//>>built
define("esri/tasks/datareviewer/ReviewerResultsTask","dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/Deferred dojo/json dojo/has ./_DRSBaseTask ../../request ../FeatureSet ../../layers/FeatureEditResult ../../kernel".split(" "),function(t,m,y,p,v,z,A,q,w,B,C){t=t(A,{declaredClass:"esri.tasks.datareviewer.ReviewerResultsTask",constructor:function(f){this.onGetResultsComplete=m.hitch(this,this.onGetResultsComplete);this.onWriteResultComplete=m.hitch(this,this.onWriteResultComplete);this.onWriteFeatureAsResultComplete=
m.hitch(this,this.onWriteFeatureAsResultComplete);this.onGetLayerDefinitionComplete=m.hitch(this,this.onGetLayerDefinitionComplete);this.onGetBatchRunDetailsComplete=m.hitch(this,this.onGetBatchRunDetailsComplete)},getResults:function(f,l){var g=this._successHandler,e=this._errorHandler,h=this._appendQueryParams,d=this._url+"/ReviewerResults/getResults";d=h(d);var b=new p;f={queryParameters:f.toJSON(),f:"json"};null!==l&&void 0!==l&&(f.filtersArray=l.toJSON());q({callbackParamName:"callback",url:d,
content:f}).then(m.hitch(this,function(a,c){if(void 0!==a.error)c=Error(),c.message=a.error.message,c.code=a.error.code,e(c,b);else try{if(void 0===a.features||void 0===a.fieldAliases||void 0===a.fields)e(null,b);else{var k=new w(a);g({featureSet:k},"onGetResultsComplete",b)}}catch(n){e(n,b)}}),function(a,c){e(a,b)});return b},writeResult:function(f,l){var g=this._successHandler,e=this._errorHandler,h=this._appendQueryParams,d=this._url+"/ReviewerResults/writeResult";d=h(d);var b=new p;q({callbackParamName:"callback",
url:d,content:{reviewerAttributes:f.toJSON(),geometry:v.stringify(l.toJson()),f:"json"}}).then(m.hitch(this,function(a,c){c=Error();if(void 0!==a.error)c.message=a.error.message,c.code=a.error.code,e(c,b);else try{void 0!==a.result&&"error"===a.result?(c.message=a.messages,c.code=a.result,e(c,b)):"success"===a.result?g({success:!0},"onWriteResultComplete",b):e(null,b)}catch(k){e(k,b)}}),function(a,c){e(a,b)});return b},writeFeatureAsResult:function(f,l){var g=this._successHandler,e=this._errorHandler,
h=this._appendQueryParams,d=this._url+"/ReviewerResults/writeFeatureAsResult";d=h(d);var b=new p;q({callbackParamName:"callback",url:d,content:{reviewerAttributes:f.toJSON(),feature:v.stringify(l.toJson()),f:"json"}}).then(m.hitch(this,function(a,c){c=Error();if(void 0!==a.error)c.message=a.error.message,c.code=a.error.code,e(c,b);else try{void 0!==a.result&&"error"===a.result?(c.message=a.messages,c.code=a.result,e(c,b)):"success"===a.result?g({success:!0},"onWriteFeatureAsResultComplete",b):e(null,
b)}catch(k){e(k,b)}}),function(a,c){e(a,b)});return b},getLayerDefinition:function(f){var l=this._successHandler,g=this._errorHandler,e=this._appendQueryParams,h=this._url+"/ReviewerResults/getLayerDefinition";h=e(h);var d=new p;e={f:"json"};if(null!==f||void 0!==f)e.filtersArray=f.toJSON();q({callbackParamName:"callback",url:h,content:e}).then(m.hitch(this,function(b,a){if(void 0!==b.error)a=Error(),a.message=b.error.message,a.code=b.error.code,g(a,d);else try{void 0===b.whereClause?g(null,d):l({whereClause:b.whereClause},
"onGetLayerDefinitionComplete",d)}catch(c){g(c,d)}}),function(b,a){g(b,d)});return d},getBatchRunDetails:function(f){var l=this._successHandler,g=this._errorHandler,e=this._appendQueryParams,h=this._url+"/ReviewerResults/getBatchRunDetails";h=e(h);var d=new p;q({callbackParamName:"callback",url:h,content:{batchRunIds:v.stringify(f),f:"json"}}).then(m.hitch(this,function(b,a){if(void 0!==b.error)a=Error(),a.message=b.error.message,a.code=b.error.code,g(a,d);else try{if(void 0===b.features||void 0===
b.fieldAliases||void 0===b.fields)g(null,d);else{var c=new w(b);l({featureSet:c},"onGetBatchRunDetailsComplete",d)}}catch(k){g(k,d)}}),function(b,a){g(b,d)});return d},updateLifecycleStatus:function(f,l,g,e){var h=this._successHandler,d=this._errorHandler,b=this._appendQueryParams,a=this._url+"/ReviewerResults/updateLifecycleStatus";a=b(a);var c=new p;q({callbackParamName:"callback",url:a,content:{sessionId:f,lifecycleStatus:l,technicianName:g,filtersArray:e.toJSON(),f:"json"}}).then(m.hitch(this,
function(k,n){if(void 0!==k.error)n=Error(),n.message=k.error.message,n.code=k.error.code,d(n,c);else try{var x=[];y.forEach(k.updateResults,function(r){var u=new B;u.error=Error(r.description);u.success=r.success;u.objectId=r.objectId;x.push(u)});h({featureEditResults:x},"onUpdateLifecycleStatusComplete",c)}catch(r){d(r,c)}}),function(k,n){d(k,c)});return c},getResultsFieldNames:function(){return"recordId objectId subtype category sessionId checktitle resourceName checkName notes severity reviewStatus correctionStatus verificationStatus reviewTechnician correctionTechnician verificationTechnician reviewDateUtc correctionDateUtc verificationDateUtc lifecycleStatus".split(" ")},
onGetResultsComplete:function(f){},onWriteResultComplete:function(f){},onWriteFeatureAsResultComplete:function(f){},onGetLayerDefinitionComplete:function(f){},onGetBatchRunDetailsComplete:function(f){},onUpdateLifecycleStatusComplete:function(f){}});z("extend-esri")&&m.setObject("tasks.datareviewer.ReviewerResultsTask",t,C);return t});