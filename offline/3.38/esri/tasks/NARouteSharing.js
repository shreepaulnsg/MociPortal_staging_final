// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/3.38/esri/copyright.txt for details.
//>>built
define("esri/tasks/NARouteSharing","dojo/_base/declare dojo/_base/array dojo/json dojo/Deferred dojo/promise/all dojo/_base/lang dojo/i18n!../nls/jsapi dojo/number ../request ../graphic ../renderers/SimpleRenderer ../renderers/UniqueValueRenderer ../symbols/PictureMarkerSymbol ../symbols/SimpleMarkerSymbol ../symbols/SimpleLineSymbol ../arcgis/Portal ../tasks/RouteParameters ../tasks/RouteResult ../SpatialReference ../tasks/FeatureSet ../tasks/GeometryService ../tasks/ProjectParameters ../geometry/webMercatorUtils".split(" "),
function(ma,ea,G,K,aa,p,x,na,ba,fa,P,Q,H,R,ca,oa,pa,qa,L,S,ra,sa,ha){return ma(null,{declaredClass:"esri.tasks.NARouteSharing",portal:null,outSR:null,firstStopSymbol:{angle:0,xoffset:0,yoffset:9,type:"esriPMS",width:17,height:24,imageData:"iVBORw0KGgoAAAANSUhEUgAAABYAAAAgCAYAAAAWl4iLAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAZdEVYdFNvZnR3YXJlAHBhaW50Lm5ldCA0LjAuMTZEaa/1AAADLElEQVRIS42WP2vbQBjG/VUyatR4640aNWormoroEEyGYryYksEYDyZ4MMGDIR4MzhBwhkCngDsE3KGQDh3yMTJen+c9nXQ6ndMKHlt+7/TTe++fOw+MMWd1/Hk0s/sbU62GpliUJp8Wck/b4eU7psSfo6LG/fNBIPo6M+lUGbXQRm8yUYr79FphTJvsOjecGz5P9Qz0SE0AWmcmfygaZdQ9lRu9o/CSJV4yVqZaVni0y+n8qFYVvIEnO8AesXRfD2UD1zVcEb7WJpmkEiqf1ULxVjUFlB56wMK7pyy8Bast4BvAER7fc/m4e7qTJfEBWXoNLJ6qVg7e8boGbxGStRLG7eOtwAXMJCjE1HnrQ0soW2Mcq1EIk17ZeY3XACuC6fUSiR5rC6a3EgLf2ycLznelSa8w+Uqb0WYk4n1yiapglTThsOB0oyTe9NrGFtnl8lowl16Z5EuKmp3Rg85FG8f0thtnAc9tIgd6jAGGIQDreWaKuWQ6enGM9dwDr2w4BvxgIkIwQ3B4keKPXhxLLtMeWPRVAcxmQKxCMJd6enutMf2LY8lnB25jTDHJA9ItGPKSR/v+eV9j+hfHJLERMMvOxhhLkXDUYEovEPdJXmP6l55g+dxHGAa/KlDPEmOp4VU/zhS9ZtW8v7/XOCP3tNHbpkEEWoNRyxleOpjtZiadB+FwcHynyMHFp0S8p3jPpWoAY4lLpqnUu3QeE9iEI4RDGet1CYjbPjHHedtpjrqtuVcLeLT9JpsIvfbhPREo0LAxLPgCXTdcjxixdnfLpnWsfbjIAn1o1NuFTdrrHynRFnz8fZRMswvtwzWoA6QctPXWdZt/XDVgqoXTc+8FDvifUKoDpghnCfLYEVAAbJcPKJZPR2IHa+eHrxwxF7gPDKFornOndc/gdHo72VMaCXWwBsrlo0TPQamo0Wn/4yBbYwtta/Xcse8UNfoql6Vs3oSKsD8M8RchnBcqavTFZLKtnbcMz/HXCUPx+U5RYygeNUwWPWeXhuMxRY2hbnY3dovEocsVhOMxRY2h2KaaG5XXsv9S1BhTiT04/Bv1kaLGmFhet/gPEtrjMoO/bgAlOuupzJ0AAAAASUVORK5CYII\x3d",
contentType:"image/png"},interimStopSymbol:{angle:0,xoffset:0,yoffset:9,type:"esriPMS",width:17,height:24,imageData:"iVBORw0KGgoAAAANSUhEUgAAABYAAAAgCAYAAAAWl4iLAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAZdEVYdFNvZnR3YXJlAHBhaW50Lm5ldCA0LjAuMTZEaa/1AAAC4klEQVRIS5WWMYujQBiG/RnbprS0tE2ZMmVaS6slpBCxEbEIYYsQtljCFQemWLA5yBYHXnPgFgfZ4sAtDrLl/ozv3m/G0RkzXnLFs5t8jk9eP2dGHSIapX6rafO8o/Apo8XDkubrgMLHTNSOvyoMsZ/HXBTOH2cqf5Y0zwOaJiG5UUZeuid/XZEH3GRP7iojH8dmaYCxR5xmOhjjS/PeIFFMfhSQn5c0fTwb+FuJ98A05KYleauAApyje5he+ueMAUvyopim25MQzZ56bHJ33dAkr2myitGqEBqLONhCmmQXwiFK3qUWcoD26MnFn/1LIS7J3zadeP5F8dl91sVS3ovv0hN6H9L+ZS/kaEEjboKXH420UvhJi6/yP6OO6am7xCxPjrg/CykuviMtWsADzbRSqpByu9hV4pRbEovUDvfFTYsLMcsC5qDLL8Uei7t2gKigYBuTw9G9vBqIpYilCpX6qjiBC07HX0GMAbeJb0gM3HuIvSi0iGUrlFx9Hu3xQOxFS4itifvUvXRczFIzcdD2eH0yxLq8p5Ua4j7tpJXyfOb2OjyH3RTzDwPtcomqKanP/TUWSAvm8iwPyckOO+xge6MdulxHHGsDjPX3brWjDNuqU73y9MDKwwBOocv5sjthiy1tLz7hxgVUv9dyw+CtkjcRlVrI9R9g2jozmvY+pviwkUua/zDTRPZal9vg49a0UYnNPxBSQ1z9rkVLXOyv8mSI1I+033WpkVasNtmCCzFTd3JOjok+pBUaaS1SxhAzLJ8mCzzbik4ypJPi8qeYrkMpY3zR4fk9wTPNJrwmZS4KitMHVhAucZJWplD1FDdqTMpYi4rj6xGPm6W2XBmeqyFVb//5XjGEH7K8eSvxBKtUzdV/YS3q8OVyQpWW+zocY8NaHCJTl9gHbkvLWItDCrxyudFGPHR5IQ2P27AWbfAs0JfsNaxFG+ETXqPQkmF9DGvRRvmjpN03+ZZzHXL+Atsof8D3QNX7AAAAAElFTkSuQmCC",
contentType:"image/png"},lastStopSymbol:{angle:0,xoffset:0,yoffset:9,type:"esriPMS",width:17,height:24,imageData:"iVBORw0KGgoAAAANSUhEUgAAABYAAAAgCAYAAAAWl4iLAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAZdEVYdFNvZnR3YXJlAHBhaW50Lm5ldCA0LjAuMTZEaa/1AAADBklEQVRIS62WsWvbQBTG9Sdk9OrRWwwZbMhiQwYbPNiQwYYMJmQIxYOHDiFr6djJo+lQULfLUFCHgrIU1KFwHQoetebPeP2+J519ks9uSBL4YutJ99O77969cyQiB2W/G0k/fZBkeS1mPpF42sf3mcY2PxI8Eh5HBYP5YyJmOpR40BZz3pCk15Rs0JLsoikJrs3ZicS9lsTjrtgHgyH7jL2AWVzrIII20y7Uls1lqTFio5bYQVMsXpZ2TmTdaYq5nWFolVO5SBYzMRhgCbsC1Jd7AeCWcGRvew3JAI8xgzp8+8UQeoGMCJn3Jadu+vp9M6/BXdaEwxoLuDmDRR5c/9mva0y/WUy9BOa31LD4dC9w8HG7kjXBmnkHM/i8UriC48u+ZHhwBx1KisFbjaiWpPA9way4mMk5BJADUyksWeO+gpmt4UIhGwfNF0NZnTa0vI6Jz3ARnR2FJcgeWau3zIQ+KhjQfDmRFTx7+mv59uDf0++sAHs+UwkX8mYCG1CrGaarNjDbJfT+5eCstCNao2bVhi14Ivnd7MVgirUdxWWJbf19AzArbJfxG4KLjOGxZdH7VrzGY4gu7NfwK6uCtWzAjNgCU9wM1XH68f6oQuDkFHDci3K8mXZUt/MQfQNdC1PSTyyGCruNbdRgx8WYUQxIsfMKMG1Y45nsIS672t07HcSsffhWuGZc75e9QhsRs/W2tMGLyCJTwfkfK/GoW3jtw0vtoJBrnbXu5vpEXqzLrm3mj6laYpkNIfqC8rMGrWQLMHcbDwf/uNqCqfxXAdfM9fRwAlChEKFetiEoVQFTNJ62aGMizMk/lspsOX1d+MDBWrlw0kphfQPggEEo+vSh03ov4LT5WdpCEIEeNGO5sccc+QkQDDrpIcBGrsASCl9jlKb9Fj72nYJBX2aOY4obgGUF8ThytXpMwaAvTlczLHcW7eEa1J+rKxisy1whaywWj53nZEsFg3XxcNQ+AZ+PLZivYDAkVoE72p+jYDAk/aUES+rxQwoGQ2J5ZV+KXzn/l0T/AJfvVAR5fRz8AAAAAElFTkSuQmCC",
contentType:"image/png"},unlocatedStopSymbol:{angle:0,xoffset:0,yoffset:9,type:"esriPMS",width:17,height:24,imageData:"iVBORw0KGgoAAAANSUhEUgAAABYAAAAgCAYAAAAWl4iLAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAZdEVYdFNvZnR3YXJlAHBhaW50Lm5ldCA0LjAuMTZEaa/1AAACiUlEQVRIS42VMWvcQBCF77+a/IDgKhxuwuEiCBfhSBGOFIFLEZCLwKUI2E3AKQJOEbgUgUuRwj9jM9+TZhmtxoqLZ+tmd799ejuSVqWURe3f78v2zbZ0r7qyuex0Te3w6WDD+RqUFvvrgyDAtq+3Zfd2V/Yf9gLWTV5uJOa269GsAGhzuRHo5suNdPh8GGQu++u+9B97jbPJ+mKtzVvO5AcTuqtOkJtbg0b5Bg2cu8E5dxFZEygCcvf1bqYM7vHs3u1qbBMwu3P7LBToW6IIj65HMFpfEGEvuMBAmeTQ++/3M1X46HoSxwj2zAVmMEYg0I9BWmAZch1dcw6ojQMNB98P2TIQ3R5/HjXp7NmZJPjomvleB96CGe+uthaDejHEYO4AH38Z3IARHn9zWFnOHofAbQxAT79P5fTnNIFV6NiSGRitXwCmGwLY3QJ9+PugDdjcoSyaHWADZv6KFllyTIbRLeJ2Fx17FEyagM01YBY5TJ1guUb4MtheNgzWwxvjiE6BUmec6CrcOqAFsyFz9FqkoDhGsPcteQpqvwW2zZnHwvPn50OrNe3GfA68PnnxcRbcBMSvqQs8HhxAubX/DkXEwPjwAjL78ekTZNzAr93t0rsCg7D0SPNncD1kXeGNKtTcZG83jPl7YgJmATuyQJBWDTTGoAMbu2sGRhWOcwNFOVTgEYrbDIomYCS4TWSRYC6HBrfcfgZFkx9RZC54BD4RimaFKGIB4kCH0qdLUJQWXYA8c2UKlLYy6GOffVdajNJH0g6IWBBPlvfqktJiFLeLw/oQ2HU7J1NabOWf9qe6RWmxFR9H4GjpwKLSYiYiiI/s/5QWMykKc9zWH1NazER70XZtPVdZ/QN2IySZrUmdSgAAAABJRU5ErkJggg\x3d\x3d",
contentType:"image/png"},waypointSymbol:{color:[255,255,255,255],size:10,angle:0,xoffset:0,yoffset:0,type:"esriSMS",style:"esriSMSCircle",outline:{color:[20,89,127,255],width:2.5,type:"esriSLS",style:"esriSLSSolid"}},directionSymbol:{color:[0,122,194,255],width:6,type:"esriSLS",style:"esriSLSSolid"},directionPointSymbol:{color:[100,100,255,255],size:12,type:"esriSMS",style:"esriSMSCircle",outline:{color:[255,255,255,255],width:2,type:"esriSLS",style:"esriSLSSolid"}},directionEventSymbol:{color:[100,
255,100,255],size:8,type:"esriSMS",style:"esriSMSCircle",outline:{color:[0,69,0,255],width:1,type:"esriSLS",style:"esriSLSSolid"}},directionLineSymbol:{color:[0,122,194,255],width:6,type:"esriSLS",style:"esriSLSSolid"},routeSymbol:{color:[20,89,127,255],width:8,type:"esriSLS",style:"esriSLSSolid"},barrierRenderer:new Q({type:"uniqueValue",field1:"BarrierType",defaultSymbol:{type:"esriPMS",imageData:"iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAZdEVYdFNvZnR3YXJlAHBhaW50Lm5ldCA0LjAuMTZEaa/1AAAByklEQVRIS7WVPU4DMRCF9yhwjEg05BiRKFBOgSIalCOkilYUSDkCDVJokHKE0CUFRY5h5hvbg71MYDeBJ739GXt+/MbebUIIP3L7vg2zu1lol22Y3EyM7XIR1i/PMsX3y3SNEOfx9TisnlZht9+JqQa2zdsmtI+tFiBw43wzUDHVrl/X8toBiY4kG12NAr6CKl71kquucC/VYWNq5sVltDGWcPg4uKuxB4i2BirtBvZIsmK1JCl7oxdIcNMah26g35hWQ4xUqBh1JEpjmpOk69yXKQZJslRi7UjTR5ZjRK6ELJVYQ8OLgrvnOIS3Uw3FFtYEHBjTnkHPaQjTKthVyNQkrSIYLCYNQi6u8J1J4xsuhk4Vg1CuPjWb3n41uNw95yZIkk/FVkuUd9C5CRJUouoMlJNOJUUmaJP1c5z78MfblB0qlv85aPOHuX5dxRplssMm+9d17sMkNZJXnwrIP8AO3ClS5QIFSXIx6kh8YDmVVCQ74XNNcBQRyKDOiA8wJ7GVcJdfpjaOQGVQkpeHVEBwGiuwmPaQuZMkyGU7qwT9cUBBvX6ZJVmmViTaev9ngmozZU5uqEfXmElFcUWLGEiIhJCgpdY+Q/MJtbNzCJoj+q0AAAAASUVORK5CYII\x3d",
contentType:"image/png",width:18,height:18},uniqueValueInfos:[{value:"2",symbol:{type:"esriPMS",imageData:"iVBORw0KGgoAAAANSUhEUgAAABkAAAAYCAYAAAAPtVbGAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAZdEVYdFNvZnR3YXJlAHBhaW50Lm5ldCA0LjAuMTZEaa/1AAABuklEQVRIS7WVsUrEQBCGfQwLC30MwUbLA19AsBArCb6EHBZHHuGwOEgj5BFyzUF8Ay2Es7C4B7CwsBjnn80su5vJmogufMnsn81k/91JskdEo9m+PvPJvpbDFIeY38+puCk47F/LYYoW1WpJ7VNLu/cd4WHp9RymaFHcigNpXWyOszDFFHVB64boYSlupiybKaaUi5JP3E7PiA6PJIQ2thBMMcS7YAcyHEx0Y4ohkQt9yMG+SLjWYAmD8RamqKCKMGNaVdxjKWSCG1NUfEVhH+64bL84Bog7N+2m/dGNKQLMMHLhErmGGNrVtYyZnc+gRveHmCKIXGAYNl6bFkFXafVjlXVjit06xxWVLpfqnZvc3vQE1L6vKE0ELi+IPj4diFXH3rxt2U096KYndOsbz1Z54ZcPpLq6GfjcRB3MBOsrLU0EMFPd9BC4kXttN1HHu+CZ9RIB7FG4TyEZNz5wLmoO0WNpKqg0zoFPED5FyKL4wFfUkIuh6go5OZYUqRs54Mnigqukd6Pi1to1xNYYYLiRQ7ngmaGFH8GUMU6A4Sb+IVk3/QbOFb6g0W/1r5u6kbJF5z9A7mbd0Deb57AijFvMOAAAAABJRU5ErkJggg\x3d\x3d",
contentType:"image/png",width:19,height:18}}]}),polylineBarrierRenderer:new Q({type:"uniqueValue",field1:"BarrierType",defaultSymbol:{color:[255,0,0,184],width:7.5,type:"esriSLS",style:"esriSLSSolid"},uniqueValueInfos:[{value:"1",symbol:{color:[255,85,0,184],width:7.5,type:"esriSLS",style:"esriSLSSolid"}}]}),polygonBarrierRenderer:new Q({type:"uniqueValue",field1:"BarrierType",defaultSymbol:{color:[255,0,0,156],outline:{color:[255,0,0,153],width:2.4,type:"esriSLS",style:"esriSLSSolid"},type:"esriSFS",
style:"esriSFSSolid"},uniqueValueInfos:[{value:"1",symbol:{color:[255,170,0,156],outline:{color:[255,0,0,153],width:7.5,type:"esriSLS",style:"esriSLSSolid"},type:"esriSFS",style:"esriSFSSolid"}}]}),_geometryService:null,_jsonStringFieldSize:1048576,constructor:function(b,a){b&&(this.portal=new oa.Portal(b),this._outSR=a)},getFolders:function(){return this.portal?this.portal.signIn().then(p.hitch(this,function(){return this.portal.getPortalUser().getFolders()},!1)).then(p.hitch(this,function(b){var a=
this.portal.getPortalUser();b=b||[];b.splice(0,0,{created:a.created,portal:this.portal,title:a.username+" ("+x.networkAnalysis.sharing.rootFolder+")",url:a.userContentUrl});return b})):[]},canCreateItem:function(){var b=new K;this.portal?this.portal.signIn().then(p.hitch(this,function(){b.resolve(-1<(this.portal.getPortalUser().privileges||[]).indexOf("portal:user:createItem"))}),b.reject):b.reject(Error("No URL to a Portal instance or ArcGIS Online was specified at construction time."));return b.promise},
toMinutes:function(b,a,e){b=b||0;switch(a){case "esriNAUSeconds":b/=Math.pow(60,e?-1:1);break;case "esriNAUHours":b*=Math.pow(60,e?-1:1);break;case "esriNAUDays":b*=Math.pow(1440,e?-1:1)}return b},fromMinutes:function(b,a){return this.toMinutes(b,a,!0)},toMeters:function(b,a,e){b=b||0;switch((a||"").replace("esriNAU","esri")){case "esriInches":b*=Math.pow(.0254,e?-1:1);break;case "esriFeet":b*=Math.pow(.3048,e?-1:1);break;case "esriYards":b*=Math.pow(.9144,e?-1:1);break;case "esriMiles":b*=Math.pow(1609.344,
e?-1:1);break;case "esriNauticalMiles":b*=Math.pow(1851.995396854,e?-1:1);break;case "esriMillimeters":b/=Math.pow(1E3,e?-1:1);break;case "esriCentimeters":b/=Math.pow(100,e?-1:1);break;case "esriKilometers":b*=Math.pow(1E3,e?-1:1);break;case "esriDecimeters":b/=Math.pow(10,e?-1:1)}return b},fromMeters:function(b,a){return this.toMeters(b,a,!0)},toGeolocalTime:function(b,a){return void 0===b||null===b?void 0:b+6E4*(a||0)},toUTCTime:function(b,a){-22091616E5===b&&(b=void 0);return null!==a&&void 0!==
a?b-6E4*a:b},getUTCOffset:function(b,a){return null!==a&&void 0!==a&&0<a?(b-a)/60/1E3:void 0},getAttributeUnits:function(b,a){a=a.networkDataset.networkAttributes;for(var e,f=0;f<a.length;f++)if(a[f].name===b&&"esriNAUTCost"===a[f].usageType){e=a[f].units;break}return e},addAttributePrefix:function(b,a){var e={},f;for(f in b)b.hasOwnProperty(f)&&(e[a+f]=b[f]);return e},project:function(b,a,e){var f=new K;if(b&&b.length&&a&&e&&a.wkid!==e.wkid){var c=a instanceof L?a:new L(a),h=e instanceof L?e:new L(e);
if(ha.canProject(c,h))ea.forEach(b,function(k,m){k.geometry&&(k.geometry.spatialReference||(k.geometry.spatialReference=c.toJson()),k=new fa(k),k.setGeometry(ha.project(k.geometry,h)),b[m]=k.toJson())}),f.resolve(b);else if(!this._geometryService&&this.portal&&this.portal.helperServices.geometry&&(this._geometryService=new ra(this.portal.helperServices.geometry.url)),this._geometryService){var d=p.hitch(this,function(k,m){var l=new sa,n=new K;l.outSR=h;l.geometries=[k.geometry];this._geometryService.project(l).then(p.hitch(this,
function(t){k.setGeometry(t[0]);b[m]=k.toJson();n.resolve()}),n.reject);return n.promise}),g=[];ea.forEach(b,p.hitch(this,function(k,m){k.geometry&&(k.geometry.spatialReference||(k.geometry.spatialReference=c.toJson()),g.push(d(new fa(k),m)))}));aa(g).then(f.resolve,f.reject)}else f.resolve(b)}else f.resolve(b);return f.promise},load:function(b,a){var e=new K,f=p.hitch(this,this.fromMeters),c=p.hitch(this,this.fromMinutes),h=p.hitch(this,this.addAttributePrefix);this.portal?this.portal.signIn().then(p.hitch(this,
function(){var d=this.portal.getPortalUser(),g=d.userContentUrl.replace(/\/users\/.+\/?$/,"/items/");ba({url:g+b,content:{f:"json"},callbackParamName:"callback"}).then(p.hitch(this,function(k){ba({url:g+b+"/data",content:{f:"json"},callbackParamName:"callback"}).then(p.hitch(this,function(m){var l=function(C){for(var z=0;z<m.layers.length;z++)if(m.layers[z].layerDefinition.name===C)return m.layers[z]},n=l("Directions"),t=n&&n.featureSet.features||[],q=l("DirectionEvents"),D=q&&q.featureSet.features||
[],A=l("DirectionPoints"),B=A&&A.featureSet.features||[],w=(q=l("DirectionLines"))&&q.featureSet.features||[],F=l("Stops"),y=F&&F.featureSet.features||[],T=(q=l("PolygonBarriers"))&&q.featureSet.features||[],U=(q=l("PolylineBarriers"))&&q.featureSet.features||[],V=(q=l("Barriers"))&&q.featureSet.features||[],M=(l=l("RouteInfo"))&&l.featureSet.features;q=y&&y.length?F.featureSet.spatialReference||y[0].geometry.spatialReference:null;var I=this._outSR?this._outSR:q,ia=[this.project(t,q,this._outSR),
this.project(D,q,this._outSR),this.project(B,q,this._outSR),this.project(w,q,this._outSR),this.project(y,q,this._outSR),this.project(T,q,this._outSR),this.project(U,q,this._outSR),this.project(V,q,this._outSR),this.project(M,q,this._outSR)],N=l&&l.layerDefinition&&[{geometry:l.layerDefinition.extent}];N&&ia.push(this.project(N,q,this._outSR));aa(ia).then(p.hitch(this,function(){M=M&&M[0];N=N&&N[0].geometry;var C=M&&M.attributes,z=C?G.parse(C.AnalysisSettings):void 0,W=z?z.travelMode.timeAttributeName:
void 0,X=z?z.travelMode.distanceAttributeName:void 0,J=this.getAttributeUnits(W,a),Y=this.getAttributeUnits(X,a),Z=a.directionsLengthUnits,ta=C?C.Messages:void 0,ja=[],ka=0,la=(n||A)&&C?{directions:{routeId:1,routeName:C.RouteName,summary:{totalLength:this.fromMeters(C.TotalMeters,Z),totalTime:this.fromMinutes(C.TotalMinutes,J),totalDriveTime:this.fromMinutes(C.TotalMinutes-C.TotalWaitMinutes,J),envelope:N},spatialReference:I,geometryType:"esriGeometryPolyline",features:p.hitch(this,function(){var u=
(C.Version||"0.0.0").split("."),v;if("0"===u[0])return this._loadDirectionsFeatureSet(t,D,Z,J,I);if("1"===u[0]){for(u=0;u<B.length;u++)if(void 0!==B[u].attributes.StopID)for(v=0;v<y.length;v++)if(y[v].attributes[F.layerDefinition.objectIdField||"__OBJECTID"]==B[u].attributes.StopID){B[u].attributes.StopSequence=y[v].attributes.Sequence;break}for(u=0;u<w.length;u++)if(void 0!==w[u].attributes.DirectionPointID)for(v=0;v<B.length;v++)if(B[v].attributes[A.layerDefinition.objectIdField||"__OBJECTID"]==
w[u].attributes.DirectionPointID){w[u].attributes.DirectionSequence=B[v].attributes.Sequence;break}for(u=0;u<w.length-1;){for(v=u+1;v<w.length;)w[u].attributes.DirectionPointID===w[v].attributes.DirectionPointID&&(w[u].geometry&&w[u].geometry.paths[0]?w[u].geometry.paths[0]=w[u].geometry.paths[0].concat(w[v].geometry.paths[0]||[]):w[u].geometry=w[v].geometry,w[u].attributes.DirectionLineType=this._lineTypeStringToLineTypeCode("esriDLTSegment"),w[u].attributes.Meters+=w[v].attributes.Meters||0,w[u].attributes.Minutes+=
w[v].attributes.Minutes||0,w[u].attributes.ToLevel=w[v].attributes.ToLevel||w[u].attributes.ToLevel,w.splice(v,1)),v++;u++}return this._loadDirectionsFeatureSet_100(B,w,y,Z,J,I)}e.reject(Error("Unsupported version of route layer."))})()},stops:p.hitch(this,function(){for(var u=[],v=0;v<y.length;v++){var r=y[v].attributes,E={geometry:y[v].geometry,attributes:{ObjectID:r.__OBJECTID,Name:r.Name,RouteName:null,Sequence:r.Sequence,TimeWindowStart:r.TimeWindowStart,TimeWindowEnd:r.TimeWindowEnd,ArriveCurbApproach:r.ArrivalCurbApproach,
DepartCurbApproach:r.DepartureCurbApproach,CurbApproach:r.CurbApproach,Status:r.Status,ArriveTime:this.toGeolocalTime(r.ArrivalTime,r.ArrivalUTCOffset),DepartTime:this.toGeolocalTime(r.DepartureTime,r.DepartureUTCOffset),ArriveTimeUTC:r.ArrivalTime,DepartTimeUTC:r.DepartureTime,isWaypoint:1===r.LocationType}},O=E.attributes;O["Attr_"+W]=this.fromMinutes(r.ServiceMinutes,J);O["Attr_"+X]=this.fromMeters(r.ServiceMeters,Y);p.mixin(O,h(G.parse(r.ServiceCosts||"{}"),"Attr_"));O["Cumul_"+W]=this.fromMinutes(r.CumulativeMinutes,
J);O["Cumul_"+X]=this.fromMeters(r.CumulativeMeters,Y);p.mixin(O,h(G.parse(r.CumulativeCosts||"{}"),"Cumul_"));u.push(E)}return u})(),routeName:C.RouteName,spatialReference:I}:void 0,da=!1;z=F?p.mixin({returnStops:!0,returnDirections:!0,returnRoutes:!1,ignoreInvalidLocations:!0,outputLines:"esriNAOutputLineTrueShape",directionsOutputType:"complete",directionsLengthUnits:Z,doNotLocateOnRestrictedElements:!0,outSpatialReference:new L(I),startTime:C&&0<C.StartTime?new Date(C.StartTime):null,startTimeIsUTC:!0,
timeWindowsAreUTC:!0,stops:new S(function(){for(var u=[],v=0;v<y.length;v++){var r=y[v].attributes,E={geometry:y[v].geometry,attributes:{CurbApproach:r.CurbApproach,Name:r.Name,Sequence:r.Sequence,isWaypoint:1===r.LocationType,TimeWindowStart:r.TimeWindowStart,TimeWindowEnd:r.TimeWindowEnd}};E.attributes["Attr_"+W]=c(r.ServiceMinutes,J);E.attributes["Attr_"+X]=f(r.ServiceMeters,Y);p.mixin(E.attributes,h(G.parse(r.ServiceCosts||"{}"),"Attr_"));u.push(E);da=da||0<r.TimeWindowStart}return{spatialReference:I,
geometryType:"esriGeometryPoint",features:u}}()),barriers:new S(function(){for(var u=[],v=0;v<V.length;v++){var r=V[v].attributes,E={geometry:V[v].geometry,attributes:{CurbApproach:r.CurbApproach,Name:r.Name,FullEdge:r.FullEdge,BarrierType:r.BarrierType}};p.mixin(E.attributes,h(G.parse(r.Costs||r.OtherCosts||"{}"),"Attr_"));u.push(E)}return{spatialReference:I,geometryType:"esriGeometryPoint",features:u}}()),polylineBarriers:new S(function(){for(var u=[],v=0;v<U.length;v++){var r=U[v].attributes,E=
{geometry:U[v].geometry,attributes:{Name:r.Name,ScaleFactor:r.ScaleFactor,BarrierType:r.BarrierType}};p.mixin(E.attributes,h(G.parse(r.Costs||r.OtherCosts||"{}"),"Attr_"));u.push(E)}return{spatialReference:I,geometryType:"esriGeometryPolyline",features:u}}()),polygonBarriers:new S(function(){for(var u=[],v=0;v<T.length;v++){var r=T[v].attributes,E={geometry:T[v].geometry,attributes:{Name:r.Name,ScaleFactor:r.ScaleFactor,BarrierType:r.BarrierType}};p.mixin(E.attributes,h(G.parse(r.Costs||r.OtherCosts||
"{}"),"Attr_"));u.push(E)}return{spatialReference:I,geometryType:"esriGeometryPolygon",features:u}}())},z):void 0;p.mixin(z||{},{useTimeWindows:da});J&&Y||(ja.push({message:x.networkAnalysis.sharing.costAttributeMissing,messageType:"Warning"}),ka=1);e.resolve({routeParameters:p.mixin(new pa,z),solveResult:{barriers:z&&z.barriers&&z.barriers.features||[],polygonBarriers:z&&z.polygonBarriers&&z.polygonBarriers.features||[],polylineBarriers:z&&z.polylineBarriers&&z.polylineBarriers.features||[],messages:G.parse(ta||
"[]"),routeResults:la?[new qa(la)]:void 0},loadMessages:ja,isItemOwner:d.username===k.owner,title:k.title,ownerFolder:k.ownerFolder,successCode:ka})}),e.reject)}),e.reject)}),e.reject)}),e.reject):e.reject(Error("No URL to a Portal instance or ArcGIS Online was specified at construction time."));return e.promise},store:function(b,a,e){var f=new K;b?e||b.directions?"1.0.0"!==e||b.directionPoints&&b.directionLines?b.stops&&b.stops.length?b.extent?b.routeInfo?b.folder?b.name?this.portal?this.portal.signIn().then(p.hitch(this,
function(){var c=this._getRouteId();this._addOrUpdateItem(this._populateLayerInfo(c,b,e),b,c,a,e).then(f.resolve,f.reject)}),f.reject):f.reject(Error("No URL to a Portal instance or ArcGIS Online was specified at construction time.")):f.reject(Error("Layer name is required.")):f.reject(Error("Folder Url is required.")):f.reject(Error("RouteInfo is required.")):f.reject(Error("Extent is required.")):f.reject(Error("Stops are required.")):f.reject(Error("DirectionPoints and DirectionLines are required.")):
f.reject(Error("Directions are required.")):f.reject(Error("Missing required parameters."));return f.promise},createFeatureCollection:function(b,a){var e=new K;if(b)if(a||b.directions)if("1.0.0"!==a||b.directionPoints&&b.directionLines)if(b.stops&&b.stops.length)if(b.extent)if(b.routeInfo)if(b.name){var f=this._getRouteId();e.resolve({title:b.name,layerInfo:this._populateLayerInfo(f,b,a)})}else e.reject(Error("Layer name is required."));else e.reject(Error("RouteInfo are required."));else e.reject(Error("Extent is required."));
else e.reject(Error("Stops are required."));else e.reject(Error("DirectionPoints and DirectionLines are required."));else e.reject(Error("Directions are required."));else e.reject(Error("Missing required parameters."));return e.promise},_addOrUpdateItem:function(b,a,e,f,c){var h=function(d){for(var g=0;g<b.layers.length;g++)if(b.layers[g].layerDefinition.name===d)return b.layers[g].featureSet.features;return[]};return p.hitch(this,function(){var d=new K;if(a.extent){var g=h("Stops"),k=[{geometry:a.extent}],
m=a.extent.spatialReference,l=new L(4326);m=[this.project(g,m,l),this.project(k,m,l)];aa(m).then(p.hitch(this,function(){var n=k[0]&&k[0].geometry,t="";n&&(t=n.xmin+","+n.ymin+","+n.xmax+","+n.ymax);d.resolve({extent:t,stops:g})}),d.resolve)}else d.resolve();return d.promise})().then(p.hitch(this,function(d){d=(d||{}).extent;return ba({url:f?a.folder+"/items/"+f+"/update":a.folder+"/addItem",content:{text:G.stringify(b),extent:d,title:a.name,type:"Feature Collection",typeKeywords:"Data, Feature Collection, Multilayer, Route Layer",
description:x.networkAnalysis.sharing.itemSnippet+" "+a.name+p.hitch(this,function(){var g=c?h("DirectionPoints"):h("Directions"),k=h("Stops"),m=h("RouteInfo")[0].attributes,l="english"===this.portal.getPortalUser().units?"esriMiles":"esriMeters",n=function(A){return na.format(A,{places:2,locale:"root"})},t=p.hitch(this,function(A){return n(this.fromMeters(A,l))+" "+("esriMiles"===l?x.networkAnalysis.sharing.Miles:x.networkAnalysis.sharing.Meters)}),q=p.hitch(this,function(A){for(var B="\x3col\x3e",
w=0;w<g.length;w++){a:{var F=g[w].attributes.StopSequence;if(void 0!==F)for(var y=0;y<k.length;y++)if(k[y].attributes.Sequence===F){F=k[y].attributes;break a}F={}}y=c?this._itemToManeuverType(this._itemCodeToItemString(g[w].attributes.DirectionPointType)):g[w].attributes.ManeuverType;if(A||!w&&"esriDMTDepart"===y||w&&"esriDMTStop"===y)B+='\x3cli\x3e\x3cimg style\x3d"display:inline-block;margin:-3px 15px;" src\x3d'+this.portal.url+"/home/js/jsapi/esri/dijit/images/Directions/maneuvers/"+(null===F.ArrivalCurbApproach&&
null!==F.DepartureCurbApproach?"esriDMTStopOrigin":null!==F.ArrivalCurbApproach&&null===F.DepartureCurbApproach?"esriDMTStopDestination":y)+'.png"\x3e\x3cspan\x3e'+(g[w].attributes.DirectionText||g[w].attributes.DisplayText)+"\x3c/span\x3e\x3cbr\x3e",A&&!c&&(B+="\x3cspan\x3e"+n(g[w].attributes.Minutes)+" "+x.networkAnalysis.sharing.Minutes+"\x26nbsp;\x26middot;\x26nbsp;"+t(g[w].attributes.Meters)+"\x3c/span\x3e"),B+="\x3c/li\x3e"}return B+"\x3c/ol\x3e"}),D=function(A){A=new Date(A);var B=function(w){return 10>
w?"0"+w:w};return A.getUTCFullYear()+"-"+B(A.getUTCMonth()+1)+"-"+B(A.getUTCDate())+" "+B(A.getUTCHours())+":"+B(A.getUTCMinutes())+":"+B(A.getUTCSeconds())+" UTC"};m="\x3cbr\x3e\x3cbr\x3e\x3cb\x3e"+x.networkAnalysis.sharing.routeInfoLayer+"\x3c/b\x3e\x3cul\x3e\x3cli\x3e"+n(m.TotalMinutes)+" "+x.networkAnalysis.sharing.Minutes+"\x3c/li\x3e\x3cli\x3e"+t(m.TotalMeters)+"\x3c/li\x3e"+(m.StartTime?"\x3cli\x3e"+x.networkAnalysis.sharing.StartTime+" "+D(m.StartTime)+"\x3c/li\x3e":"")+"\x3c/ul\x3e\x3cb\x3e"+
x.networkAnalysis.sharing.directionsLayer+"\x3c/b\x3e";D=q(!0);65536<=(m+D).length&&(D=q(!1));return m+D})(),tags:x.networkAnalysis.sharing.itemTags+(a.name?", "+a.name.substr(0,255):""),snippet:x.networkAnalysis.sharing.itemSnippet+" "+a.name,thumbnailUrl:a.thumbnail,licenseInfo:x.widgets.directions.printDisclaimer,f:"json"},callbackParamName:"callback"},{usePost:!0})}))},_getRouteId:function(){for(var b="",a=0;32>a;a++)b+="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz"[Math.floor(62*
Math.random())];return b},_populateLayerInfo:function(b,a,e){var f={visibility:!0,layers:[],visibleLayers:[0,1,(a.barriers||[]).length?2:0,(a.barriers||[]).length?4:3,4,5,6],opacity:1};void 0===e?(this._addRouteInfoToLayerInfo(f,b,a.routeInfo,a.extent),this._addDirectionsToLayerInfo(f,b,a.directions,a.extent),this._addDirectionEventsToLayerInfo(f,b,a.directionEvents||[],a.extent),this._addBarriersToLayerInfo(f,b,a.barriers||[],a.extent),this._addPolylineBarriersToLayerInfo(f,b,a.polylineBarriers||
[],a.extent),this._addPolygonBarriersToLayerInfo(f,b,a.polygonBarriers||[],a.extent),this._addStopsToLayerInfo(f,b,a.stops,a.extent)):"1.0.0"===e&&((a.polygonBarriers||[]).length&&this._addPolygonBarriersToLayerInfo(f,b,a.polygonBarriers||[],a.extent),(a.polylineBarriers||[]).length&&this._addPolylineBarriersToLayerInfo(f,b,a.polylineBarriers||[],a.extent),this._addRouteInfoToLayerInfo_100(f,b,a.routeInfo,a.extent,e),this._addDirectionLinesToLayerInfo_100(f,b,a.directionLines||[],a.extent),(a.barriers||
[]).length&&this._addBarriersToLayerInfo(f,b,a.barriers||[],a.extent),this._addDirectionPointsToLayerInfo_100(f,b,a.directionPoints,a.extent),this._addStopsToLayerInfo_100(f,b,a.stops,a.extent));return f},_addStopsToLayerInfo:function(b,a,e,f){a=x.networkAnalysis;var c={type:"codedValue",name:"esriNACurbApproachType",codedValues:[{name:a.enums.esriNACurbApproachType.esriNAEitherSideOfVehicle,code:0},{name:a.enums.esriNACurbApproachType.esriNARightSideOfVehicle,code:1},{name:a.enums.esriNACurbApproachType.esriNALeftSideOfVehicle,
code:2},{name:a.enums.esriNACurbApproachType.esriNANoUTurn,code:3}]},h=this._generateFeatureCollectionTemplate("Stops",a.sharing.stopsLayer,"esriGeometryPoint"),d=h.layerDefinition.fields,g=0<e[0].attributes.ArrivalTime;d.push(this._createField("CurbApproach",a.fields.stops.CurbApproach,"integer",!1,c));d.push(this._createField("ArrivalCurbApproach",a.fields.stops.ArrivalCurbApproach,"integer",!0,c));d.push(this._createField("DepartureCurbApproach",a.fields.stops.DepartureCurbApproach,"integer",!0,
c));d.push(this._createField("Name",a.fields.stops.Name,"string",!0));d.push(this._createField("Sequence",a.fields.stops.Sequence,"integer",!0));d.push(this._createField("Status",a.fields.stops.Status,"integer",!0,{type:"codedValue",name:"esriNAObjectStatus",codedValues:[{name:a.enums.esriNAObjectStatus.esriNAObjectStatusOK,code:0},{name:a.enums.esriNAObjectStatus.esriNAObjectStatusNotLocated,code:1},{name:a.enums.esriNAObjectStatus.esriNAObjectStatusElementNotLocated,code:2},{name:a.enums.esriNAObjectStatus.esriNAObjectStatusElementNotTraversable,
code:3},{name:a.enums.esriNAObjectStatus.esriNAObjectStatusInvalidFieldValues,code:4},{name:a.enums.esriNAObjectStatus.esriNAObjectStatusNotReached,code:5},{name:a.enums.esriNAObjectStatus.esriNAObjectStatusTimeWindowViolation,code:6}]}));d.push(this._createField("LocationType",a.fields.stops.LocationType,"integer",!0,{type:"codedValue",name:"esriNALocationType",codedValues:[{name:a.enums.esriNALocationType.stop,code:0},{name:a.enums.esriNALocationType.waypoint,code:1}]}));d.push(this._createField("TimeWindowStart",
a.fields.stops.TimeWindowStart,"date",!1));d.push(this._createField("TimeWindowEnd",a.fields.stops.TimeWindowEnd,"date",!1));d.push(this._createField("ServiceMinutes",a.fields.stops.ServiceMinutes,"double",!1));d.push(this._createField("ServiceMeters",a.fields.stops.ServiceMeters,"double",!1));d.push(this._createField("ServiceCosts",a.fields.stops.ServiceCosts,"string",!1,null,this._jsonStringFieldSize));d.push(this._createField("CumulativeMinutes",a.fields.stops.CumulativeMinutes,"double",!0));d.push(this._createField("CumulativeMeters",
a.fields.stops.CumulativeMeters,"double",!0));d.push(this._createField("CumulativeCosts",a.fields.stops.CumulativeCosts,"string",!1,null,this._jsonStringFieldSize));d.push(this._createField("LateMinutes",a.fields.stops.LateMinutes,"double",!1));d.push(this._createField("WaitMinutes",a.fields.stops.WaitMinutes,"double",!1));d.push(this._createField("ArrivalTime",a.fields.stops.ArrivalTime,"date",g));d.push(this._createField("DepartureTime",a.fields.stops.DepartureTime,"date",g));d.push(this._createField("ArrivalUTCOffset",
a.fields.stops.ArrivalUTCOffset,"integer",g));d.push(this._createField("DepartureUTCOffset",a.fields.stops.DepartureUTCOffset,"integer",g));for(c=d=0;c<e.length;c++){var k=e[c],m=k.geometry;h.featureSet.features.push({geometry:m.toJson?m.toJson():m,attributes:p.mixin(k.attributes,{__OBJECTID:d++})})}h.layerDefinition.extent=f.toJson?f.toJson():f;f=new Q(2>=e.length?new H(this.firstStopSymbol):new H(this.interimStopSymbol),"Sequence");for(c=0;c<e.length;c++)d=e[c].attributes,k=null,m=a.enums.esriNALocationType.stop,
1===d.LocationType?(k=new R(this.waypointSymbol),m=a.enums.esriNALocationType.waypoint):null===d.ArrivalCurbApproach&&null===d.DepartureCurbApproach?(k=new H(this.unlocatedStopSymbol),m=a.enums.esriNALocationType.stop+" : "+a.enums.esriNAObjectStatus.esriNAObjectStatusNotReached):null===d.ArrivalCurbApproach&&null!==d.DepartureCurbApproach?k=new H(this.firstStopSymbol):null!==d.ArrivalCurbApproach&&null===d.DepartureCurbApproach&&(k=new H(this.lastStopSymbol)),k&&f.addValue({value:d.Sequence,symbol:k,
label:m});h.layerDefinition.drawingInfo.renderer=f.toJson();h.popupInfo={title:"{Name}",fieldInfos:[{fieldName:"Name",label:a.fields.stops.Name,isEditable:!0,tooltip:"",visible:!0,stringFieldOption:"textbox"},{fieldName:"Sequence",label:a.fields.stops.Sequence,isEditable:!1,tooltip:"",visible:!0,format:{places:0,digitSeparator:!0},stringFieldOption:"textbox"},{fieldName:"ArrivalTime",label:a.fields.stops.ArrivalTime,isEditable:!0,tooltip:"",visible:g,format:{dateFormat:"shortDateShortTime24"},stringFieldOption:"textbox"},
{fieldName:"ArrivalUTCOffset",label:a.fields.stops.ArrivalUTCOffset,isEditable:!1,tooltip:"",visible:g,format:{places:0,digitSeparator:!0},stringFieldOption:"textbox"},{fieldName:"DepartureTime",label:a.fields.stops.DepartureTime,isEditable:!0,tooltip:"",visible:g,format:{dateFormat:"shortDateShortTime24"},stringFieldOption:"textbox"},{fieldName:"DepartureUTCOffset",label:a.fields.stops.DepartureUTCOffset,isEditable:!1,tooltip:"",visible:g,format:{places:0,digitSeparator:!0},stringFieldOption:"textbox"},
{fieldName:"CurbApproach",label:a.fields.stops.CurbApproach,isEditable:!0,tooltip:"",visible:!1,format:{places:0,digitSeparator:!0},stringFieldOption:"textbox"},{fieldName:"ArrivalCurbApproach",label:a.fields.stops.ArrivalCurbApproach,isEditable:!1,tooltip:"",visible:!0,format:{places:0,digitSeparator:!0},stringFieldOption:"textbox"},{fieldName:"DepartureCurbApproach",label:a.fields.stops.DepartureCurbApproach,isEditable:!1,tooltip:"",visible:!0,format:{places:0,digitSeparator:!0},stringFieldOption:"textbox"},
{fieldName:"Status",label:a.fields.stops.Status,isEditable:!1,tooltip:"",visible:!0,format:{places:0,digitSeparator:!0},stringFieldOption:"textbox"},{fieldName:"LocationType",label:a.fields.stops.LocationType,isEditable:!1,tooltip:"",visible:!0,format:{places:0,digitSeparator:!0},stringFieldOption:"textbox"},{fieldName:"TimeWindowStart",label:a.fields.stops.TimeWindowStart,isEditable:!0,tooltip:"",visible:!1,format:{dateFormat:"shortDateShortTime24"},stringFieldOption:"textbox"},{fieldName:"TimeWindowEnd",
label:a.fields.stops.TimeWindowEnd,isEditable:!0,tooltip:"",visible:!1,format:{dateFormat:"shortDateShortTime24"},stringFieldOption:"textbox"},{fieldName:"ServiceMinutes",label:a.fields.stops.ServiceMinutes,isEditable:!0,tooltip:"",visible:!1,format:{places:2,digitSeparator:!0},stringFieldOption:"textbox"},{fieldName:"ServiceMeters",label:a.fields.stops.ServiceMeters,isEditable:!0,tooltip:"",visible:!1,format:{places:2,digitSeparator:!0},stringFieldOption:"textbox"},{fieldName:"ServiceCosts",label:a.fields.stops.ServiceCosts,
isEditable:!0,tooltip:"",visible:!1,stringFieldOption:"textbox"},{fieldName:"CumulativeMinutes",label:a.fields.stops.CumulativeMinutes,isEditable:!1,tooltip:"",visible:!0,format:{places:2,digitSeparator:!0},stringFieldOption:"textbox"},{fieldName:"CumulativeMeters",label:a.fields.stops.CumulativeMeters,isEditable:!1,tooltip:"",visible:!0,format:{places:2,digitSeparator:!0},stringFieldOption:"textbox"},{fieldName:"CumulativeCosts",label:a.fields.stops.CumulativeCosts,isEditable:!0,tooltip:"",visible:!1,
stringFieldOption:"textbox"},{fieldName:"LateMinutes",label:a.fields.stops.LateMinutes,isEditable:!1,tooltip:"",visible:!1,format:{places:2,digitSeparator:!0},stringFieldOption:"textbox"},{fieldName:"WaitMinutes",label:a.fields.stops.WaitMinutes,isEditable:!1,tooltip:"",visible:!1,format:{places:2,digitSeparator:!0},stringFieldOption:"textbox"}],description:null,showAttachments:!1,mediaInfos:[]};b.layers.push(h)},_addDirectionsToLayerInfo:function(b,a,e,f){a=x.networkAnalysis;var c=a.enums.esriDirectionsManeuverType,
h=this._generateFeatureCollectionTemplate("Directions",a.sharing.directionsLayer,"esriGeometryPolyline"),d=h.layerDefinition.fields,g=e[0]&&e[0].attributes&&0<e[0].attributes.ArrivalTime;d.push(this._createField("Sequence",a.fields.directions.Sequence,"integer"));d.push(this._createField("StopSequence",a.fields.directions.StopSequence,"integer"));d.push(this._createField("ArrivalTime",a.fields.directions.ArrivalTime,"date",g));d.push(this._createField("UTCOffset",a.fields.directions.UTCOffset,"integer",
g));d.push(this._createField("ManeuverType",a.fields.directions.ManeuverType,"string",!0,{type:"codedValue",name:"esriDirectionsManeuverType",codedValues:[{name:c.esriDMTBearLeft,code:"esriDMTBearLeft"},{name:c.esriDMTBearRight,code:"esriDMTBearRight"},{name:c.esriDMTDepart,code:"esriDMTDepart"},{name:c.esriDMTDoorPassage,code:"esriDMTDoorPassage"},{name:c.esriDMTElevator,code:"esriDMTElevator"},{name:c.esriDMTEndOfFerry,code:"esriDMTEndOfFerry"},{name:c.esriDMTEscalator,code:"esriDMTEscalator"},
{name:c.esriDMTFerry,code:"esriDMTFerry"},{name:c.esriDMTForkCenter,code:"esriDMTForkCenter"},{name:c.esriDMTForkLeft,code:"esriDMTForkLeft"},{name:c.esriDMTForkRight,code:"esriDMTForkRight"},{name:c.esriDMTHighwayChange,code:"esriDMTHighwayChange"},{name:c.esriDMTHighwayExit,code:"esriDMTHighwayExit"},{name:c.esriDMTHighwayMerge,code:"esriDMTHighwayMerge"},{name:c.esriDMTPedestrianRamp,code:"esriDMTPedestrianRamp"},{name:c.esriDMTRampLeft,code:"esriDMTRampLeft"},{name:c.esriDMTRampRight,code:"esriDMTRampRight"},
{name:c.esriDMTRoundabout,code:"esriDMTRoundabout"},{name:c.esriDMTSharpLeft,code:"esriDMTSharpLeft"},{name:c.esriDMTSharpRight,code:"esriDMTSharpRight"},{name:c.esriDMTStairs,code:"esriDMTStairs"},{name:c.esriDMTStop,code:"esriDMTStop"},{name:c.esriDMTStraight,code:"esriDMTStraight"},{name:c.esriDMTTripItem,code:"esriDMTTripItem"},{name:c.esriDMTTurnLeft,code:"esriDMTTurnLeft"},{name:c.esriDMTTurnLeftLeft,code:"esriDMTTurnLeftLeft"},{name:c.esriDMTTurnLeftRight,code:"esriDMTTurnLeftRight"},{name:c.esriDMTTurnRight,
code:"esriDMTTurnRight"},{name:c.esriDMTTurnRightLeft,code:"esriDMTTurnRightLeft"},{name:c.esriDMTTurnRightRight,code:"esriDMTTurnRightRight"},{name:c.esriDMTUnknown,code:"esriDMTUnknown"},{name:c.esriDMTUTurn,code:"esriDMTUTurn"}]}));d.push(this._createField("Meters",a.fields.directions.Meters,"double",!0));d.push(this._createField("Minutes",a.fields.directions.Minutes,"double",!0));d.push(this._createField("DirectionText",a.fields.directions.DirectionText,"string",!0,null,2048));d.push(this._createField("ManeuverMessages",
a.fields.directions.ManeuverMessages,"string",!1,null,this._jsonStringFieldSize));for(d=c=0;d<e.length;d++){var k=e[d],m=k.geometry;h.featureSet.features.push({geometry:m&&m.toJson?m.toJson():m,attributes:p.mixin(k.attributes,{__OBJECTID:c++})})}h.layerDefinition.extent=f.toJson?f.toJson():f;e=new P(new ca(this.directionSymbol));h.layerDefinition.drawingInfo.renderer=e.toJson();h.popupInfo={title:"{Text}",fieldInfos:[{fieldName:"ManeuverType",label:a.fields.directions.ManeuverType,isEditable:!1,tooltip:"",
visible:!0,stringFieldOption:"textbox"},{fieldName:"DirectionText",label:a.fields.directions.DirectionText,isEditable:!1,tooltip:"",visible:!0,stringFieldOption:"textbox"},{fieldName:"Sequence",label:a.fields.directions.Sequence,isEditable:!1,tooltip:"",visible:!1,format:{places:0,digitSeparator:!0},stringFieldOption:"textbox"},{fieldName:"StopSequence",label:a.fields.directions.StopSequence,isEditable:!1,tooltip:"",visible:!1,format:{places:0,digitSeparator:!0},stringFieldOption:"textbox"},{fieldName:"ArrivalTime",
label:a.fields.directions.ArrivalTime,isEditable:!0,tooltip:"",visible:g,format:{dateFormat:"shortDateShortTime24"},stringFieldOption:"textbox"},{fieldName:"UTCOffset",label:a.fields.directions.UTCOffset,isEditable:!1,tooltip:"",visible:g,format:{places:0,digitSeparator:!0},stringFieldOption:"textbox"},{fieldName:"Meters",label:a.fields.directions.Meters,isEditable:!1,tooltip:"",visible:!0,format:{places:2,digitSeparator:!0},stringFieldOption:"textbox"},{fieldName:"Minutes",label:a.fields.directions.Minutes,
isEditable:!1,tooltip:"",visible:!0,format:{places:2,digitSeparator:!0},stringFieldOption:"textbox"},{fieldName:"ManeuverMessages",label:a.fields.directions.ManeuverMessages,isEditable:!1,tooltip:"",visible:!1,stringFieldOption:"textbox"}],description:null,showAttachments:!1,mediaInfos:[]};b.layers.push(h)},_addDirectionEventsToLayerInfo:function(b,a,e,f){a=x.networkAnalysis;var c=this._generateFeatureCollectionTemplate("DirectionEvents",a.sharing.directionEventsLayer,"esriGeometryPoint"),h=c.layerDefinition.fields,
d=e[0]&&e[0].attributes&&0<e[0].attributes.ArrivalTime;h.push(this._createField("ArrivalTime",a.fields.directionEvents.ArrivalTime,"date",d));h.push(this._createField("UTCOffset",a.fields.directionEvents.UTCOffset,"integer",d));h.push(this._createField("DirectionSequence",a.fields.directionEvents.DirectionSequence,"integer"));h.push(this._createField("Sequence",a.fields.directionEvents.Sequence,"integer"));h.push(this._createField("EventText",a.fields.directionEvents.EventText,"string",!0,null,2048));
h.push(this._createField("EventMessages",a.fields.directionEvents.EventMessages,"string",!1,null,this._jsonStringFieldSize));for(var g=h=0;g<e.length;g++){var k=e[g],m=k.geometry;c.featureSet.features.push({geometry:m&&m.toJson?m.toJson():m,attributes:p.mixin(k.attributes,{__OBJECTID:h++})})}c.layerDefinition.extent=f.toJson?f.toJson():f;e=new P(new R(this.directionEventSymbol));c.layerDefinition.drawingInfo.renderer=e.toJson();c.popupInfo={title:a.sharing.directionEventsLayer,fieldInfos:[{fieldName:"EventText",
label:a.fields.directionEvents.EventText,isEditable:!1,tooltip:"",visible:!0,stringFieldOption:"textbox"},{fieldName:"ArrivalTime",label:a.fields.directionEvents.ArrivalTime,isEditable:!0,tooltip:"",visible:d,format:{dateFormat:"shortDateShortTime24"},stringFieldOption:"textbox"},{fieldName:"UTCOffset",label:a.fields.directionEvents.UTCOffset,isEditable:!1,tooltip:"",visible:d,format:{places:0,digitSeparator:!0},stringFieldOption:"textbox"},{fieldName:"DirectionSequence",label:a.fields.directionEvents.DirectionSequence,
isEditable:!1,tooltip:"",visible:!1,format:{places:0,digitSeparator:!0},stringFieldOption:"textbox"},{fieldName:"Sequence",label:a.fields.directionEvents.Sequence,isEditable:!1,tooltip:"",visible:!1,format:{places:0,digitSeparator:!0},stringFieldOption:"textbox"},{fieldName:"EventMessages",label:a.fields.directionEvents.EventMessages,isEditable:!1,tooltip:"",visible:!1,stringFieldOption:"textbox"}],description:null,showAttachments:!1,mediaInfos:[]};b.layers.push(c)},_addBarriersToLayerInfo:function(b,
a,e,f){a=x.networkAnalysis;var c=this._generateFeatureCollectionTemplate("Barriers",a.sharing.barriersLayer,"esriGeometryPoint"),h=c.layerDefinition.fields;h.push(this._createField("Name",a.fields.barriers.Name,"string",!0));h.push(this._createField("BarrierType",a.fields.barriers.BarrierType,"integer",!0,{type:"codedValue",name:"esriNABarrierType",codedValues:[{name:a.enums.esriNABarrierType.esriNABTRestriction,code:0},{name:a.enums.esriNABarrierType.esriNABTScaledCost,code:1},{name:a.enums.esriNABarrierType.esriNABTAddedCost,
code:2}]}));h.push(this._createField("FullEdge",a.fields.barriers.FullEdge,"integer",!0,{type:"codedValue",name:"esriNAIntYesNo",codedValues:[{name:a.enums.esriNAIntYesNo.No,code:0},{name:a.enums.esriNAIntYesNo.Yes,code:1}]}));h.push(this._createField("AddedCost",a.fields.barriers.AddedCost,"double",!0));h.push(this._createField("Costs",a.fields.barriers.Costs,"string",!1,null,this._jsonStringFieldSize));h.push(this._createField("Status",a.fields.barriers.Status,"integer",!0,{type:"codedValue",name:"esriNAObjectStatus",
codedValues:[{name:a.enums.esriNAObjectStatus.esriNAObjectStatusOK,code:0},{name:a.enums.esriNAObjectStatus.esriNAObjectStatusNotLocated,code:1},{name:a.enums.esriNAObjectStatus.esriNAObjectStatusElementNotLocated,code:2},{name:a.enums.esriNAObjectStatus.esriNAObjectStatusElementNotTraversable,code:3},{name:a.enums.esriNAObjectStatus.esriNAObjectStatusInvalidFieldValues,code:4},{name:a.enums.esriNAObjectStatus.esriNAObjectStatusNotReached,code:5},{name:a.enums.esriNAObjectStatus.esriNAObjectStatusTimeWindowViolation,
code:6}]}));h.push(this._createField("CurbApproach",a.fields.barriers.CurbApproach,"integer",!1,{type:"codedValue",name:"esriNACurbApproachType",codedValues:[{name:a.enums.esriNACurbApproachType.esriNAEitherSideOfVehicle,code:0},{name:a.enums.esriNACurbApproachType.esriNARightSideOfVehicle,code:1},{name:a.enums.esriNACurbApproachType.esriNALeftSideOfVehicle,code:2},{name:a.enums.esriNACurbApproachType.esriNANoUTurn,code:3}]}));h=0;for(var d=!1,g=!1,k=0;k<e.length;k++){var m=e[k],l=m.geometry,n=m.attributes;
d=d||void 0!==l.m;g=g||void 0!==l.z;c.featureSet.features.push({geometry:p.mixin(l&&l.toJson?l.toJson():l,d?{m:l.m}:{}),attributes:p.mixin(m.attributes,{__OBJECTID:++h,FullEdge:n.FullEdge||0,Status:n.Status||0,CurbApproach:n.CurbApproach||0})})}p.mixin(c.layerDefinition,{extent:f.toJson?f.toJson():f,hasM:d,hasZ:g});c.layerDefinition.drawingInfo.renderer=this.barrierRenderer.toJson();c.popupInfo={title:a.sharing.barriersLayer,fieldInfos:[{fieldName:"Name",label:a.fields.barriers.Name,isEditable:!0,
tooltip:"",visible:!0,stringFieldOption:"textbox"},{fieldName:"BarrierType",label:a.fields.barriers.BarrierType,isEditable:!0,tooltip:"",visible:!0,stringFieldOption:"textbox"},{fieldName:"CurbApproach",label:a.fields.barriers.CurbApproach,isEditable:!0,tooltip:"",visible:!0,stringFieldOption:"textbox"},{fieldName:"FullEdge",label:a.fields.barriers.FullEdge,isEditable:!0,tooltip:"",visible:!1,stringFieldOption:"textbox"},{fieldName:"AddedCost",label:a.fields.barriers.AddedCost,isEditable:!0,tooltip:"",
visible:!0,format:{places:3,digitSeparator:!0},stringFieldOption:"textbox"},{fieldName:"Costs",label:a.fields.barriers.Costs,isEditable:!0,tooltip:"",visible:!1,stringFieldOption:"textbox"},{fieldName:"Status",label:a.fields.barriers.Status,isEditable:!1,tooltip:"",visible:!1,stringFieldOption:"textbox"}],description:null,showAttachments:!1,mediaInfos:[]};b.layers.push(c)},_addPolylineBarriersToLayerInfo:function(b,a,e,f){a=x.networkAnalysis;var c=this._generateFeatureCollectionTemplate("PolylineBarriers",
a.sharing.polylineBarriersLayer,"esriGeometryPolyline"),h=c.layerDefinition.fields;h.push(this._createField("Name",a.fields.polylineBarriers.Name,"string",!0));h.push(this._createField("BarrierType",a.fields.polylineBarriers.BarrierType,"integer",!0,{type:"codedValue",name:"esriNABarrierType",codedValues:[{name:a.enums.esriNABarrierType.esriNABTRestriction,code:0},{name:a.enums.esriNABarrierType.esriNABTScaledCost,code:1},{name:a.enums.esriNABarrierType.esriNABTAddedCost,code:2}]}));h.push(this._createField("ScaleFactor",
a.fields.polylineBarriers.ScaleFactor,"double",!0));h.push(this._createField("Costs",a.fields.polylineBarriers.Costs,"string",!1,null,this._jsonStringFieldSize));h=0;for(var d=!1,g=!1,k=0;k<e.length;k++){var m=e[k],l=m.geometry,n=m.attributes;l&&n&&(d=d||l.hasM||!1,g=g||l.hasZ||!1,c.featureSet.features.push({geometry:l&&l.toJson?l.toJson():l,attributes:p.mixin(m.attributes,{__OBJECTID:++h})}))}p.mixin(c.layerDefinition,{extent:f.toJson?f.toJson():f,hasM:d,hasZ:g});c.layerDefinition.drawingInfo.renderer=
this.polylineBarrierRenderer.toJson();c.popupInfo={title:a.sharing.polylineBarriersLayer,fieldInfos:[{fieldName:"Name",label:a.fields.polylineBarriers.Name,isEditable:!0,tooltip:"",visible:!0,stringFieldOption:"textbox"},{fieldName:"BarrierType",label:a.fields.polylineBarriers.BarrierType,isEditable:!0,tooltip:"",visible:!0,stringFieldOption:"textbox"},{fieldName:"ScaleFactor",label:a.fields.polylineBarriers.ScaleFactor,isEditable:!0,tooltip:"",visible:!0,format:{places:3,digitSeparator:!0},stringFieldOption:"textbox"},
{fieldName:"Costs",label:a.fields.polylineBarriers.Costs,isEditable:!0,tooltip:"",visible:!1,stringFieldOption:"textbox"}],description:null,showAttachments:!1,mediaInfos:[]};b.layers.push(c)},_addPolygonBarriersToLayerInfo:function(b,a,e,f){a=x.networkAnalysis;var c=this._generateFeatureCollectionTemplate("PolygonBarriers",a.sharing.polygonBarriersLayer,"esriGeometryPolygon"),h=c.layerDefinition.fields;h.push(this._createField("Name",a.fields.polygonBarriers.Name,"string",!0));h.push(this._createField("BarrierType",
a.fields.polygonBarriers.BarrierType,"integer",!0,{type:"codedValue",name:"esriNABarrierType",codedValues:[{name:a.enums.esriNABarrierType.esriNABTRestriction,code:0},{name:a.enums.esriNABarrierType.esriNABTScaledCost,code:1},{name:a.enums.esriNABarrierType.esriNABTAddedCost,code:2}]}));h.push(this._createField("ScaleFactor",a.fields.polygonBarriers.ScaleFactor,"double",!0));h.push(this._createField("Costs",a.fields.polygonBarriers.Costs,"string",!1,null,this._jsonStringFieldSize));h=0;for(var d=
!1,g=!1,k=0;k<e.length;k++){var m=e[k],l=m.geometry,n=m.attributes;l&&n&&(d=d||l.hasM||!1,g=g||l.hasZ||!1,c.featureSet.features.push({geometry:l&&l.toJson?l.toJson():l,attributes:p.mixin(m.attributes,{__OBJECTID:++h})}))}p.mixin(c.layerDefinition,{extent:f.toJson?f.toJson():f,hasM:d,hasZ:g});c.layerDefinition.drawingInfo.renderer=this.polygonBarrierRenderer.toJson();c.popupInfo={title:a.sharing.polygonBarriersLayer,fieldInfos:[{fieldName:"Name",label:a.fields.polygonBarriers.Name,isEditable:!0,tooltip:"",
visible:!0,stringFieldOption:"textbox"},{fieldName:"BarrierType",label:a.fields.polygonBarriers.BarrierType,isEditable:!0,tooltip:"",visible:!0,stringFieldOption:"textbox"},{fieldName:"ScaleFactor",label:a.fields.polygonBarriers.ScaleFactor,isEditable:!0,tooltip:"",visible:!0,format:{places:3,digitSeparator:!0},stringFieldOption:"textbox"},{fieldName:"Costs",label:a.fields.polygonBarriers.Costs,isEditable:!0,tooltip:"",visible:!1,stringFieldOption:"textbox"}],description:null,showAttachments:!1,mediaInfos:[]};
b.layers.push(c)},_addRouteInfoToLayerInfo:function(b,a,e,f){a=x.networkAnalysis;var c=this._generateFeatureCollectionTemplate("RouteInfo",a.sharing.routeInfoLayer,"esriGeometryPolyline"),h=c.layerDefinition.fields,d=void 0!==e.attributes.StartTime&&null!==e.attributes.StartTime;h.push(this._createField("RouteName",a.fields.routeInfo.RouteName,"string",!0,null,1024));h.push(this._createField("TotalMinutes",a.fields.routeInfo.TotalMinutes,"double",!0));h.push(this._createField("TotalMeters",a.fields.routeInfo.TotalMeters,
"double",!0));h.push(this._createField("TotalLateMinutes",a.fields.routeInfo.TotalLateMinutes,"double"));h.push(this._createField("TotalWaitMinutes",a.fields.routeInfo.TotalWaitMinutes,"double"));h.push(this._createField("TotalCosts",a.fields.routeInfo.TotalCosts,"string",!1,null,this._jsonStringFieldSize));h.push(this._createField("StartTime",a.fields.routeInfo.StartTime,"date",d));h.push(this._createField("StartUTCOffset",a.fields.routeInfo.StartUTCOffset,"integer",d));h.push(this._createField("EndTime",
a.fields.routeInfo.EndTime,"date",d));h.push(this._createField("EndUTCOffset",a.fields.routeInfo.EndUTCOffset,"integer",d));h.push(this._createField("Messages",a.fields.routeInfo.Messages,"string",!1,null,this._jsonStringFieldSize));h.push(this._createField("AnalysisSettings",a.fields.routeInfo.AnalysisSettings,"string",!1,null,this._jsonStringFieldSize));h=e.geometry;c.featureSet.features.push({geometry:h&&h.toJson?h.toJson():h,attributes:p.mixin(e.attributes,{__OBJECTID:1})});c.layerDefinition.extent=
f.toJson?f.toJson():f;e=new P(new ca(this.routeSymbol));c.layerDefinition.drawingInfo.renderer=e.toJson();c.popupInfo={title:a.sharing.routeInfoLayer,fieldInfos:[{fieldName:"RouteName",label:a.fields.routeInfo.RouteName,isEditable:!1,tooltip:"",visible:!0,stringFieldOption:"textbox"},{fieldName:"TotalMinutes",label:a.fields.routeInfo.TotalMinutes,isEditable:!1,tooltip:"",visible:!0,format:{places:2,digitSeparator:!0},stringFieldOption:"textbox"},{fieldName:"TotalMeters",label:a.fields.routeInfo.TotalMeters,
isEditable:!1,tooltip:"",visible:!0,format:{places:2,digitSeparator:!0},stringFieldOption:"textbox"},{fieldName:"TotalLateMinutes",label:a.fields.routeInfo.TotalLateMinutes,isEditable:!1,tooltip:"",visible:!1,format:{places:2,digitSeparator:!0},stringFieldOption:"textbox"},{fieldName:"TotalWaitMinutes",label:a.fields.routeInfo.TotalWaitMinutes,isEditable:!1,tooltip:"",visible:!1,format:{places:2,digitSeparator:!0},stringFieldOption:"textbox"},{fieldName:"TotalCosts",label:a.fields.routeInfo.TotalCosts,
isEditable:!1,tooltip:"",visible:!1,stringFieldOption:"textbox"},{fieldName:"StartTime",label:a.fields.routeInfo.StartTime,isEditable:!1,tooltip:"",visible:d,format:{dateFormat:"shortDateShortTime24"},stringFieldOption:"textbox"},{fieldName:"StartUTCOffset",label:a.fields.routeInfo.StartUTCOffset,isEditable:!1,tooltip:"",visible:d,format:{places:0,digitSeparator:!0},stringFieldOption:"textbox"},{fieldName:"EndTime",label:a.fields.routeInfo.EndTime,isEditable:!1,tooltip:"",visible:d,format:{dateFormat:"shortDateShortTime24"},
stringFieldOption:"textbox"},{fieldName:"EndUTCOffset",label:a.fields.routeInfo.EndUTCOffset,isEditable:!1,tooltip:"",visible:d,format:{places:0,digitSeparator:!0},stringFieldOption:"textbox"},{fieldName:"Messages",label:a.fields.routeInfo.Messages,isEditable:!1,tooltip:"",visible:!1,stringFieldOption:"textbox"},{fieldName:"SolverSettings",label:a.fields.routeInfo.SolverSettings,isEditable:!1,tooltip:"",visible:!1,stringFieldOption:"textbox"}],description:null,showAttachments:!1,mediaInfos:[]};b.layers.push(c)},
_loadDirectionsFeatureSet:function(b,a,e,f,c){for(var h=[],d=function(l){var n=l,t=b[n].geometry;l=function(q){for(;!t&&(0>q&&0<n||0<q&&n<b.length-1);){n+=q;var D=b[n].geometry;if(D&&D.paths&&D.paths[0]){t={paths:[[D.paths[0][0<q?0:D.paths[0].length-1],D.paths[0][0<q?0:D.paths[0].length-1]]],spatialReference:c};break}}return t};return l(1)||l(-1)},g=p.hitch(this,function(l){for(var n=[],t=0;t<a.length;t++)a[t].attributes.DirectionSequence===l&&(n.push({ETA:this.toGeolocalTime(a[t].attributes.ArrivalTime,
a[t].attributes.UTCOffset),arriveTimeUTC:null===a[t].attributes.UTCOffset?void 0:a[t].attributes.ArrivalTime,strings:G.parse(a[t].attributes.EventMessages)||[],point:{x:a[t].geometry.x,y:a[t].geometry.y}}),a[t].attributes.EventText&&n[n.length-1].strings.splice(0,0,{string:a[t].attributes.EventText,stringType:"esriDSTGeneral"}));return n}),k=0;k<b.length;k++){var m={attributes:{length:this.fromMeters(b[k].attributes.Meters,e),time:this.fromMinutes(b[k].attributes.Minutes,f),text:b[k].attributes.DirectionText,
ETA:this.toGeolocalTime(b[k].attributes.ArrivalTime,b[k].attributes.UTCOffset),arriveTimeUTC:null===b[k].attributes.UTCOffset?void 0:b[k].attributes.ArrivalTime,maneuverType:b[k].attributes.ManeuverType,_stopSequence:b[k].attributes.StopSequence},geometry:d(k)||ss[0]&&ss[0].geometry&&{paths:[[[ss[0].geometry.x,ss[0].geometry.y]]],spatialReference:c},strings:G.parse(b[k].attributes.ManeuverMessages||"[]"),events:g(k)};0===m.strings.length&&delete m.strings;h.push(m)}return h},_addStopsToLayerInfo_100:function(b,
a,e,f){a=x.networkAnalysis;var c={type:"codedValue",name:"esriNACurbApproachType",codedValues:[{name:a.enums.esriNACurbApproachType.esriNAEitherSideOfVehicle,code:0},{name:a.enums.esriNACurbApproachType.esriNARightSideOfVehicle,code:1},{name:a.enums.esriNACurbApproachType.esriNALeftSideOfVehicle,code:2},{name:a.enums.esriNACurbApproachType.esriNANoUTurn,code:3}]},h=this._generateFeatureCollectionTemplate("Stops",a.sharing.stopsLayer,"esriGeometryPoint"),d=h.layerDefinition.fields,g=0<e[0].attributes.ArrivalTime;
d.push(this._createField("CurbApproach",a.fields.stops.CurbApproach,"integer",!1,c));d.push(this._createField("ArrivalCurbApproach",a.fields.stops.ArrivalCurbApproach,"integer",!0,c));d.push(this._createField("DepartureCurbApproach",a.fields.stops.DepartureCurbApproach,"integer",!0,c));d.push(this._createField("Name",a.fields.stops.Name,"string",!0));d.push(this._createField("RouteName",a.fields.routeInfo.RouteName,"string",!0));d.push(this._createField("Sequence",a.fields.stops.Sequence,"integer",
!0));d.push(this._createField("Status",a.fields.stops.Status,"integer",!0,{type:"codedValue",name:"esriNAObjectStatus",codedValues:[{name:a.enums.esriNAObjectStatus.esriNAObjectStatusOK,code:0},{name:a.enums.esriNAObjectStatus.esriNAObjectStatusNotLocated,code:1},{name:a.enums.esriNAObjectStatus.esriNAObjectStatusElementNotLocated,code:2},{name:a.enums.esriNAObjectStatus.esriNAObjectStatusElementNotTraversable,code:3},{name:a.enums.esriNAObjectStatus.esriNAObjectStatusInvalidFieldValues,code:4},{name:a.enums.esriNAObjectStatus.esriNAObjectStatusNotReached,
code:5},{name:a.enums.esriNAObjectStatus.esriNAObjectStatusTimeWindowViolation,code:6}]}));d.push(this._createField("LocationType",a.fields.stops.LocationType,"integer",!0,{type:"codedValue",name:"esriNALocationType",codedValues:[{name:a.enums.esriNALocationType.stop,code:0},{name:a.enums.esriNALocationType.waypoint,code:1}]}));d.push(this._createField("TimeWindowStart",a.fields.stops.TimeWindowStart,"date",!1));d.push(this._createField("TimeWindowEnd",a.fields.stops.TimeWindowEnd,"date",!1));d.push(this._createField("TimeWindowStartUTCOffset",
a.fields.stops.TimeWindowStart+": "+a.fields.directions.UTCOffset,"integer",g));d.push(this._createField("TimeWindowEndUTCOffset",a.fields.stops.TimeWindowEnd+": "+a.fields.directions.UTCOffset,"integer",g));d.push(this._createField("ServiceMinutes",a.fields.stops.ServiceMinutes,"double",!1));d.push(this._createField("ServiceMeters",a.fields.stops.ServiceMeters,"double",!1));d.push(this._createField("ServiceCosts",a.fields.stops.ServiceCosts,"string",!1,null,this._jsonStringFieldSize));d.push(this._createField("CumulativeMinutes",
a.fields.stops.CumulativeMinutes,"double",!0));d.push(this._createField("CumulativeMeters",a.fields.stops.CumulativeMeters,"double",!0));d.push(this._createField("CumulativeCosts",a.fields.stops.CumulativeCosts,"string",!1,null,this._jsonStringFieldSize));d.push(this._createField("LateMinutes",a.fields.stops.LateMinutes,"double",!1));d.push(this._createField("WaitMinutes",a.fields.stops.WaitMinutes,"double",!1));d.push(this._createField("ArrivalTime",a.fields.stops.ArrivalTime,"date",g));d.push(this._createField("DepartureTime",
a.fields.stops.DepartureTime,"date",g));d.push(this._createField("ArrivalUTCOffset",a.fields.stops.ArrivalUTCOffset,"integer",g));d.push(this._createField("DepartureUTCOffset",a.fields.stops.DepartureUTCOffset,"integer",g));d=0;var k=!1,m=!1;for(c=0;c<e.length;c++){var l=e[c],n=l.geometry;k=k||void 0!==n.m;m=m||void 0!=n.m;h.featureSet.features.push({geometry:p.mixin(n&&n.toJson?n.toJson():n,k?{m:n.m}:{}),attributes:void 0!==l.attributes.__OBJECTID?l.attributes:p.mixin(l.attributes,{__OBJECTID:++d})})}p.mixin(h.layerDefinition,
{extent:f.toJson?f.toJson():f,hasM:k,hasZ:m});f=new Q(2>=e.length?new H(this.firstStopSymbol):new H(this.interimStopSymbol),"Sequence");for(c=0;c<e.length;c++)d=e[c].attributes,k=null,m=a.enums.esriNALocationType.stop,1===d.LocationType?(k=new R(this.waypointSymbol),m=a.enums.esriNALocationType.waypoint):null===d.ArrivalCurbApproach&&null===d.DepartureCurbApproach?(k=new H(this.unlocatedStopSymbol),m=a.enums.esriNALocationType.stop+" : "+a.enums.esriNAObjectStatus.esriNAObjectStatusNotReached):null===
d.ArrivalCurbApproach&&null!==d.DepartureCurbApproach?k=new H(this.firstStopSymbol):null!==d.ArrivalCurbApproach&&null===d.DepartureCurbApproach&&(k=new H(this.lastStopSymbol)),k&&f.addValue({value:d.Sequence,symbol:k,label:m});h.layerDefinition.drawingInfo.renderer=f.toJson();h.popupInfo={title:"{Name}",fieldInfos:[{fieldName:"Name",label:a.fields.stops.Name,isEditable:!0,tooltip:"",visible:!0,stringFieldOption:"textbox"},{fieldName:"RouteName",label:a.fields.routeInfo.RouteName,isEditable:!0,tooltip:"",
visible:!0,stringFieldOption:"textbox"},{fieldName:"Sequence",label:a.fields.stops.Sequence,isEditable:!1,tooltip:"",visible:!0,format:{places:0,digitSeparator:!0},stringFieldOption:"textbox"},{fieldName:"ArrivalTime",label:a.fields.stops.ArrivalTime,isEditable:!0,tooltip:"",visible:g,format:{dateFormat:"shortDateShortTime24"},stringFieldOption:"textbox"},{fieldName:"ArrivalUTCOffset",label:a.fields.stops.ArrivalUTCOffset,isEditable:!1,tooltip:"",visible:g,format:{places:0,digitSeparator:!0},stringFieldOption:"textbox"},
{fieldName:"DepartureTime",label:a.fields.stops.DepartureTime,isEditable:!0,tooltip:"",visible:g,format:{dateFormat:"shortDateShortTime24"},stringFieldOption:"textbox"},{fieldName:"DepartureUTCOffset",label:a.fields.stops.DepartureUTCOffset,isEditable:!1,tooltip:"",visible:g,format:{places:0,digitSeparator:!0},stringFieldOption:"textbox"},{fieldName:"CurbApproach",label:a.fields.stops.CurbApproach,isEditable:!0,tooltip:"",visible:!1,format:{places:0,digitSeparator:!0},stringFieldOption:"textbox"},
{fieldName:"ArrivalCurbApproach",label:a.fields.stops.ArrivalCurbApproach,isEditable:!1,tooltip:"",visible:!0,format:{places:0,digitSeparator:!0},stringFieldOption:"textbox"},{fieldName:"DepartureCurbApproach",label:a.fields.stops.DepartureCurbApproach,isEditable:!1,tooltip:"",visible:!0,format:{places:0,digitSeparator:!0},stringFieldOption:"textbox"},{fieldName:"Status",label:a.fields.stops.Status,isEditable:!1,tooltip:"",visible:!0,format:{places:0,digitSeparator:!0},stringFieldOption:"textbox"},
{fieldName:"LocationType",label:a.fields.stops.LocationType,isEditable:!1,tooltip:"",visible:!0,format:{places:0,digitSeparator:!0},stringFieldOption:"textbox"},{fieldName:"TimeWindowStart",label:a.fields.stops.TimeWindowStart,isEditable:!0,tooltip:"",visible:!1,format:{dateFormat:"shortDateShortTime24"},stringFieldOption:"textbox"},{fieldName:"TimeWindowStartUTCOffset",label:a.fields.stops.TimeWindowStart+": "+a.fields.directions.UTCOffset,isEditable:!1,tooltip:"",visible:!1,format:{places:0,digitSeparator:!0},
stringFieldOption:"textbox"},{fieldName:"TimeWindowEnd",label:a.fields.stops.TimeWindowEnd,isEditable:!0,tooltip:"",visible:!1,format:{dateFormat:"shortDateShortTime24"},stringFieldOption:"textbox"},{fieldName:"TimeWindowEndUTCOffset",label:a.fields.stops.TimeWindowEnd+": "+a.fields.directions.UTCOffset,isEditable:!1,tooltip:"",visible:!1,format:{places:0,digitSeparator:!0},stringFieldOption:"textbox"},{fieldName:"ServiceMinutes",label:a.fields.stops.ServiceMinutes,isEditable:!0,tooltip:"",visible:!1,
format:{places:2,digitSeparator:!0},stringFieldOption:"textbox"},{fieldName:"ServiceMeters",label:a.fields.stops.ServiceMeters,isEditable:!0,tooltip:"",visible:!1,format:{places:2,digitSeparator:!0},stringFieldOption:"textbox"},{fieldName:"ServiceCosts",label:a.fields.stops.ServiceCosts,isEditable:!0,tooltip:"",visible:!1,stringFieldOption:"textbox"},{fieldName:"CumulativeMinutes",label:a.fields.stops.CumulativeMinutes,isEditable:!1,tooltip:"",visible:!0,format:{places:2,digitSeparator:!0},stringFieldOption:"textbox"},
{fieldName:"CumulativeMeters",label:a.fields.stops.CumulativeMeters,isEditable:!1,tooltip:"",visible:!0,format:{places:2,digitSeparator:!0},stringFieldOption:"textbox"},{fieldName:"CumulativeCosts",label:a.fields.stops.CumulativeCosts,isEditable:!0,tooltip:"",visible:!1,stringFieldOption:"textbox"},{fieldName:"LateMinutes",label:a.fields.stops.LateMinutes,isEditable:!1,tooltip:"",visible:!1,format:{places:2,digitSeparator:!0},stringFieldOption:"textbox"},{fieldName:"WaitMinutes",label:a.fields.stops.WaitMinutes,
isEditable:!1,tooltip:"",visible:!1,format:{places:2,digitSeparator:!0},stringFieldOption:"textbox"}],description:null,showAttachments:!1,mediaInfos:[]};b.layers.push(h)},_addRouteInfoToLayerInfo_100:function(b,a,e,f,c){this._addRouteInfoToLayerInfo(b,a,e,f);a=x.networkAnalysis;b=b.layers[b.layers.length-1];b.layerDefinition.fields.push(this._createField("Version",a.fields.routeInfo.Version,"string",!0,null,16));b.popupInfo.fieldInfos.push({fieldName:"Version",label:a.fields.routeInfo.Version,isEditable:!1,
tooltip:"",visible:!0,stringFieldOption:"textbox"});b.featureSet.features[0].attributes.Version=c;e=e.geometry;p.mixin(b.layerDefinition,{hasM:e.hasM||!1,hasZ:e.hasZ||!1})},_addDirectionPointsToLayerInfo_100:function(b,a,e,f){a=x.networkAnalysis;var c=a.enums.esriDirectionItemType,h=this._generateFeatureCollectionTemplate("DirectionPoints",a.sharing.directionPointsLayer,"esriGeometryPoint"),d=h.layerDefinition.fields,g=e[0]&&e[0].attributes&&0<e[0].attributes.ArrivalTime;d.push(this._createField("Sequence",
a.fields.directions.Sequence,"integer",!0));d.push(this._createField("StopID",a.fields.directions.StopID,"integer",!0));d.push(this._createField("DirectionPointType",a.fields.directions.ItemType,"integer",!0,{type:"codedValue",name:"esriDirectionPointType",codedValues:[{name:c.esriDITUnknown,code:0},{name:"",code:1},{name:c.esriDITManeuverArrive,code:50},{name:c.esriDITManeuverDepart,code:51},{name:c.esriDITManeuverStraight,code:52},{name:c.esriDITManeuverFerryOn,code:100},{name:c.esriDITManeuverFerryOff,
code:101},{name:c.esriDITManeuverForkCenter,code:102},{name:c.esriDITManeuverRoundabout,code:103},{name:c.esriDITManeuverUTurn,code:104},{name:c.esriDITManeuverDoor,code:150},{name:c.esriDITManeuverStairs,code:151},{name:c.esriDITManeuverElevator,code:152},{name:c.esriDITManeuverEscalator,code:153},{name:c.esriDITManeuverPedestrianRamp,code:154},{name:c.esriDITManeuverForkLeft,code:200},{name:c.esriDITManeuverRampLeft,code:201},{name:c.esriDITManeuverRoundaboutLeft,code:202},{name:c.esriDITManeuverUTurnLeft,
code:203},{name:c.esriDITManeuverBearLeft,code:204},{name:c.esriDITManeuverTurnLeft,code:205},{name:c.esriDITManeuverSharpLeft,code:206},{name:c.esriDITManeuverTurnLeftLeft,code:207},{name:c.esriDITManeuverTurnLeftRight,code:208},{name:c.esriDITManeuverForkRight,code:300},{name:c.esriDITManeuverRampRight,code:301},{name:c.esriDITManeuverRoundaboutRight,code:302},{name:c.esriDITManeuverUTurnRight,code:303},{name:c.esriDITManeuverBearRight,code:304},{name:c.esriDITManeuverTurnRight,code:305},{name:c.esriDITManeuverSharpRight,
code:306},{name:c.esriDITManeuverTurnRightLeft,code:307},{name:c.esriDITManeuverTurnRightRight,code:308},{name:c.esriDITManeuverElevatorUp,code:400},{name:c.esriDITManeuverEscalatorUp,code:401},{name:c.esriDITManeuverStairsUp,code:402},{name:c.esriDITManeuverElevatorDown,code:500},{name:c.esriDITManeuverEscalatorDown,code:501},{name:c.esriDITManeuverStairsDown,code:502},{name:c.esriDITEvent,code:1E3},{name:c.esriDITEventLandmark,code:1001},{name:c.esriDITEventTimeZone,code:1002},{name:c.esriDITEventTraffic,
code:1003},{name:c.esriDITEventBarrier,code:1004},{name:c.esriDITEventBoundary,code:1005},{name:c.esriDITEventRestrictionViolation,code:1006}]}));d.push(this._createField("DisplayText",a.fields.directions.DisplayText,"string",!0,null,2048));d.push(this._createField("ArrivalTime",a.fields.directions.ArrivalTime,"date",g));d.push(this._createField("ArrivalUTCOffset",a.fields.directions.UTCOffset,"integer",g));d.push(this._createField("Azimuth",a.fields.directions.Azimuth,"double",!0));d.push(this._createField("Name",
a.fields.directions.Name,"string",!0,null,2048));d.push(this._createField("AlternateName",a.fields.directions.AlternativeName,"string",!0,null,2048));d.push(this._createField("ExitName",a.fields.directions.ExitName,"string",!0,null,2048));d.push(this._createField("IntersectingName",a.fields.directions.IntersectingName,"string",!0,null,2048));d.push(this._createField("BranchName",a.fields.directions.BranchName,"string",!0,null,2048));d.push(this._createField("TowardName",a.fields.directions.TowardName,
"string",!0,null,2048));d.push(this._createField("ShortVoiceInstruction",a.fields.directions.VoiceShortText,"string",!0,null,2048));d.push(this._createField("VoiceInstruction",a.fields.directions.VoiceFullText,"string",!0,null,2048));d.push(this._createField("Level",a.fields.directions.Level,"integer",!0));c=0;for(var k=d=!1,m=0;m<e.length;m++){var l=e[m],n=l.geometry;l=l.attributes;n&&l&&(d=d||void 0!==n.m,k=k||void 0!==n.hasZ,l.DirectionPointType=this._itemStringToItemCode(l.DirectionPointType),
h.featureSet.features.push({geometry:p.mixin(n&&n.toJson?n.toJson():n,d?{m:n.m}:{}),attributes:void 0!==l.__OBJECTID?l:p.mixin(l,{__OBJECTID:++c})}))}p.mixin(h.layerDefinition,{extent:f.toJson?f.toJson():f,hasM:d,hasZ:k});e=new P(new R(this.directionPointSymbol));h.layerDefinition.drawingInfo.renderer=e.toJson();h.popupInfo={title:"{DisplayText}",fieldInfos:[{fieldName:"DirectionPointType",label:a.fields.directions.ItemType,isEditable:!1,tooltip:"",visible:!0,stringFieldOption:"textbox"},{fieldName:"DisplayText",
label:a.fields.directions.DisplayText,isEditable:!1,tooltip:"",visible:!0,stringFieldOption:"textbox"},{fieldName:"Sequence",label:a.fields.directions.Sequence,isEditable:!1,tooltip:"",visible:!0,format:{places:0,digitSeparator:!0},stringFieldOption:"textbox"},{fieldName:"StopID",label:a.fields.directions.StopID,isEditable:!1,tooltip:"",visible:!0,format:{places:0,digitSeparator:!0},stringFieldOption:"textbox"},{fieldName:"ArrivalTime",label:a.fields.directions.ArrivalTime,isEditable:!0,tooltip:"",
visible:g,format:{dateFormat:"shortDateShortTime24"},stringFieldOption:"textbox"},{fieldName:"ArrivalUTCOffset",label:a.fields.directions.UTCOffset,isEditable:!1,tooltip:"",visible:g,format:{places:0,digitSeparator:!0},stringFieldOption:"textbox"},{fieldName:"Azimuth",label:a.fields.directions.Azimuth,isEditable:!1,tooltip:"",visible:!1,format:{places:0,digitSeparator:!0},stringFieldOption:"textbox"},{fieldName:"Name",label:a.fields.directions.Name,isEditable:!1,tooltip:"",visible:!0,stringFieldOption:"textbox"},
{fieldName:"AlternateName",label:a.fields.directions.AlternativeName,isEditable:!1,tooltip:"",visible:!0,stringFieldOption:"textbox"},{fieldName:"ExitName",label:a.fields.directions.ExitName,isEditable:!1,tooltip:"",visible:!0,stringFieldOption:"textbox"},{fieldName:"IntersectingName",label:a.fields.directions.IntersectingName,isEditable:!1,tooltip:"",visible:!0,stringFieldOption:"textbox"},{fieldName:"BranchName",label:a.fields.directions.BranchName,isEditable:!1,tooltip:"",visible:!0,stringFieldOption:"textbox"},
{fieldName:"TowardName",label:a.fields.directions.TowardName,isEditable:!1,tooltip:"",visible:!0,stringFieldOption:"textbox"},{fieldName:"ShortVoiceInstruction",label:a.fields.directions.VoiceShortText,isEditable:!1,tooltip:"",visible:!1,stringFieldOption:"textbox"},{fieldName:"VoiceInstruction",label:a.fields.directions.VoiceFullText,isEditable:!1,tooltip:"",visible:!1,stringFieldOption:"textbox"}],description:null,showAttachments:!1,mediaInfos:[]};b.layers.push(h)},_addDirectionLinesToLayerInfo_100:function(b,
a,e,f){a=x.networkAnalysis;var c=a.enums.esriDirectionsLineType,h=this._generateFeatureCollectionTemplate("DirectionLines",a.sharing.directionLinesLayer,"esriGeometryPolyline"),d=h.layerDefinition.fields;d.push(this._createField("DirectionPointID",a.fields.directionLines.DirectionPointID,"integer"));d.push(this._createField("DirectionLineType",a.fields.directionLines.LineType,"integer",!0,{type:"codedValue",name:"esriDirectionsLineType",codedValues:[{name:c.esriDLTUnknown,code:0},{name:c.esriDLTSegment,
code:1},{name:c.esriDLTSegmentManeuver,code:2},{name:c.esriDLTSoftRestrictionViolation,code:3},{name:c.esriDLTBarrier,code:4},{name:c.esriDLTStopAndGoTraffic,code:5},{name:c.esriDLTSlowTraffic,code:6},{name:c.esriDLTModerateTraffic,code:7}]}));d.push(this._createField("Meters",a.fields.directionLines.Meters,"double",!0));d.push(this._createField("Minutes",a.fields.directionLines.Minutes,"double",!0));d.push(this._createField("FromLevel",a.fields.directionLines.LevelFrom,"integer"));d.push(this._createField("ToLevel",
a.fields.directionLines.LevelTo,"integer"));c=0;for(var g=d=!1,k=0;k<e.length;k++){var m=e[k],l=m.geometry;m=m.attributes;l&&m&&(d=d||l.hasM||!1,g=g||l.hasZ||!1,m.DirectionLineType=this._lineTypeStringToLineTypeCode(m.DirectionLineType),h.featureSet.features.push({geometry:l&&l.toJson?l.toJson():l,attributes:void 0!==m.__OBJECTID?m:p.mixin(m,{__OBJECTID:++c})}))}p.mixin(h.layerDefinition,{extent:f.toJson?f.toJson():f,hasM:d,hasZ:g});e=new P(new ca(this.directionLineSymbol));h.layerDefinition.drawingInfo.renderer=
e.toJson();h.popupInfo={title:a.sharing.directionLinesLayer,fieldInfos:[{fieldName:"DirectionLineType",label:a.fields.directionLines.LineType,isEditable:!1,tooltip:"",visible:!0,stringFieldOption:"textbox"},{fieldName:"Meters",label:a.fields.directionLines.Meters,isEditable:!1,tooltip:"",visible:!0,format:{places:2,digitSeparator:!0},stringFieldOption:"textbox"},{fieldName:"Minutes",label:a.fields.directionLines.Minutes,isEditable:!1,tooltip:"",visible:!0,format:{places:2,digitSeparator:!0},stringFieldOption:"textbox"},
{fieldName:"DirectionPointID",label:a.fields.directionLines.DirectionPointID,isEditable:!1,tooltip:"",visible:!0,format:{places:0,digitSeparator:!0},stringFieldOption:"textbox"},{fieldName:"FromLevel",label:a.fields.directionLines.LevelFrom,isEditable:!1,tooltip:"",visible:!1,format:{places:0,digitSeparator:!0},stringFieldOption:"textbox"},{fieldName:"ToLevel",label:a.fields.directionLines.LevelTo,isEditable:!1,tooltip:"",visible:!1,format:{places:0,digitSeparator:!0},stringFieldOption:"textbox"}],
description:null,showAttachments:!1,mediaInfos:[]};b.layers.push(h)},_loadDirectionsFeatureSet_100:function(b,a,e,f,c,h){var d=[],g,k=function(t){for(var q=0;q<a.length;q++)if(a[q].attributes.DirectionSequence==t)return a[q];return null},m=p.hitch(this,function(t){for(var q=[];t<b.length&&0===b[t].attributes.DirectionPointType.indexOf("esriDPTEvent");)q.push({ETA:this.toGeolocalTime(b[t].attributes.ArrivalTime,b[t].attributes.ArrivalUTCOffset),arriveTimeUTC:null===b[t].attributes.ArrivalUTCOffset?
void 0:b[t].attributes.ArrivalTime,strings:b[t].attributes.DisplayText?[{string:b[t].attributes.DisplayText,stringType:"esriDSTGeneral"}]:[],point:{x:b[t].geometry.x,y:b[t].geometry.y}}),t++;return q});for(g=0;g<b.length;g++)if(b[g].attributes.DirectionPointType=this._itemCodeToItemString(b[g].attributes.DirectionPointType),b[g].attributes.StopSequence)for(var l=0;l<e.length;l++)e[l].attributes.Sequence===b[g].attributes.StopSequence&&(b[g]._associatedStopRecord=e[l]);for(g=0;g<b.length;g++)if(e=
b[g].attributes.DirectionPointType,0===e.indexOf("esriDPTManeuver")||"esriDPTUnknown"===e){l=k(b[g].attributes.Sequence);var n=void 0!==b[g].geometry.m;e={attributes:{length:this.fromMeters(l&&l.attributes.Meters||b[g]._associatedStopRecord&&b[g]._associatedStopRecord.attributes.ServiceMeters||0,f),time:this.fromMinutes(l&&l.attributes.Minutes||b[g]._associatedStopRecord&&b[g]._associatedStopRecord.attributes.ServiceMinutes||0,c),text:b[g].attributes.DisplayText,ETA:this.toGeolocalTime(b[g].attributes.ArrivalTime,
b[g].attributes.ArrivalUTCOffset),arriveTimeUTC:null===b[g].attributes.ArrivalUTCOffset?void 0:b[g].attributes.ArrivalTime,maneuverType:this._itemToManeuverType(e),_stopSequence:b[g].attributes.StopSequence},geometry:l?l.geometry:{paths:n?[[[b[g].geometry.x,b[g].geometry.y,b[g].geometry.m],[b[g].geometry.x,b[g].geometry.y,b[g].geometry.m]]]:[[[b[g].geometry.x,b[g].geometry.y],[b[g].geometry.x,b[g].geometry.y]]],hasM:n,spatialReference:h},strings:function(){var t=[],q=b[g].attributes;q.Name&&t.push({string:q.Name,
stringType:"esriDSTStreetName"});q.AlternateName&&t.push({string:q.Name,stringType:"esriDSTAltName"});q.ExitName&&t.push({string:q.Name,stringType:"esriDSTExit"});q.IntersectingName&&t.push({string:q.Name,stringType:"esriDSTCrossStreet"});q.BranchName&&t.push({string:q.Name,stringType:"esriDSTBranch"});q.TowardName&&t.push({string:q.Name,stringType:"esriDSTToward"});return t}(),events:m(b[g].attributes.Sequence)};0===e.strings.length&&delete e.strings;d.push(e)}return d},_generateFeatureCollectionTemplate:function(b,
a,e){return{layerDefinition:{name:b,title:a,geometryType:e,objectIdField:"__OBJECTID",type:"Feature Layer",typeIdField:"",drawingInfo:{fixedSymbols:!0},fields:[{name:"__OBJECTID",alias:"OBJECTID",type:"esriFieldTypeOID",editable:!1,nullable:!1,domain:null}],types:[],capabilities:"Query,Update"},featureSet:{features:[],geometryType:e}}},_createField:function(b,a,e,f,c,h){return"integer"===e?{name:b,alias:a,type:"esriFieldTypeInteger",editable:!0,nullable:!0,visible:!!f,domain:c}:"double"===e?{name:b,
alias:a,type:"esriFieldTypeDouble",editable:!0,nullable:!0,visible:!!f,domain:c}:"date"===e?{name:b,alias:a,type:"esriFieldTypeDate",length:36,editable:!0,nullable:!0,visible:!!f,domain:c}:{name:b,alias:a,type:"esriFieldTypeString",length:h||255,editable:!0,nullable:!0,visible:!!f,domain:c}},_itemToManeuverType:function(b){switch(b){case "esriDPTManeuverArrive":return"esriDMTStop";case "esriDPTManeuverDepart":return"esriDMTDepart";case "esriDPTManeuverDoor":return"esriDMTDoorPassage";case "esriDPTManeuverBearLeft":return"esriDMTBearLeft";
case "esriDPTManeuverBearRight":return"esriDMTBearRight";case "esriDPTManeuverElevator":case "esriDPTManeuverElevatorUp":case "esriDPTManeuverElevatorDown":return"esriDMTElevator";case "esriDPTManeuverEscalator":case "esriDPTManeuverEscalatorDown":case "esriDPTManeuverEscalatorUp":return"esriDMTEscalator";case "esriDPTManeuverFerryOn":return"esriDMTFerry";case "esriDPTManeuverFerryOff":return"esriDMTEndOfFerry";case "esriDPTManeuverForkCenter":return"esriDMTForkCenter";case "esriDPTManeuverForkLeft":return"esriDMTForkLeft";
case "esriDPTManeuverForkRight":return"esriDMTForkRight";case "esriDPTManeuverPedestrianRamp":return"esriDMTPedestrianRamp";case "esriDPTManeuverRampLeft":return"esriDMTRampLeft";case "esriDPTManeuverRampRight":return"esriDMTRampRight";case "esriDPTManeuverRoundabout":case "esriDPTManeuverRoundaboutLeft":case "esriDPTManeuverRoundaboutRight":return"esriDMTRoundabout";case "esriDPTManeuverTurnLeft":return"esriDMTTurnLeft";case "esriDPTManeuverTurnLeftLeft":return"esriDMTLeftLeft";case "esriDPTManeuverTurnLeftRight":return"esriDMTLeftRight";
case "esriDPTManeuverTurnRight":return"esriDMTTurnRight";case "esriDPTManeuverTurnRightLeft":return"esriDMTRightLeft";case "esriDPTManeuverTurnRightRight":return"esriDMTRightRight";case "esriDPTManeuverSharpLeft":return"esriDMTSharpLeft";case "esriDPTManeuverSharpRight":return"esriDMTSharpRight";case "esriDPTManeuverStraight":return"esriDMTStraight";case "esriDPTManeuverStairs":case "esriDPTManeuverStairsUp":case "esriDPTManeuverStairsDown":return"esriDMTStrairs";case "esriDPTManeuverUTurn":case "esriDPTManeuverUTurnLeft":case "esriDPTManeuverUTurnRight":return"esriDMTUTurn"}return"esriDMTUnknown"},
_itemStringToItemCode:function(b){switch(b){case "esriDPTHeader":return 1;case "esriDPTManeuverArrive":return 50;case "esriDPTManeuverDepart":return 51;case "esriDPTManeuverStraight":return 52;case "esriDPTManeuverFerryOn":return 100;case "esriDPTManeuverFerryOff":return 101;case "esriDPTManeuverForkCenter":return 102;case "esriDPTManeuverRoundabout":return 103;case "esriDPTManeuverUTurn":return 104;case "esriDPTManeuverDoor":return 150;case "esriDPTManeuverStairs":return 151;case "esriDPTManeuverElevator":return 152;
case "esriDPTManeuverEscalator":return 153;case "esriDPTManeuverPedestrianRamp":return 154;case "esriDPTManeuverForkLeft":return 200;case "esriDPTManeuverRampLeft":return 201;case "esriDPTManeuverRoundaboutLeft":return 202;case "esriDPTManeuverUTurnLeft":return 203;case "esriDPTManeuverBearLeft":return 204;case "esriDPTManeuverTurnLeft":return 205;case "esriDPTManeuverSharpLeft":return 206;case "esriDPTManeuverTurnLeftLeft":return 207;case "esriDPTManeuverTurnLeftRight":return 208;case "esriDPTManeuverForkRight":return 300;
case "esriDPTManeuverRampRight":return 301;case "esriDPTManeuverRoundaboutRight":return 302;case "esriDPTManeuverUTurnRight":return 303;case "esriDPTManeuverBearRight":return 304;case "esriDPTManeuverTurnRight":return 305;case "esriDPTManeuverSharpRight":return 306;case "esriDPTManeuverTurnRightLeft":return 307;case "esriDPTManeuverTurnRightRight":return 308;case "esriDPTManeuverElevatorUp":return 400;case "esriDPTManeuverEscalatorUp":return 401;case "esriDPTManeuverStairsUp":return 402;case "esriDPTManeuverElevatorDown":return 500;
case "esriDPTManeuverEscalatorDown":return 501;case "esriDPTManeuverStairsDown":return 502;case "esriDPTEvent":return 1E3;case "esriDPTEventLandmark":return 1001;case "esriDPTEventTimeZone":return 1002;case "esriDPTEventTraffic":return 1003;case "esriDPTEventBarrier":return 1004;case "esriDPTEventBoundary":return 1005;case "esriDPTEventRestrictionViolation":return 1006}return 0},_itemCodeToItemString:function(b){switch(b){case 1:return"esriDPTHeader";case 50:return"esriDPTManeuverArrive";case 51:return"esriDPTManeuverDepart";
case 52:return"esriDPTManeuverStraight";case 100:return"esriDPTManeuverFerryOn";case 101:return"esriDPTManeuverFerryOff";case 102:return"esriDPTManeuverForkCenter";case 103:return"esriDPTManeuverRoundabout";case 104:return"esriDPTManeuverUTurn";case 150:return"esriDPTManeuverDoor";case 151:return"esriDPTManeuverStairs";case 152:return"esriDPTManeuverElevator";case 153:return"esriDPTManeuverEscalator";case 154:return"esriDPTManeuverPedestrianRamp";case 200:return"esriDPTManeuverForkLeft";case 201:return"esriDPTManeuverRampLeft";
case 202:return"esriDPTManeuverRoundaboutLeft";case 203:return"esriDPTManeuverUTurnLeft";case 204:return"esriDPTManeuverBearLeft";case 205:return"esriDPTManeuverTurnLeft";case 206:return"esriDPTManeuverSharpLeft";case 207:return"esriDPTManeuverTurnLeftLeft";case 208:return"esriDPTManeuverTurnLeftRight";case 300:return"esriDPTManeuverForkRight";case 301:return"esriDPTManeuverRampRight";case 302:return"esriDPTManeuverRoundaboutRight";case 303:return"esriDPTManeuverUTurnRight";case 304:return"esriDPTManeuverBearRight";
case 305:return"esriDPTManeuverTurnRight";case 306:return"esriDPTManeuverSharpRight";case 307:return"esriDPTManeuverTurnRightLeft";case 308:return"esriDPTManeuverTurnRightRight";case 400:return"esriDPTManeuverElevatorUp";case 401:return"esriDPTManeuverEscalatorUp";case 402:return"esriDPTManeuverStairsUp";case 500:return"esriDPTManeuverElevatorDown";case 501:return"esriDPTManeuverEscalatorDown";case 502:return"esriDPTManeuverStairsDown";case 1E3:return"esriDPTEvent";case 1001:return"esriDPTEventLandmark";
case 1002:return"esriDPTEventTimeZone";case 1003:return"esriDPTEventTraffic";case 1004:return"esriDPTEventBarrier";case 1005:return"esriDPTEventBoundary";case 1006:return"esriDPTEventRestrictionViolation"}return"esriDPTUnknown"},_lineTypeStringToLineTypeCode:function(b){switch(b){case "esriDLTSegment":return 1;case "esriDLTManeuverSegment":return 2;case "esriDLTRestrictionViolation":return 3;case "esriDLTBarrier":return 4;case "esriDLTStopAndGoTraffic":return 5;case "esriDLTSlowTraffic":return 6;
case "esriDLTModerateTraffic":return 7}return 0},_lineTypeCodeToLineTypeString:function(b){switch(b){case 1:return"esriDLTSegment";case 2:return"esriDLTManeuverSegment";case 3:return"esriDLTRestrictionViolation";case 4:return"esriDLTBarrier";case 5:return"esriDLTStopAndGoTraffic";case 6:return"esriDLTSlowTraffic";case 7:return"esriDLTModerateTraffic"}return"esriDLTUnknown"}})});