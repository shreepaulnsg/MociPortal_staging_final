// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/3.38/esri/copyright.txt for details.
//>>built
define("esri/tasks/GeometryService","dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/_base/Deferred dojo/has ../kernel ../request ../deferredUtils ./Task ../geometry/Extent ../geometry/Polyline ../geometry/Polygon ../geometry/Multipoint ../geometry/jsonUtils".split(" "),function(w,n,u,m,p,A,B,q,r,C,y,z,x,D,t){w=w(C,{declaredClass:"esri.tasks.GeometryService",_eventMap:{"areas-and-lengths-complete":["result"],"auto-complete-complete":["geometries"],"buffer-complete":["geometries"],
"convex-hull-complete":["geometry"],"cut-complete":["result"],"densify-complete":["geometries"],"difference-complete":["geometries"],"distance-complete":["distance"],"generalize-complete":["geometries"],"intersect-complete":["geometries"],"label-points-complete":["geometries"],"lengths-complete":["result"],"offset-complete":["geometries"],"project-complete":["geometries"],"relation-complete":["relations"],"reshape-complete":["geometry"],"simplify-complete":["geometries"],"trim-extend-complete":["geometries"],
"union-complete":["geometry"]},constructor:function(a){a=n.hitch;this._projectHandler=a(this,this._projectHandler);this._simplifyHandler=a(this,this._simplifyHandler);this._bufferHandler=a(this,this._bufferHandler);this._areasAndLengthsHandler=a(this,this._areasAndLengthsHandler);this._lengthsHandler=a(this,this._lengthsHandler);this._labelPointsHandler=a(this,this._labelPointsHandler);this._relationHandler=a(this,this._relationHandler);this._convexHullHandler=a(this,this._convexHullHandler);this._unionHandler=
a(this,this._unionHandler);this._autoCompleteHandler=a(this,this._autoCompleteHandler);this._reshapeHandler=a(this,this._reshapeHandler);this._cutHandler=a(this,this._cutHandler);this._intersectHandler=a(this,this._intersectHandler);this._differenceHandler=a(this,this._differenceHandler);this._trimExtendHandler=a(this,this._trimExtendHandler);this._densifyHandler=a(this,this._densifyHandler);this._generalizeHandler=a(this,this._densifyHandler);this._offsetHandler=a(this,this._offsetHandler);this._distanceHandler=
a(this,this._distanceHandler);this._toGeoCoordinateHandler=a(this,this._toGeoCoordinateHandler);this._fromGeoCoordinateHandler=a(this,this._fromGeoCoordinateHandler);this.registerConnectEvents()},_encodeGeometries:function(a){var k=[],e,c=a.length;for(e=0;e<c;e++)k.push(a[e].toJson());return{geometryType:t.getJsonType(a[0]),geometries:k}},_decodeGeometries:function(a,k,e){var c=t.getGeometryType(k);a=a.geometries;var g=[],d={spatialReference:e.toJson()},f=n.mixin;u.forEach(a,function(b,h){g[h]=new c(f(b,
d))});return g},_toProjectGeometry:function(a){var k=a.spatialReference.toJson();return a instanceof y?new x({rings:[[[a.xmin,a.ymin],[a.xmin,a.ymax],[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,a.ymin]]],spatialReference:k}):new z({paths:[[].concat(a.points)],spatialReference:k})},_fromProjectedGeometry:function(a,k,e){return"esriGeometryEnvelope"===k?(a=a.rings[0],new y(a[0][0],a[0][1],a[2][0],a[2][1],e)):new D({points:a.paths[0],spatialReference:e.toJson()})},project:function(a,k,e,c){var g=n.mixin({},
this._url.query,{f:"json"});if(a.geometries){c=e;e=k;k=a.outSR;var d=a.geometries[0];g=n.mixin(g,a.toJson())}else d=a[0],g=n.mixin(g,{outSR:k.wkid||m.toJson(k.toJson()),inSR:d.spatialReference.wkid||m.toJson(d.spatialReference.toJson()),geometries:m.toJson(this._encodeGeometries(a))});var f=t.getJsonType(d),b=this._projectHandler,h=this._errorHandler,l=new p(r._dfdCanceller);l._pendingDfd=q({url:this._url.path+"/project",content:g,callbackParamName:"callback",load:function(v,E){b(v,E,f,k,e,c,l)},
error:function(v){h(v,c,l)}});return l},_projectHandler:function(a,k,e,c,g,d,f){try{var b=this._decodeGeometries(a,e,c);this._successHandler([b],"onProjectComplete",g,f)}catch(h){this._errorHandler(h,d,f)}},onProjectComplete:function(){},simplify:function(a,k,e){var c=a[0].spatialReference,g=n.mixin({},this._url.query,{f:"json",sr:c.wkid?c.wkid:m.toJson(c.toJson()),geometries:m.toJson(this._encodeGeometries(a))}),d=t.getJsonType(a[0]),f=this._simplifyHandler,b=this._errorHandler,h=new p(r._dfdCanceller);
h._pendingDfd=q({url:this._url.path+"/simplify",content:g,callbackParamName:"callback",load:function(l,v){f(l,v,d,c,k,e,h)},error:function(l){b(l,e,h)}});return h},_simplifyHandler:function(a,k,e,c,g,d,f){try{var b=this._decodeGeometries(a,e,c);this._successHandler([b],"onSimplifyComplete",g,f)}catch(h){this._errorHandler(h,d,f)}},onSimplifyComplete:function(){},convexHull:function(a,k,e){var c=a[0].spatialReference;a=n.mixin({},this._url.query,{f:"json",sr:m.toJson(c.toJson()),geometries:m.toJson(this._encodeGeometries(a))});
var g=this._convexHullHandler,d=this._errorHandler,f=new p(r._dfdCanceller);f._pendingDfd=q({url:this._url.path+"/convexHull",content:a,callbackParamName:"callback",load:function(b,h){g(b,h,c,k,e,f)},error:function(b){d(b,e,f)}});return f},_convexHullHandler:function(a,k,e,c,g,d){try{var f=t.fromJson(a.geometry).setSpatialReference(e);this._successHandler([f],"onConvexHullComplete",c,d)}catch(b){this._errorHandler(b,g,d)}},onConvexHullComplete:function(){},union:function(a,k,e){var c=a[0].spatialReference;
a=n.mixin({},this._url.query,{f:"json",sr:m.toJson(c.toJson()),geometries:m.toJson(this._encodeGeometries(a))});var g=this._unionHandler,d=this._errorHandler,f=new p(r._dfdCanceller);f._pendingDfd=q({url:this._url.path+"/union",content:a,callbackParamName:"callback",load:function(b,h){g(b,h,c,k,e,f)},error:function(b){d(b,e,f)}});return f},_unionHandler:function(a,k,e,c,g,d){try{var f=t.fromJson(a.geometry).setSpatialReference(e);this._successHandler([f],"onUnionComplete",c,d)}catch(b){this._errorHandler(b,
g,d)}},onUnionComplete:function(){},autoComplete:function(a,k,e,c){var g=a[0].spatialReference;a=n.mixin({},this._url.query,{f:"json",sr:m.toJson(g.toJson()),polygons:m.toJson(this._encodeGeometries(a).geometries),polylines:m.toJson(this._encodeGeometries(k).geometries)});var d=this._autoCompleteHandler,f=this._errorHandler,b=new p(r._dfdCanceller);b._pendingDfd=q({url:this._url.path+"/autoComplete",content:a,callbackParamName:"callback",load:function(h,l){d(h,l,g,e,c,b)},error:function(h){f(h,c,
b)}});return b},_autoCompleteHandler:function(a,k,e,c,g,d){try{var f=a.geometries;a=[];var b,h=f.length;for(b=0;b<h;b++)a[b]=new x({spatialReference:e,rings:f[b].rings});this._successHandler([a],"onAutoCompleteComplete",c,d)}catch(l){this._errorHandler(l,g,d)}},onAutoCompleteComplete:function(){},reshape:function(a,k,e,c){var g=a.spatialReference;a=n.mixin({},this._url.query,{f:"json",sr:m.toJson(g.toJson()),target:m.toJson({geometryType:t.getJsonType(a),geometry:a.toJson()}),reshaper:m.toJson(k.toJson())});
var d=this._reshapeHandler,f=this._errorHandler,b=new p(r._dfdCanceller);b._pendingDfd=q({url:this._url.path+"/reshape",content:a,callbackParamName:"callback",load:function(h,l){d(h,l,g,e,c,b)},error:function(h){f(h,c,b)}});return b},_reshapeHandler:function(a,k,e,c,g,d){try{var f=t.fromJson(a.geometry).setSpatialReference(e);this._successHandler([f],"onReshapeComplete",c,d)}catch(b){this._errorHandler(b,g,d)}},onReshapeComplete:function(){},cut:function(a,k,e,c){var g=a[0].spatialReference,d=u.map(a,
function(l){return l.toJson()});a=n.mixin({},this._url.query,{f:"json",sr:m.toJson(g.toJson()),target:m.toJson({geometryType:t.getJsonType(a[0]),geometries:d}),cutter:m.toJson(k.toJson())});var f=this._cutHandler,b=this._errorHandler,h=new p(r._dfdCanceller);h._pendingDfd=q({url:this._url.path+"/cut",content:a,callbackParamName:"callback",load:function(l,v){f(l,v,g,e,c,h)},error:function(l){b(l,c,h)}});return h},_cutHandler:function(a,k,e,c,g,d){try{var f=a.geometries,b={};b.cutIndexes=a.cutIndexes;
b.geometries=[];u.forEach(f,function(h){b.geometries.push(t.fromJson(h).setSpatialReference(e))});this._successHandler([b],"onCutComplete",c,d)}catch(h){this._errorHandler(h,g,d)}},onCutComplete:function(){},intersect:function(a,k,e,c){var g=a[0].spatialReference;a=n.mixin({},this._url.query,{f:"json",sr:m.toJson(g.toJson()),geometries:m.toJson(this._encodeGeometries(a)),geometry:m.toJson({geometryType:t.getJsonType(k),geometry:k.toJson()})});var d=this._intersectHandler,f=this._errorHandler,b=new p(r._dfdCanceller);
b._pendingDfd=q({url:this._url.path+"/intersect",content:a,callbackParamName:"callback",load:function(h,l){d(h,l,g,e,c,b)},error:function(h){f(h,c,b)}});return b},_intersectHandler:function(a,k,e,c,g,d){try{var f=[];u.forEach(a.geometries,function(b){f.push(t.fromJson(b).setSpatialReference(e))});this._successHandler([f],"onIntersectComplete",c,d)}catch(b){this._errorHandler(b,g,d)}},onIntersectComplete:function(){},difference:function(a,k,e,c){var g=a[0].spatialReference;a=n.mixin({},this._url.query,
{f:"json",sr:m.toJson(g.toJson()),geometries:m.toJson(this._encodeGeometries(a)),geometry:m.toJson({geometryType:t.getJsonType(k),geometry:k.toJson()})});var d=this._differenceHandler,f=this._errorHandler,b=new p(r._dfdCanceller);b._pendingDfd=q({url:this._url.path+"/difference",content:a,callbackParamName:"callback",load:function(h,l){d(h,l,g,e,c,b)},error:function(h){f(h,c,b)}});return b},_differenceHandler:function(a,k,e,c,g,d){try{var f=[];u.forEach(a.geometries,function(b){f.push(t.fromJson(b).setSpatialReference(e))});
this._successHandler([f],"onDifferenceComplete",c,d)}catch(b){this._errorHandler(b,g,d)}},onDifferenceComplete:function(){},buffer:function(a,k,e){var c=n.mixin({},this._url.query,{f:"json"},a.toJson()),g=a.outSpatialReference||a.geometries[0].spatialReference,d=this._bufferHandler,f=this._errorHandler,b=new p(r._dfdCanceller);b._pendingDfd=q({url:this._url.path+"/buffer",content:c,callbackParamName:"callback",load:function(h,l){d(h,l,g,k,e,b)},error:function(h){f(h,e,b)}});return b},_bufferHandler:function(a,
k,e,c,g,d){try{var f=a.geometries;a=[];var b,h=f.length;for(b=0;b<h;b++)a[b]=new x({spatialReference:e,rings:f[b].rings});this._successHandler([a],"onBufferComplete",c,d)}catch(l){this._errorHandler(l,g,d)}},onBufferComplete:function(){},areasAndLengths:function(a,k,e){a=n.mixin({},this._url.query,{f:"json"},a.toJson());var c=this._areasAndLengthsHandler,g=this._errorHandler,d=new p(r._dfdCanceller);d._pendingDfd=q({url:this._url.path+"/areasAndLengths",content:a,callbackParamName:"callback",load:function(f,
b){c(f,b,k,e,d)},error:function(f){g(f,e,d)}});return d},_areasAndLengthsHandler:function(a,k,e,c,g){try{this._successHandler([a],"onAreasAndLengthsComplete",e,g)}catch(d){this._errorHandler(d,c,g)}},onAreasAndLengthsComplete:function(){},lengths:function(a,k,e){a=n.mixin({},this._url.query,{f:"json"},a.toJson());var c=this._lengthsHandler,g=this._errorHandler,d=new p(r._dfdCanceller);d._pendingDfd=q({url:this._url.path+"/lengths",content:a,callbackParamName:"callback",load:function(f,b){c(f,b,k,
e,d)},error:function(f){g(f,e,d)}});return d},_lengthsHandler:function(a,k,e,c,g){try{this._successHandler([a],"onLengthsComplete",e,g)}catch(d){this._errorHandler(d,c,g)}},onLengthsComplete:function(){},labelPoints:function(a,k,e){var c=u.map(a,function(h){return h.toJson()}),g=a[0].spatialReference;c=n.mixin({},this._url.query,{f:"json",sr:g.wkid?g.wkid:m.toJson(g.toJson()),polygons:m.toJson(c)});var d=this._labelPointsHandler,f=this._errorHandler,b=new p(r._dfdCanceller);b._pendingDfd=q({url:this._url.path+
"/labelPoints",content:c,callbackParamName:"callback",load:function(h,l){d(h,l,a,g,k,e,b)},error:function(h){f(h,e,b)}});return b},_labelPointsHandler:function(a,k,e,c,g,d,f){try{var b=[];u.forEach(a.labelPoints,function(h){b.push(t.fromJson(h).setSpatialReference(c))});this._successHandler([b],"onLabelPointsComplete",g,f)}catch(h){this._errorHandler(h,d,f)}},onLabelPointsComplete:function(){},relation:function(a,k,e){a=n.mixin({},this._url.query,{f:"json"},a.toJson());var c=this._relationHandler,
g=this._errorHandler,d=new p(r._dfdCanceller);d._pendingDfd=q({url:this._url.path+"/relation",content:a,callbackParamName:"callback",load:function(f,b){c(f,b,k,e,d)},error:function(f){g(f,e,d)}});return d},_relationHandler:function(a,k,e,c,g){try{this._successHandler([a.relations],"onRelationComplete",e,g)}catch(d){this._errorHandler(d,c,g)}},onRelationComplete:function(){},trimExtend:function(a,k,e){var c=n.mixin({},this._url.query,{f:"json"},a.toJson()),g=a.sr,d=this._trimExtendHandler,f=this._errorHandler,
b=new p(r._dfdCanceller);b._pendingDfd=q({url:this._url.path+"/trimExtend",content:c,callbackParamName:"callback",load:function(h,l){d(h,l,g,k,e,b)},error:function(h){f(h,e,b)}});return b},_trimExtendHandler:function(a,k,e,c,g,d){try{var f=a.geometries;a=[];var b,h=f.length;for(b=0;b<h;b++)a[b]=new z({spatialReference:e,paths:f[b].paths});this._successHandler([a],"onTrimExtendComplete",c,d)}catch(l){this._errorHandler(l,g,d)}},onTrimExtendComplete:function(){},densify:function(a,k,e){var c=n.mixin({},
this._url.query,{f:"json"},a.toJson()),g=a.geometries[0].spatialReference,d=this._densifyHandler,f=this._errorHandler,b=new p(r._dfdCanceller);b._pendingDfd=q({url:this._url.path+"/densify",content:c,callbackParamName:"callback",load:function(h,l){d(h,l,g,k,e,b)},error:function(h){f(h,e,b)}});return b},_densifyHandler:function(a,k,e,c,g,d){try{var f=[];u.forEach(a.geometries,function(b){f.push(t.fromJson(b).setSpatialReference(e))});this._successHandler([f],"onDensifyComplete",c,d)}catch(b){this._errorHandler(b,
g,d)}},onDensifyComplete:function(){},generalize:function(a,k,e){var c=n.mixin({},this._url.query,{f:"json"},a.toJson()),g=a.geometries[0].spatialReference,d=this._generalizeHandler,f=this._errorHandler,b=new p(r._dfdCanceller);b._pendingDfd=q({url:this._url.path+"/generalize",content:c,callbackParamName:"callback",load:function(h,l){d(h,l,g,k,e,b)},error:function(h){f(h,e,b)}});return b},_generalizeHandler:function(a,k,e,c,g,d){try{var f=[];u.forEach(a.geometries,function(b){f.push(t.fromJson(b).setSpatialReference(e))});
this._successHandler([f],"onGeneralizeComplete",c,d)}catch(b){this._errorHandler(b,g,d)}},onGeneralizeComplete:function(){},offset:function(a,k,e){var c=n.mixin({},this._url.query,{f:"json"},a.toJson()),g=a.geometries[0].spatialReference,d=this._offsetHandler,f=this._errorHandler,b=new p(r._dfdCanceller);b._pendingDfd=q({url:this._url.path+"/offset",content:c,callbackParamName:"callback",load:function(h,l){d(h,l,g,k,e,b)},error:function(h){f(h,e,b)}});return b},_offsetHandler:function(a,k,e,c,g,d){try{var f=
[];u.forEach(a.geometries,function(b){f.push(t.fromJson(b).setSpatialReference(e))});this._successHandler([f],"onOffsetComplete",c,d)}catch(b){this._errorHandler(b,g,d)}},onOffsetComplete:function(){},distance:function(a,k,e){var c=n.mixin({},this._url.query,{f:"json"},a.toJson()),g=a.geometry1.spatialReference,d=this._distanceHandler,f=this._errorHandler,b=new p(r._dfdCanceller);b._pendingDfd=q({url:this._url.path+"/distance",content:c,callbackParamName:"callback",load:function(h,l){d(h,l,g,k,e,
b)},error:function(h){f(h,e,b)}});return b},_distanceHandler:function(a,k,e,c,g,d){try{a=a&&a.distance,this._successHandler([a],"onDistanceComplete",c,d)}catch(f){this._errorHandler(f,g,d)}},onDistanceComplete:function(){},toGeoCoordinateString:function(a,k,e){var c={};n.isObject(a.sr)?c.sr=a.sr.wkid||m.toJson(a.sr.toJson()):c.sr=a.sr;c.coordinates=m.toJson(a.coordinates);c.conversionType=a.conversionType||"MGRS";c.conversionMode=a.conversionMode;c.numOfDigits=a.numOfDigits;c.rounding=a.rounding;
c.addSpaces=a.addSpaces;a=n.mixin({},this._url.query,{f:"json"},c);var g=this._toGeoCoordinateHandler,d=this._errorHandler,f=new p(r._dfdCanceller);f._pendingDfd=q({url:this._url.path+"/toGeoCoordinateString",content:a,callbackParamName:"callback",load:function(b,h){g(b,h,k,e,f)},error:function(b){d(b,e,f)}});return f},_toGeoCoordinateHandler:function(a,k,e,c,g){try{this._successHandler([a.strings],"onToGeoCoordinateStringComplete",e,g)}catch(d){this._errorHandler(d,c,g)}},onToGeoCoordinateStringComplete:function(){},
fromGeoCoordinateString:function(a,k,e){var c={};n.isObject(a.sr)?c.sr=a.sr.wkid||m.toJson(a.sr.toJson()):c.sr=a.sr;c.strings=m.toJson(a.strings);c.conversionType=a.conversionType||"MGRS";c.conversionMode=a.conversionMode;a=n.mixin({},this._url.query,{f:"json"},c);var g=this._fromGeoCoordinateHandler,d=this._errorHandler,f=new p(r._dfdCanceller);f._pendingDfd=q({url:this._url.path+"/fromGeoCoordinateString",content:a,callbackParamName:"callback",load:function(b,h){g(b,h,k,e,f)},error:function(b){d(b,
e,f)}});return f},_fromGeoCoordinateHandler:function(a,k,e,c,g){try{this._successHandler([a.coordinates],"onToGeoCoordinateStringComplete",e,g)}catch(d){this._errorHandler(d,c,g)}},onFromGeoCoordinateStringComplete:function(){}});n.mixin(w,{UNIT_METER:9001,UNIT_GERMAN_METER:9031,UNIT_FOOT:9002,UNIT_SURVEY_FOOT:9003,UNIT_CLARKE_FOOT:9005,UNIT_FATHOM:9014,UNIT_NAUTICAL_MILE:9030,UNIT_SURVEY_CHAIN:9033,UNIT_SURVEY_LINK:9034,UNIT_SURVEY_MILE:9035,UNIT_KILOMETER:9036,UNIT_CLARKE_YARD:9037,UNIT_CLARKE_CHAIN:9038,
UNIT_CLARKE_LINK:9039,UNIT_SEARS_YARD:9040,UNIT_SEARS_FOOT:9041,UNIT_SEARS_CHAIN:9042,UNIT_SEARS_LINK:9043,UNIT_BENOIT_1895A_YARD:9050,UNIT_BENOIT_1895A_FOOT:9051,UNIT_BENOIT_1895A_CHAIN:9052,UNIT_BENOIT_1895A_LINK:9053,UNIT_BENOIT_1895B_YARD:9060,UNIT_BENOIT_1895B_FOOT:9061,UNIT_BENOIT_1895B_CHAIN:9062,UNIT_BENOIT_1895B_LINK:9063,UNIT_INDIAN_FOOT:9080,UNIT_INDIAN_1937_FOOT:9081,UNIT_INDIAN_1962_FOOT:9082,UNIT_INDIAN_1975_FOOT:9083,UNIT_INDIAN_YARD:9084,UNIT_INDIAN_1937_YARD:9085,UNIT_INDIAN_1962_YARD:9086,
UNIT_INDIAN_1975_YARD:9087,UNIT_FOOT_1865:9070,UNIT_RADIAN:9101,UNIT_DEGREE:9102,UNIT_ARCMINUTE:9103,UNIT_ARCSECOND:9104,UNIT_GRAD:9105,UNIT_GON:9106,UNIT_MICRORADIAN:9109,UNIT_ARCMINUTE_CENTESIMAL:9112,UNIT_ARCSECOND_CENTESIMAL:9113,UNIT_MIL6400:9114,UNIT_BRITISH_1936_FOOT:9095,UNIT_GOLDCOAST_FOOT:9094,UNIT_INTERNATIONAL_CHAIN:109003,UNIT_INTERNATIONAL_LINK:109004,UNIT_INTERNATIONAL_YARD:109001,UNIT_STATUTE_MILE:9093,UNIT_SURVEY_YARD:109002,UNIT_50KILOMETER_LENGTH:109030,UNIT_150KILOMETER_LENGTH:109031,
UNIT_DECIMETER:109005,UNIT_CENTIMETER:109006,UNIT_MILLIMETER:109007,UNIT_INTERNATIONAL_INCH:109008,UNIT_US_SURVEY_INCH:109009,UNIT_INTERNATIONAL_ROD:109010,UNIT_US_SURVEY_ROD:109011,UNIT_US_NAUTICAL_MILE:109012,UNIT_UK_NAUTICAL_MILE:109013,UNIT_SQUARE_INCHES:"esriSquareInches",UNIT_SQUARE_FEET:"esriSquareFeet",UNIT_SQUARE_YARDS:"esriSquareYards",UNIT_ACRES:"esriAcres",UNIT_SQUARE_MILES:"esriSquareMiles",UNIT_SQUARE_MILLIMETERS:"esriSquareMillimeters",UNIT_SQUARE_CENTIMETERS:"esriSquareCentimeters",
UNIT_SQUARE_DECIMETERS:"esriSquareDecimeters",UNIT_SQUARE_METERS:"esriSquareMeters",UNIT_ARES:"esriAres",UNIT_HECTARES:"esriHectares",UNIT_SQUARE_KILOMETERS:"esriSquareKilometers"});A("extend-esri")&&n.setObject("tasks.GeometryService",w,B);return w});