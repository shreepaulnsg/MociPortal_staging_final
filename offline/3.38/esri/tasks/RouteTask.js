// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/3.38/esri/copyright.txt for details.
//>>built
define("esri/tasks/RouteTask","dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../graphic ../request ../geometry/normalizeUtils ./Task ./RouteResult ./NAMessage ./NAServiceDescription".split(" "),function(h,p,q,B,C,D,E,F,G,H,I,J){h=h([G,J],{declaredClass:"esri.tasks.RouteTask",_eventMap:{"solve-complete":["result"]},constructor:function(a){this._url.orig=this._url.path;this._url.path+="/solve";this._handler=p.hitch(this,this._handler);this.registerConnectEvents()},__msigns:[{n:"solve",
c:3,a:[{i:0,p:["stops.features","barriers.features","polylineBarriers.features","polygonBarriers.features"]}],e:2}],_handler:function(a,u,n,k,l){try{var e=[],c=[],m=a.directions||[],r=a.routes?a.routes.features:[],v=a.stops?a.stops.features:[],K=a.barriers?a.barriers.features:[],L=a.polygonBarriers?a.polygonBarriers.features:[],M=a.polylineBarriers?a.polylineBarriers.features:[],t=a.messages,f=q.forEach,w=q.indexOf,x=!0,d,y,z=a.routes&&a.routes.spatialReference||a.stops&&a.stops.spatialReference||
a.barriers&&a.barriers.spatialReference||a.polygonBarriers&&a.polygonBarriers.spatialReference||a.polylineBarriers&&a.polylineBarriers.spatialReference;this._chk=a.checksum;f(m,function(b){e.push(d=b.routeName);c[d]={directions:b}});f(r,function(b){-1===w(e,d=b.attributes.Name)&&(e.push(d),c[d]={});c[d].route=b});f(v,function(b){y=b.attributes;-1===w(e,d=y.RouteName||"esri.tasks.RouteTask.NULL_ROUTE_NAME")&&(e.push(d),c[d]={});"esri.tasks.RouteTask.NULL_ROUTE_NAME"!==d&&(x=!1);void 0===c[d].stops&&
(c[d].stops=[]);c[d].stops.push(b)});0<v.length&&!0===x&&(c[e[0]].stops=c["esri.tasks.RouteTask.NULL_ROUTE_NAME"].stops,delete c["esri.tasks.RouteTask.NULL_ROUTE_NAME"],e.splice(q.indexOf(e,"esri.tasks.RouteTask.NULL_ROUTE_NAME"),1));var A=[];f(e,function(b,g){c[b].routeName="esri.tasks.RouteTask.NULL_ROUTE_NAME"===b?null:b;c[b].spatialReference=z;A.push(new H(c[b]))});a=function(b){f(b,function(g,N){g.geometry&&(g.geometry.spatialReference=z);b[N]=new D(g)});return b};f(t,function(b,g){t[g]=new I(b)});
var O={routeResults:A,barriers:a(K),polygonBarriers:a(L),polylineBarriers:a(M),messages:t};this._successHandler([O],"onSolveComplete",n,l)}catch(b){this._errorHandler(b,k,l)}},solve:function(a,u,n,k){var l=k.assembly;a=this._encode(p.mixin({},this._url.query,{f:"json"},a.toJson(l&&l[0]),this._chk?{checksum:this._chk}:{}));var e=this._handler,c=this._errorHandler;return E({url:this._url.path,timeout:25E4,content:a,callbackParamName:"callback",load:function(m,r){e(m,r,u,n,k.dfd)},error:function(m){c(m,
n,k.dfd)}})},onSolveComplete:function(){}});F._createWrappers(h);B("extend-esri")&&p.setObject("tasks.RouteTask",h,C);return h});