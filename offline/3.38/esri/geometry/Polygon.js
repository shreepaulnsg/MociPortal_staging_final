// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/3.38/esri/copyright.txt for details.
//>>built
define("esri/geometry/Polygon","dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/has ../kernel ../lang ../SpatialReference ./Geometry ./Point ./Extent ./mathUtils ../srUtils".split(" "),function(I,v,y,J,w,C,D,K,x,E,z,L){function F(){}function A(){}D={type:"polygon",rings:null};var q=I(K,{declaredClass:"esri.geometry.Polygon",type:"polygon",rings:null,constructor:function(a){this.rings=[];this._ring=0;a&&(y.isArray(a)?this.rings=y.isArray(a[0][0])?a:[a]:a.rings?C.mixin(this,a):this.spatialReference=
a,this.spatialReference&&(this.spatialReference=L.createSpatialReference(this.spatialReference)));this.verifySR()},addRing:function(a){this.clearCache();this._ring=this.rings.length;this.rings[this._ring]=[];y.isArray(a[0])?v.forEach(a,this._addPointArr,this):v.forEach(a,this._addPoint,this);return this},_addPointArr:function(a){this.rings[this._ring].push(a)},_addPoint:function(a){this.rings[this._ring].push([a.x,a.y])},_insertPoints:function(a,b){this.clearCache();this._ring=b;this.rings[this._ring]||
(this.rings[this._ring]=[]);v.forEach(a,this._addPoint,this)},_validateInputs:function(a,b){return null!==a&&void 0!==a&&(0>a||a>=this.rings.length)||null!==b&&void 0!==a&&(0>b||b>=this.rings[a].length)?!1:!0},getPoint:function(a,b){if(this._validateInputs(a,b))return new x(this.rings[a][b],this.spatialReference)},setPoint:function(a,b,c){if(this._validateInputs(a,b))return this.clearCache(),this.rings[a][b]=[c.x,c.y],this},insertPoint:function(a,b,c){if(this._validateInputs(a)&&null!=b&&0<=b&&b<=
this.rings[a].length)return this.clearCache(),this.rings[a].splice(b,0,[c.x,c.y]),this},removeRing:function(a){if(this._validateInputs(a,null)){this.clearCache();a=this.rings.splice(a,1)[0];var b,c=a.length,d=this.spatialReference;for(b=0;b<c;b++)a[b]=new x(a[b],d);return a}},removePoint:function(a,b){if(this._validateInputs(a,b))return this.clearCache(),new x(this.rings[a].splice(b,1)[0],this.spatialReference)},getExtent:function(){var a=this.getCacheValue("_extent");var b=this.getCacheValue("_partwise");
if(a)return a=new E(a),a._partwise=b,a;a=this.rings;var c=a.length;if(c&&a[0].length){var d,g,e,k,h=d=a[0][0][0],f=g=a[0][0][1],l=Math.min,m=Math.max,p=this.spatialReference;b=[];var r,n;for(e=0;e<c;e++){var t=a[e];var G=r=t[0]&&t[0][0];var H=n=t[0]&&t[0][1];var M=t.length;for(k=0;k<M;k++){var u=t[k];var B=u[0];u=u[1];h=l(h,B);f=l(f,u);d=m(d,B);g=m(g,u);G=l(G,B);H=l(H,u);r=m(r,B);n=m(n,u)}b.push(new E({xmin:G,ymin:H,xmax:r,ymax:n,spatialReference:p?p.toJson():null}))}a={xmin:h,ymin:f,xmax:d,ymax:g,
spatialReference:p?p.toJson():null};b=1<b.length?b:null;this.setCacheValue("_extent",a);this.setCacheValue("_partwise",b);a=new E(a);a._partwise=b;return a}},contains:function(a){var b=this.rings,c=!1,d,g,e,k=b.length;var h=this.spatialReference;var f=a.spatialReference;var l=a.x;a=a.y;h&&f&&!h.equals(f)&&h._canProject(f)&&(a=h.isWebMercator()?x.lngLatToXY(l,a):x.xyToLngLat(l,a,!0),l=a[0],a=a[1]);for(e=0;e<k;e++){h=b[e];var m=h.length;for(g=d=0;g<m;g++){d++;d===m&&(d=0);f=h[g];var p=h[d];(f[1]<a&&
p[1]>=a||p[1]<a&&f[1]>=a)&&f[0]+(a-f[1])/(p[1]-f[1])*(p[0]-f[0])<l&&(c=!c)}}return c},getCentroid:function(){var a=this.getCacheValue("_centroid");if(void 0!==a)return a;a=this.rings;var b,c,d=[],g,e,k=Infinity,h=-Infinity,f=Infinity,l=-Infinity;v.forEach(a,function(r){m=b=c=0;v.forEach(r,function(n,t){t<r.length-1&&(g=r[t+1],e=n[0]*g[1]-g[0]*n[1],m+=(n[0]+g[0])*e,b+=(n[1]+g[1])*e,c+=e,n[0]<k&&(k=n[0]),n[0]>h&&(h=n[0]),n[1]<f&&(f=n[1]),n[1]>l&&(l=n[1]))});0<c&&(c*=-1);c&&d.push([m,b,c/2])});d.sort(function(r,
n){return r[2]-n[2]});var m=b=void 0;if(d[0]){var p=6*d[0][2];m=d[0][0]/p;b=d[0][1]/p;if(m<k||m>h||b<f||b>l)m=b=void 0}if(void 0===m||void 0===b)if(a=a[0]&&a[0].length?this._getLineCentroid(a[0]):null)m=a.x,b=a.y;a=isNaN(m)||isNaN(b)?null:new x(m,b,this.spatialReference);this.setCacheValue("_centroid",a);return a},_getLineCentroid:function(a){var b=0,c=0,d=0,g={x:0,y:0},e={x:0,y:0},k,h=a.length,f;for(k=0;k<h-1;k++){var l=a[k];var m=a[k+1];if(l&&m){g.x=l[0];g.y=l[1];e.x=m[0];e.y=m[1];var p=z.getLength(g,
e);0<p&&(b+=p,l=z.getMidpoint(l,m),c+=p*l[0],d+=p*l[1])}}0<b?f={x:c/b,y:d/b}:a[0]&&(f={x:a[0][0],y:a[0][1]});return f},isClockwise:function(a){var b=0,c,d=a.length,g=y.isArray(a[0])?function(e,k){return e[0]*k[1]-k[0]*e[1]}:function(e,k){return e.x*k.y-k.x*e.y};for(c=0;c<d;c++)b+=g(a[c],a[(c+1)%d]);return 0>=b/2},isSelfIntersecting:function(a){a=a||this;var b,c,d,g,e,k=a.rings.length;for(d=0;d<k;d++){for(b=0;b<a.rings[d].length-1;b++){var h=[[a.rings[d][b][0],a.rings[d][b][1]],[a.rings[d][b+1][0],
a.rings[d][b+1][1]]];for(c=d+1;c<k;c++)for(g=0;g<a.rings[c].length-1;g++){var f=[[a.rings[c][g][0],a.rings[c][g][1]],[a.rings[c][g+1][0],a.rings[c][g+1][1]]];if((e=z._getLineIntersection2(h,f))&&!(e[0]===h[0][0]&&e[1]===h[0][1]||e[0]===f[0][0]&&e[1]===f[0][1]||e[0]===h[1][0]&&e[1]===h[1][1]||e[0]===f[1][0]&&e[1]===f[1][1]))return!0}}g=a.rings[d].length;if(!(4>=g))for(b=0;b<g-3;b++){var l=g-1;0===b&&(l=g-2);h=[[a.rings[d][b][0],a.rings[d][b][1]],[a.rings[d][b+1][0],a.rings[d][b+1][1]]];for(c=b+2;c<
l;c++)if(f=[[a.rings[d][c][0],a.rings[d][c][1]],[a.rings[d][c+1][0],a.rings[d][c+1][1]]],(e=z._getLineIntersection2(h,f))&&!(e[0]===h[0][0]&&e[1]===h[0][1]||e[0]===f[0][0]&&e[1]===f[0][1]||e[0]===h[1][0]&&e[1]===h[1][1]||e[0]===f[1][0]&&e[1]===f[1][1]))return!0}}return!1},toJson:function(){var a={rings:C.clone3DArray(this.rings)},b=this.spatialReference;b&&(a.spatialReference=b.toJson());return a}});F.prototype=q.prototype;A.prototype=new F;Object.defineProperty(A.prototype,"rings",{get:function(){this._unquantizeFn&&
(this._ringsVal=this._unquantizeFn({rings:C.clone3DArray(this._ringsVal)}).rings,this._unquantizeFn=null);return this._ringsVal},set:function(a){this._ringsVal=a}});A.prototype.setupLazyUnquantization=function(a,b){this._unquantizeFn=a;this._ringsVal=b.rings};q.simpleConstructor=F;q.accessorConstructor=A;q.defaultProps=D;q.createEllipse=function(a){var b=a.center.x,c=a.center.y,d=a.longAxis,g=a.shortAxis,e=a.numberOfPoints,k=a.map,h;a=[];var f=2*Math.PI/e;for(h=0;h<e;h++){var l=Math.cos(h*f);var m=
Math.sin(h*f);l=k.toMap({x:d*l+b,y:g*m+c});a.push(l)}a.push(a[0]);b=new q(k.spatialReference);b.addRing(a);return b};q.createCircle=function(a){return q.createEllipse({center:a.center,longAxis:a.r,shortAxis:a.r,numberOfPoints:a.numberOfPoints,map:a.map})};q.fromExtent=function(a){var b=a.normalize();a=a.spatialReference;return new q({rings:v.map(b,function(c){return[[c.xmin,c.ymin],[c.xmin,c.ymax],[c.xmax,c.ymax],[c.xmax,c.ymin],[c.xmin,c.ymin]]}),spatialReference:a?a.toJson():null})};J("extend-esri")&&
(y.setObject("geometry.Polygon",q,w),w.geometry.defaultPolygon=D,w.geometry.createEllipse=q.createEllipse,w.geometry.createCircle=q.createCircle,w.geometry.isClockwise=q.prototype.isClockwise,w.geometry.polygonSelfIntersecting=q.prototype.isSelfIntersecting);return q});