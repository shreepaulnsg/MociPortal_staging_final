// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/3.38/esri/copyright.txt for details.
//>>built
var __assign=this&&this.__assign||function(){__assign=Object.assign||function(p){for(var b,h=1,q=arguments.length;h<q;h++){b=arguments[h];for(var l in b)Object.prototype.hasOwnProperty.call(b,l)&&(p[l]=b[l])}return p};return __assign.apply(this,arguments)};
define("esri/arcade/featureset/support/shared",["require","exports","../../polyfill/promiseUtils","../../../geometry/Extent","../../../layers/Field"],function(p,b,h,q,l){function v(a){var c=null;a.domain&&(c="range"===a.domain.type?{type:"range",range:[a.domain.minValue,a.domain.maxValue]}:{type:"codedValue",codedValues:a.domain.toJson().codedValues});return __assign(__assign({name:a.name,type:a.type,alias:a.alias},void 0!==a.length?{length:a.length}:{}),{editable:!0===a.editable,nullable:!0===a.nullable,
domain:c})}function r(a){return a instanceof Date}Object.defineProperty(b,"__esModule",{value:!0});b.stableStringify=b.extractServiceUrl=b.reduceArrayWithPromises=b.toEsriGeometryType=b.layerFieldEsriConstants=b.layerGeometryEsriRestConstants=b.layerGeometryEsriConstants=b.callback=b.errback=b.defaultMaxRecords=b.sameGeomType=b.convertLinearUnitsToCode=b.shapeExtent=b.convertSquareUnitsToCode=b.cloneAttributes=b.equalityTest=b.isDate=b.isArray=b.isNumber=b.isBoolean=b.isString=b.IdState=b.esriFieldToJson=
b.cloneField=b.FeatureServiceDatabaseType=void 0;(function(a){a[a.Standardised=0]="Standardised";a[a.StandardisedNoInterval=1]="StandardisedNoInterval";a[a.SqlServer=2]="SqlServer";a[a.Oracle=3]="Oracle";a[a.Postgres=4]="Postgres";a[a.PGDB=5]="PGDB";a[a.FILEGDB=6]="FILEGDB";a[a.NotEvaluated=7]="NotEvaluated"})(b.FeatureServiceDatabaseType||(b.FeatureServiceDatabaseType={}));b.cloneField=function(a){return new l(v(a))};b.esriFieldToJson=v;(function(a){a[a.InFeatureSet=0]="InFeatureSet";a[a.NotInFeatureSet=
1]="NotInFeatureSet";a[a.Unknown=2]="Unknown"})(b.IdState||(b.IdState={}));b.isString=function(a){return"string"===typeof a||a instanceof String};b.isBoolean=function(a){return"boolean"===typeof a};b.isNumber=function(a){return"number"===typeof a};b.isArray=function(a){return a instanceof Array};b.isDate=r;b.equalityTest=function(a,c){return a===c?!0:r(a)&&r(c)?a.getTime()===c.getTime():!1};b.cloneAttributes=function(a){var c={},g;for(g in a)c[g]=a[g];return c};b.convertSquareUnitsToCode=function(a){if(void 0===
a)return null;if("number"===typeof a)return a;switch(a.toLowerCase()){case "meters":case "meter":return 109404;case "miles":case "mile":return 109413;case "kilometers":case "kilometer":case "km":return 109414}return null};b.shapeExtent=function(a){if(null===a)return null;switch(a.type){case "polygon":case "multipoint":case "polyline":return a.getExtent();case "point":return new q({xmin:a.x,ymin:a.y,xmax:a.x,ymax:a.y,spatialReference:a.spatialReference});case "extent":return a}return null};b.convertLinearUnitsToCode=
function(a){if(void 0===a)return null;if("number"===typeof a||"number"===typeof a)return a;switch(a.toLowerCase()){case "meters":case "meter":return 9001;case "miles":case "mile":return 9035;case "kilometers":case "kilometer":case "km":return 9036}return null};b.sameGeomType=function(a,c){return a===c||"point"===a&&"esriGeometryPoint"===c||"polyline"===a&&"esriGeometryPolyline"===c||"polygon"===a&&"esriGeometryPolygon"===c||"extent"===a&&"esriGeometryEnvelope"===c||"multipoint"===a&&"esriGeometryMultipoint"===
c||"point"===c&&"esriGeometryPoint"===a||"polyline"===c&&"esriGeometryPolyline"===a||"polygon"===c&&"esriGeometryPolygon"===a||"extent"===c&&"esriGeometryEnvelope"===a||"multipoint"===c&&"esriGeometryMultipoint"===a?!0:!1};b.defaultMaxRecords=1E3;b.errback=function(a){return function(c){a.reject(c)}};b.callback=function(a,c){return function(){try{a.apply(null,arguments)}catch(g){c.reject(g)}}};b.layerGeometryEsriConstants={point:"point",polygon:"polygon",polyline:"polyline",multipoint:"multipoint",
extent:"extent",esriGeometryPoint:"point",esriGeometryPolygon:"polygon",esriGeometryPolyline:"polyline",esriGeometryMultipoint:"multipoint",esriGeometryEnvelope:"extent",envelope:"extent"};b.layerGeometryEsriRestConstants={point:"esriGeometryPoint",polygon:"esriGeometryPolygon",polyline:"esriGeometryPolyline",multipoint:"esriGeometryMultipoint",extent:"esriGeometryEnvelope",esriGeometryPoint:"esriGeometryPoint",esriGeometryPolygon:"esriGeometryPolygon",esriGeometryPolyline:"esriGeometryPolyline",
esriGeometryMultipoint:"esriGeometryMultipoint",esriGeometryEnvelope:"esriGeometryEnvelope",envelope:"esriGeometryEnvelope"};b.layerFieldEsriConstants={"small-integer":"esriFieldTypeSmallInteger",integer:"esriFieldTypeInteger","long":"esriFieldTypeLong",single:"esriFieldTypeSingle","double":"esriFieldTypeDouble",string:"esriFieldTypeString",date:"esriFieldTypeDate",oid:"esriFieldTypeOID",geometry:"esriFieldTypeGeometry",blob:"esriFieldTypeBlob",raster:"esriFieldTypeRaster",guid:"esriFieldTypeGUID",
"global-id":"esriFieldTypeGlobalID",xml:"eesriFieldTypeXML",esriFieldTypeSmallInteger:"esriFieldTypeSmallInteger",esriFieldTypeInteger:"esriFieldTypeInteger",esriFieldTypeLong:"esriFieldTypeLong",esriFieldTypeSingle:"esriFieldTypeSingle",esriFieldTypeDouble:"esriFieldTypeDouble",esriFieldTypeString:"esriFieldTypeString",esriFieldTypeDate:"esriFieldTypeDate",esriFieldTypeOID:"esriFieldTypeOID",esriFieldTypeGeometry:"esriFieldTypeGeometry",esriFieldTypeBlob:"esriFieldTypeBlob",esriFieldTypeRaster:"esriFieldTypeRaster",
esriFieldTypeGUID:"esriFieldTypeGUID",esriFieldTypeGlobalID:"esriFieldTypeGlobalID",esriFieldTypeXML:"eesriFieldTypeXML"};b.toEsriGeometryType=function(a){switch(a){case "point":return"esriGeometryPoint";case "polygon":return"esriGeometryPolygon";case "multipoint":return"esriGeometryMultipoint";case "polyline":return"esriGeometryPolyline";default:return"esriGeometryPoint"}};b.reduceArrayWithPromises=function(a,c){return h.create(function(g,n){var m=h.resolve(!0);a.reduce(function(t,d,k,e){return t.then(function(f){try{return c(f,
d,k,e)}catch(u){return h.reject(u)}},function(f){return h.reject(f)})},m).then(g,n)})};b.extractServiceUrl=function(a){if(void 0===a)return"";a=a.replace(/\/featureserver\/[0-9]*/i,"/FeatureServer");a=a.replace(/\/mapserver\/[0-9]*/i,"/MapServer");return a=a.split("?")[0]};b.stableStringify=function(a,c){c||(c={});"function"===typeof c&&(c={cmp:c});var g="boolean"===typeof c.cycles?c.cycles:!1,n=c.cmp&&function(t){return function(d){return function(k,e){return t({key:k,value:d[k]},{key:e,value:d[e]})}}}(c.cmp),
m=[];return function k(d){d&&d.toJson&&"function"===typeof d.toJson&&(d=d.toJson());if(void 0!==d){if("number"===typeof d)return isFinite(d)?""+d:"null";if("object"!==typeof d)return JSON.stringify(d);var e;if(Array.isArray(d)){var f="[";for(e=0;e<d.length;e++)e&&(f+=","),f+=k(d[e])||"null";return f+"]"}if(null===d)return"null";if(-1!==m.indexOf(d)){if(g)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON");}var u=m.push(d)-1,w=Object.keys(d).sort(n&&n(d));
f="";for(e=0;e<w.length;e++){var x=w[e],y=k(d[x]);y&&(f&&(f+=","),f+=JSON.stringify(x)+":"+y)}m.splice(u,1);return"{"+f+"}"}}(a)}});