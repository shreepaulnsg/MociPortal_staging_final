// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/3.38/esri/copyright.txt for details.
//>>built
define("esri/arcade/featureset/support/ArcadeExporter",["require","exports","../../FunctionWrapper","../../languageUtils","../../../geometry/Geometry"],function(z,m,v,h,w){function d(b,a){switch(a.type){case "EmptyStatement":return"";case "VariableDeclarator":var c=null===a.init?null:d(b,a.init);b=n(a.name,b.mangles);return""===c?b:b+" \x3d "+c;case "VariableDeclaration":c=[];for(var e=0;e<a.declarations.length;e++)c.push(d(b,a.declarations[e]));return"var "+c.join(",")+"; ";case "BlockStatement":c=
"{\n";for(e=0;e<a.body.length;e++)c+=d(b,a.body[e])+" \n";return c+"}\n";case "FunctionDeclaration":c="function "+q(a.id.name,b.globalMangles,{});e=[];var f={};f={};for(var g={},p=0,r=a.params;p<r.length;p++){var t=r[p],x=n(t.name,g);e.push(x);f[t.name]=1}c+="("+e.join(",")+") ";return c+=d({functions:b.functions,globals:b.globals,symbols:b.symbols,context:b.context,globalMangles:b.globalMangles,localMangles:g,locals:f},a.body);case "ReturnStatement":return b=null===a.argument?"return;":"return "+
d(b,a.argument)+";\n",b;case "IfStatement":return"if "+d(b,a.test)+" "+d(b,a.consequent)+(null!==a.alternate?"else "+d(b,a.alternate):"");case "ExpressionStatement":return d(b,a.expression)+";";case "AssignmentExpression":return d(b,a.left)+" "+a.operator+" "+d(b,a.right);case "UpdateExpression":return b=!0===a.prefix?a.operator+d(b,a.argument):d(b,a.argument)+a.operator,b;case "BreakStatement":return"break;";case "ContinueStatement":return"continue;";case "ForStatement":return c="for(",null!==a.init&&
(c+=d(b,a.init)),c+=";",c=null!==a.test?c+d(b,a.test):c+" ;",c=null!==a.update?c+d(b,a.update):c+" ;",c=c+") "+(d(b,a.body)+"\n");case "ForInStatement":return"for( "+d(b,a.left)+" in "+d(b,a.right)+") "+d(b,a.body)+"\n";case "Identifier":return y(b,a);case "MemberExpression":return b="true"===a.computed?d(b,a.object)+"["+d(b,a.property)+"]":d(b,a.object)+"."+a.property.name,b;case "Literal":return null===a.value||void 0===a.value?"null":JSON.stringify(a.value);case "ThisExpression":throw Error("NOTSUPPORTED");
case "CallExpression":c=d(b,a.callee)+"(";e=[];f=0;for(a=a.arguments;f<a.length;f++)e.push(d(b,a[f]));return c+=e.join(",")+")";case "UnaryExpression":return b=!0===a.prefix?a.operator+d(b,a.argument):d(b,a.argument)+a.operator,b;case "BinaryExpression":return"("+d(b,a.left)+" "+a.operator+" "+d(b,a.right)+")";case "LogicalExpression":return d(b,a.left)+" "+a.operator+" "+d(b,a.right);case "ConditionalExpression":throw Error("NOTSUPPORTED");case "ArrayExpression":c=[];for(e=0;e<a.elements.length;e++)c.push(d(b,
a.elements[e]));return"["+c.join(",")+"]";case "ObjectExpression":c="{";for(e=0;e<a.properties.length;e++)g=a.properties[e],f="Identifier"===g.key.type?JSON.stringify(g.key.name):d(b,g.key),g=d(b,g.value),c+=f+":"+g;return c+"}";case "Property":throw Error("Not Supported");case "Array":throw Error("NOTSUPPORTED");default:throw Error("UNREOGNISED");}}function y(b,a){var c=a.name.toLowerCase();if(void 0===b.locals[c]){c=b.context.globalScope[c];if(void 0===c)return a.name;if(null!==c){if(c.value instanceof
v)return a=u(c.value,b.functions,b.globals,b.symbols);if(null==c)return a=k(b.symbols),b.globals.push({name:a,type:"null",params:{value:null}}),a;if(c instanceof w)return a=k(b.symbols),b.globals.push({name:a,type:"geometry",params:{value:c}}),a;if(h.isNumber(c))return a=k(b.symbols),b.globals.push({name:a,type:"number",params:{value:c}}),a;if(h.isDate(c))return a=k(b.symbols),b.globals.push({name:a,type:"date",params:{value:h.toDate(c).getTime()}}),a;if(h.isString(c))return a=k(b.symbols),b.globals.push({name:a,
type:"string",params:{value:c}}),a;if(!h.isFeatureSet(c)&&!h.isImmutableArray(c)&&!h.isArray(c))throw Error("Unsupported Type");}}else return q(a.name,b.globalMangles,b.localMangles);return a.name}function k(b){for(var a=!1,c="";!1===a;)c="$gi_"+l.toString(),l++,void 0===b.syms[c]&&(a=!0);return c}function n(b,a){var c="$$fc_"+l.toString();l++;return a[b]=c}function q(b,a,c){return void 0===c[b]?void 0===a[b]?b:a[b]:c[b]}function u(b,a,c,e){c={functions:a,globals:c,symbols:e,context:b.context,locals:{},
globalMangles:{},localMangles:{}};var f=b.definition.id.name;if(void 0!==a.lkp[f])return a.lkp[f].mangledname;e=n(f,c.globalMangles);f={name:f,mangledname:e,script:""};f.script=d(c,b.definition);a.lkp[f.name]=f;a.stack.push(f);return e}Object.defineProperty(m,"__esModule",{value:!0});m.exportFunctionAsArcade=void 0;var l=0;m.exportFunctionAsArcade=u});