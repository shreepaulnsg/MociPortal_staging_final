// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/3.38/esri/copyright.txt for details.
//>>built
define("esri/arcade/arcade","require exports ./arcadeCompiler ./arcadeRuntime ./parser ./treeAnalysis dojo/has ./polyfill/promiseUtils".split(" "),function(t,c,k,p,m,r,u,q){function L(a,b){if(null===f)throw Error("Async Arcade must be enabled for this script");return u("csp-restrictions")||!1===M?function(d){return f.executeScript(a,d)}:k.compileScript(a,b,!0)}function D(a,b){void 0===b&&(b=[]);return m.parseScript(a,b)}function E(a,b){if(!0===b.useAsync||!0===a.isAsync){if(null===f)throw Error("Async Arcade must be enabled for this script");
return f.executeScript(a,b)}return p.executeScript(a,b)}function F(a,b){return p.referencesMember(a,b)}function v(a,b){void 0===b&&(b=[]);void 0===a.usesGeometry&&r.findScriptDependencies(a,b);return!0===a.usesGeometry}function G(){return w?w:w=q.create(function(a,b){t(["../geometry/geometryEngine","./functions/geomsync"],function(d,e){x=!0;e.setGeometryEngine(d);a(!0)},function(d){b(d)})})}function y(){return null!==z?z:z=k.enableAsyncSupport().then(function(){return q.create(function(a,b){t(["./arcadeAsyncRuntime"],
function(d){try{f=d;d=0;for(var e=A;d<e.length;d++){var g=e[d];f.extend(g);k.extend(g,"async")}A=null;a(!0)}catch(n){b(n)}},b)})})}function H(){return f?!0:!1}function I(){return B?B:B=y().then(function(){return q.create(function(a,b){t(["./featureSetUtils","./functions/featuresetbase","./functions/featuresetgeom","./functions/featuresetstats","./functions/featuresetstring"],function(d,e,g,n,h){try{J=d,f.extend([e,g,n,h]),k.extend([e,g,n,h],"async"),C=!0,a(!0)}catch(l){b(l)}},b)})})}function K(a,
b){void 0===b&&(b=[]);void 0===a.usesFeatureSet&&r.findScriptDependencies(a,b);return!0===a.usesFeatureSet}function N(a,b){if(b)for(var d=0;d<b.length;d++)if(F(a,b[d]))return!0;return!1}Object.defineProperty(c,"__esModule",{value:!0});c.featureSetUtils=c.scriptTouchesGeometry=c.loadScriptDependencies=c.scriptIsAsync=c.scriptUsesFeatureSet=c.enableFeatureSetSupport=c.isGeometryEnabled=c.isAsyncEnabled=c.isFeatureSetSupportEnabled=c.enableAsyncSupport=c.enableGeometrySupport=c.scriptUsesGeometryEngine=
c.extractExpectedFieldLiterals=c.extractFieldLiterals=c.referencesFunction=c.referencesMember=c.executeScript=c.parseAndExecuteScript=c.scriptCheck=c.validateScript=c.parseScript=c.extend=c.compileScript=void 0;var O="feature angle bearing centroid envelopeintersects extent geometry isselfintersecting ringisclockwise".split(" "),M=function(){if(u("csp-restrictions"))return!1;try{return(new Function("function* test() {}; return true"))()}catch(a){return!1}}(),C=!1,x=!1,f=null,A=[];c.compileScript=
function(a,b){return!0===b.useAsync||!0===a.isAsync?L(a,b):u("csp-restrictions")?function(d){return p.executeScript(a,d)}:k.compileScript(a,b)};c.extend=function(a){p.extend(a);k.extend(a,"sync");null===f?A.push(a):(k.extend(a,"async"),f.extend(a))};c.parseScript=D;c.validateScript=function(a,b,d){void 0===d&&(d="");return m.validateScript(a,b,d)};c.scriptCheck=function(a,b,d,e){void 0===e&&(e="");return m.scriptCheck(a,b,d,e)};c.parseAndExecuteScript=function(a,b,d){void 0===d&&(d=[]);a=m.parseScript(a,
d);return E(a,b)};c.executeScript=E;c.referencesMember=F;c.referencesFunction=function(a,b){return p.referencesFunction(a,b)};c.extractFieldLiterals=function(a,b){void 0===b&&(b=!1);return m.extractFieldLiterals(a,b)};c.extractExpectedFieldLiterals=function(a){return m.extractExpectedFieldLiterals(a)};c.scriptUsesGeometryEngine=v;var w=null;c.enableGeometrySupport=G;var z=null;c.enableAsyncSupport=y;c.isFeatureSetSupportEnabled=function(){return C};c.isAsyncEnabled=H;c.isGeometryEnabled=function(){return x};
var B=null;c.enableFeatureSetSupport=I;c.scriptUsesFeatureSet=K;c.scriptIsAsync=function(a,b){void 0===b&&(b=[]);void 0===a.isAsync&&r.findScriptDependencies(a,b);return!0===a.isAsync};c.loadScriptDependencies=function(a,b,d,e){void 0===d&&(d=[]);void 0===e&&(e=!1);return q.create(function(g,n){var h="string"===typeof a?D(a):a,l=[];h&&(!1===x&&(v(h)||e)&&l.push(G()),!1===H()&&(!0===h.isAsync||b)&&l.push(y()),!1===C&&(K(h)||N(h,d))&&l.push(I()));l.length?q.all(l).then(function(){g(!0)},n):g(!0)})};
c.scriptTouchesGeometry=function(a){if(v(a))return!0;a=r.findFunctionCalls(a);for(var b=!1,d=0;d<a.length;d++)if(-1<O.indexOf(a[d])){b=!0;break}return b};var J=null;c.featureSetUtils=function(){return J}});