// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/3.38/esri/copyright.txt for details.
//>>built
define("esri/arcade/polyfill/promiseUtils",["require","exports","dojo/Deferred","dojo/promise/all"],function(w,c,m,t){function h(a,b){var e=new m(b);a(function(d){return u(d).then(e.resolve)},e.reject);return e.promise}function p(a){if(a){if("function"!==typeof a.forEach){var b=Object.keys(a),e=b.map(function(f){return a[f]});return p(e).then(function(f){var g={};b.forEach(function(k,l){return g[k]=f[l]});return g})}var d=null;return h(function(f,g){var k=[],l=a.length;0===l&&f(k);a.forEach(function(v){var q=
{promise:v};k.push(q);v.then(function(r){q.value=r}).catch(function(r){q.error=r}).then(function(){--l;0===l&&(d?g(Error("AbortError")):f(k))})})},function(f){d=f||"Invocation cancellation";a.forEach(function(g){return g.cancel(f)})})}}function n(a){void 0===a&&(a=void 0);var b=new m;b.resolve(a);return b.promise}function u(a){return a&&"function"===typeof a.then?a:n(a)}Object.defineProperty(c,"__esModule",{value:!0});c.createResolver=c.when=c.isPromiseLike=c.wrapCallback=c.timeout=c.after=c.resolve=
c.reject=c.first=c.eachAlwaysValues=c.eachAlways=c.createDeferred=c.create=c.filter=c.all=void 0;c.all=function(a){return t(a)};c.filter=function(a,b){var e=a.slice();return t(a.map(function(d,f){return b(d,f)})).then(function(d){return e.filter(function(f,g){return d[g]})})};c.create=h;c.createDeferred=function(a){var b=null;a=h(function(e,d){b={resolve:e,reject:d}},a);b.promise=a;b.cancel=function(){b.reject(Error("AbortError"))};return b};c.eachAlways=p;c.eachAlwaysValues=function(a){return p(a).then(function(b){return b.filter(function(e){return!!e.value}).map(function(e){return e.value})})};
c.first=function(a){return a&&a.length?h(function(b,e){for(var d=0;d<a.length;d++)a[d].then(b,e)}):n()};c.reject=function(a){var b=new m;b.reject(a);return b.promise};c.resolve=n;c.after=function(a,b){void 0===b&&(b=void 0);var e=0;return h(function(d){e=setTimeout(function(){d(b)},a)},function(){e&&(clearTimeout(e),e=0)})};c.timeout=function(a,b,e){var d=0,f=new m(a.cancel);a.then(function(g){f.isFulfilled()||(f.resolve(g),d&&(clearTimeout(d),d=0))});a.catch(function(g){f.isFulfilled()||(f.reject(g),
d&&(clearTimeout(d),d=0))});d=setTimeout(function(){f.reject(e||Error("promiseUtils:timeout"))},b);return f.promise};c.wrapCallback=function(a){var b=!1;return h(function(){a(function(e){b||n(e)})},function(){return b=!0})};c.isPromiseLike=function(a){return a&&"function"===typeof a.then};c.when=u;c.createResolver=function(a){var b,e;a=h(function(f,g){b=f;e=g},a);var d=function(f){b(f)};d.resolve=function(f){return b(f)};d.reject=function(f){return e(f)};d.promise=a;return d}});