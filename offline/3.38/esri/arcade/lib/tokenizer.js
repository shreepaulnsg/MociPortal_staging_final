// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/3.38/esri/copyright.txt for details.
//>>built
var __spreadArray=this&&this.__spreadArray||function(e,f){for(var h=0,g=f.length,l=e.length;h<g;h++,l++)e[l]=f[h];return e};
define("esri/arcade/lib/tokenizer","require exports ./error-handler ./nodes ./scanner ./token".split(" "),function(e,f,h,g,l,m){Object.defineProperty(f,"__esModule",{value:!0});f.Tokenizer=void 0;var n=function(){function d(){this.values=[];this.curly=this.paren=-1}d.prototype.beforeFunctionExpression=function(b){return 0<=__spreadArray(__spreadArray(__spreadArray(__spreadArray(["(","{","[","return",","],g.AssignmentOperators),g.BinaryOperators),g.LogicalOperators),g.UnaryOperators).indexOf(b)};d.prototype.isRegexStart=
function(){var b=this.values[this.values.length-1],a=null!==b;switch(b){case "this":case "]":a=!1;break;case ")":b=this.values[this.paren-1];a="if"===b||"while"===b||"for"===b||"with"===b;break;case "}":a=!0,"function"===this.values[this.curly-3]?a=(b=this.values[this.curly-4])?!this.beforeFunctionExpression(b):!1:"function"===this.values[this.curly-4]&&(a=(b=this.values[this.curly-5])?!this.beforeFunctionExpression(b):!0)}return a};d.prototype.push=function(b){7===b.type||4===b.type?("{"===b.value?
this.curly=this.values.length:"("===b.value&&(this.paren=this.values.length),this.values.push(b.value)):this.values.push(null)};return d}();e=function(){function d(b,a){this.errorHandler=new h.ErrorHandler;this.errorHandler.tolerant=a?"boolean"===typeof a.tolerant&&a.tolerant:!1;this.scanner=new l.Scanner(b,this.errorHandler);this.scanner.trackComment=a?"boolean"===typeof a.comment&&a.comment:!1;this.trackRange=a?"boolean"===typeof a.range&&a.range:!1;this.trackLoc=a?"boolean"===typeof a.loc&&a.loc:
!1;this.buffer=[];this.reader=new n}d.prototype.errors=function(){return this.errorHandler.errors};d.prototype.getNextToken=function(){if(0===this.buffer.length){var b=this.scanner.scanComments();if(b)for(var a=0;a<b.length;++a){var c=b[a],k=this.scanner.source.slice(c.slice[0],c.slice[1]);k={type:c.multiLine?"BlockComment":"LineComment",value:k};this.trackRange&&(k.range=c.range);this.trackLoc&&(k.loc=c.loc);this.buffer.push(k)}if(!this.scanner.eof()){b=null;this.trackLoc&&(b={start:{line:this.scanner.lineNumber,
column:this.scanner.index-this.scanner.lineStart},end:{line:0,column:0}});a=void 0;if("/"===this.scanner.source[this.scanner.index]&&this.reader.isRegexStart()){c=this.scanner.saveState();try{a=this.scanner.scanRegExp()}catch(p){this.scanner.restoreState(c),a=this.scanner.lex()}}else a=this.scanner.lex();this.reader.push(a);c={type:m.TokenName[a.type],value:this.scanner.source.slice(a.start,a.end)};this.trackRange&&(c.range=[a.start,a.end]);this.trackLoc&&b&&(b.end={line:this.scanner.lineNumber,column:this.scanner.index-
this.scanner.lineStart},c.loc=b);9===a.type&&(c.regex={pattern:a.pattern,flags:a.flags});this.buffer.push(c)}}return this.buffer.shift()};return d}();f.Tokenizer=e});