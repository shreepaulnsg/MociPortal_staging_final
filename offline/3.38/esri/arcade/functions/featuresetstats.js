// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/3.38/esri/copyright.txt for details.
//>>built
define("esri/arcade/functions/featuresetstats","require exports ../languageUtils ./fieldStats ../polyfill/promiseUtils ../polyfill/sql/WhereClause".split(" "),function(u,q,g,n,h,r){function k(b,d,f,a,e,c){if(1===a.length){if(g.isArray(a[0]))return h.resolve(n.calculateStat(b,a[0],g.defaultUndefined(a[1],-1)));if(g.isImmutableArray(a[0]))return h.resolve(n.calculateStat(b,a[0].toArray(),g.defaultUndefined(a[1],-1)))}else if(2===a.length){if(g.isArray(a[0]))return h.resolve(n.calculateStat(b,a[0],g.defaultUndefined(a[1],
-1)));if(g.isImmutableArray(a[0]))return h.resolve(n.calculateStat(b,a[0].toArray(),g.defaultUndefined(a[1],-1)));if(g.isFeatureSet(a[0]))return a[0].load().then(function(l){return t(r.WhereClause.create(a[1],l.getFieldsIndex()),c,e).then(function(m){return a[0].calculateStatistic(b,m,g.defaultUndefined(a[2],1E3),d.abortSignal)})})}else if(3===a.length&&g.isFeatureSet(a[0]))return a[0].load().then(function(l){return t(r.WhereClause.create(a[1],l.getFieldsIndex()),c,e).then(function(m){return a[0].calculateStatistic(b,
m,g.defaultUndefined(a[2],1E3),d.abortSignal)})});return h.resolve(n.calculateStat(b,a,-1))}function t(b,d,f){try{var a=b.getVariables();if(0<a.length){for(var e=[],c=0;c<a.length;c++)e.push(d.evaluateIdentifier(f,{name:a[c]}));return h.all(e).then(function(l){for(var m={},p=0;p<a.length;p++)m[a[p]]=l[p];b.parameters=m;return b})}return h.resolve(b)}catch(l){return h.reject(l)}}Object.defineProperty(q,"__esModule",{value:!0});q.registerFunctions=void 0;q.registerFunctions=function(b){"async"===b.mode&&
(b.functions.stdev=function(d,f){return b.standardFunctionAsync(d,f,function(a,e,c){return k("stdev",a,e,c,d,b)})},b.functions.variance=function(d,f){return b.standardFunctionAsync(d,f,function(a,e,c){return k("variance",a,e,c,d,b)})},b.functions.average=function(d,f){return b.standardFunctionAsync(d,f,function(a,e,c){return k("mean",a,e,c,d,b)})},b.functions.mean=function(d,f){return b.standardFunctionAsync(d,f,function(a,e,c){return k("mean",a,e,c,d,b)})},b.functions.sum=function(d,f){return b.standardFunctionAsync(d,
f,function(a,e,c){return k("sum",a,e,c,d,b)})},b.functions.min=function(d,f){return b.standardFunctionAsync(d,f,function(a,e,c){return k("min",a,e,c,d,b)})},b.functions.max=function(d,f){return b.standardFunctionAsync(d,f,function(a,e,c){return k("max",a,e,c,d,b)})},b.functions.count=function(d,f){return b.standardFunctionAsync(d,f,function(a,e,c){g.pcCheck(c,1,1);if(g.isFeatureSet(c[0]))return c[0].count(a.abortSignal);if(g.isArray(c[0])||g.isString(c[0]))return c[0].length;if(g.isImmutableArray(c[0]))return c[0].length();
throw Error("Invalid Parameters for Count");})})}});