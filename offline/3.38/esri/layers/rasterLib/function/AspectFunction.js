// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/3.38/esri/copyright.txt for details.
//>>built
define("esri/layers/rasterLib/function/AspectFunction","dojo/_base/declare dojo/_base/lang ./RasterFunctionX ../../../WKIDUnitConversion ../../PixelBlock ./pixelShaders ./RasterFunctionWebGLMixin ./surfaceUtils".split(" "),function(f,g,h,p,q,k,l,m){return f([h,l],{declaredClass:"esri.layers.rasterLib.function.AspectFunction",functionName:"Aspect",supportWebGL:!0,support2D:!0,constructor:function(a){this.functionArguments=this.mixinIgnoreCase({raster:null},a)},bind:function(){var a=this.getSourceRasterInfo();
if(!a.raster)return Error("The raster input to aspect function is invalid.");this.rasterInfo=g.mixin(a.raster,{bandCount:1,pixelType:this._calculatePixelType(this.pixelType,"F32"),statistics:[{min:0,max:360}],histograms:null});this.rasterInfo.keyProperties=this.rasterInfo.keyProperties||{};this.rasterInfo.keyProperties.DataType="Generic";return!0},read2D:function(a){this._performance.start();a=m.aspect(a.raster);this._addPerformanceMetric(this._performance.elapsed());return a},readGL:function(a){this._performance.start();
this._initializeProgram({fragment:k.aspect,fragmentName:"Aspect"});var d=this._setupTextureData(a.raster),n=this.bindFrameBuffer(),b=this.gl,e=b.drawingBufferWidth;b=b.drawingBufferHeight;var c=d.extent;this._setUniforms({u_resolution:a&&a.raster&&a.raster.pixelBlock?[1/a.raster.pixelBlock.width,1/a.raster.pixelBlock.height]:[1/e,1/b],u_cellSize:[(c.xmax-c.xmin)/e,(c.ymax-c.ymin)/b]});this._bindTexture(d.texture,"u_image");this._drawGL();this._addPerformanceMetric(this._performance.elapsed());return{extent:d.extent,
texture:n.texture}}})});