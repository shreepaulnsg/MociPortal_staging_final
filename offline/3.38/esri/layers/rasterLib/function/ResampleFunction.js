// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/3.38/esri/copyright.txt for details.
//>>built
define("esri/layers/rasterLib/function/ResampleFunction",["dojo/_base/declare","dojo/_base/lang","./pixelShaders","./RasterFunctionX","./RasterFunctionWebGLMixin"],function(f,g,h,k,l){return f([k,l],{declaredClass:"esri.layers.rasterLib.function.ResampleFunction",renderTexture:!0,resamplingOrigin:null,resamplingRatio:null,zFactor:1,functionName:"Resample",supportWebGL:!0,support2D:!1,constructor:function(a){this.functionArguments=this.mixinIgnoreCase({resamplingType:0},a)},bind:function(a){a=this.getSourceRasterInfo(a);
if(!a.raster)return Error("The raster input to convolution function is invalid.");this.rasterInfo=g.mixin(a.raster,{bandCount:a.raster.bandCount,pixelType:this._calculatePixelType(this.pixelType,a.raster.pixelType),statistics:a.raster.statistics,histograms:a.raster.histograms});this.rasterInfo.keyProperties=this.rasterInfo.keyProperties||{};return!0},readGL:function(a){this._performance.start();this._initializeProgram({fragment:h.resample,fragmentName:"Resample"});var d=this._setupTextureData(a.raster),
m=this.bindFrameBuffer(),c=this.gl,e=c.drawingBufferWidth;c=c.drawingBufferHeight;var b=a.raster;void 0!==b.pixelBlock?(d=d||this._setupTextureData(b),a=b.pixelBlock.width,b=b.pixelBlock.height):(d=d||b,a=e,b=c);this._setUniforms({u_resamplingRatio:this.resamplingRatio||[a/e,b/c],u_anchor:this.resamplingOrigin||[0,1],u_resamplingType:this.functionArguments.resamplingType,u_resolution:[1/e,1/c]});this._drawGL();this._addPerformanceMetric(this._performance.elapsed());return{extent:d.extent,texture:m.texture}}})});