// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/3.38/esri/copyright.txt for details.
//>>built
define("esri/layers/vectorTiles/views/webgl/BufferObject",["require","exports","dojo/has"],function(m,n,l){return function(){function c(a,b,d,e,f){this._glName=this._context=null;this._bufferType=void 0;this._usage=35044;this._size=-1;this._indexType=void 0;this._context=a;this._bufferType=b;this._usage=d;this._id=c._nextId++;this._glName=this._context.gl.createBuffer();l("esri-webgl-debug")&&a.instanceCounter.incrementCount(1);e&&this.setData(e,f)}c.createIndex=function(a,b,d,e){return new c(a,34963,
b,d,e)};c.createVertex=function(a,b,d){return new c(a,34962,b,d)};Object.defineProperty(c.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"glName",{get:function(){return this._glName},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"usage",{get:function(){return this._usage},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,
"bufferType",{get:function(){return this._bufferType},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"indexType",{get:function(){return this._indexType},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"byteSize",{get:function(){return 34962===this._bufferType?this._size:5125===this._indexType?4*this._size:2*this._size},enumerable:!0,configurable:!0});c.prototype.dispose=function(){this._context&&(this._glName&&(this._context.gl.deleteBuffer(this._glName),this._glName=
null),l("esri-webgl-debug")&&this._context.instanceCounter.decrementCount(1),this._context=null)};c.prototype.setData=function(a,b){if(a){if("number"===typeof a){if(0>a&&console.error("Buffer size cannot be negative!"),34963===this._bufferType&&b)switch(this._indexType=b,this._size=a,b){case 5123:a*=2;break;case 5125:a*=4}}else b=a.byteLength,a instanceof Uint16Array&&(b/=2,this._indexType=5123),a instanceof Uint32Array&&(b/=4,this._indexType=5125),this._size=b,ArrayBuffer.isView(a)&&(a=a.buffer);
b=this._context.getBoundVAO();this._context.bindVAO(null);this._context.bindBuffer(this);this._context.gl.bufferData(this._bufferType,a,this._usage);this._context.bindVAO(b)}};c.prototype.setSubData=function(a,b,d,e){void 0===b&&(b=0);void 0===d&&(d=0);if(a){(0>b||b>=this._size)&&console.error("offset is out of range!");var f=b,g=d,h=e,k=a.byteLength;a instanceof Uint16Array&&(k/=2,f*=2,g*=2,h*=2);a instanceof Uint32Array&&(k/=4,f*=4,g*=4,h*=4);void 0===e&&(e=k-1);d>=e&&console.error("end must be bigger than start!");
b+d-e>this._size&&console.error("An attempt to write beyond the end of the buffer!");b=this._context.getBoundVAO();this._context.bindVAO(null);this._context.bindBuffer(this);d=this._context.gl;a=ArrayBuffer.isView(a)?a.buffer:a;d.bufferSubData(this._bufferType,f,a.slice(g,h));this._context.bindVAO(b)}};c._nextId=0;return c}()});