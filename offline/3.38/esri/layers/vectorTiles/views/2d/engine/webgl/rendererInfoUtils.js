// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/3.38/esri/copyright.txt for details.
//>>built
define("esri/layers/vectorTiles/views/2d/engine/webgl/rendererInfoUtils","require exports ../../../../core/tsSupport/assignHelper ../../../../Graphic ../../../../arcade/Feature ../../../../support/arcadeUtils ./enums ./visualVariablesUtils".split(" "),function(F,k,u,y,z,h,A,v){function w(a,c,d){if(!a)return null;var l=0,e={};a=a.clone();var f=a.visualVariables,m=null;if("simple"!==a.type){var n=a.valueExpression;if(!a.field&&n){var r="$$fake"+l++,B=h.createFunction(n);e[r]=function(b,g){t.repurposeFromGraphicLikeObject(b.geometry,
b.attributes,d);return h.executeFunction(B,{vars:{$feature:t,$view:h.getViewInfo(g)},spatialReference:c})};a.field=r;a.valueExpression=null;m=function(b,g){g.attributes[r]=e[r](g);return b.valueExpression?b.getSymbol(y.fromJSON(g)):b.getSymbol(g)}}}f&&(a.visualVariables=f.map(function(b){if(b.normalizationField){var g=b.field,C=b.normalizationField,p="$$fake"+l++;e[p]=function(q,x){return q.attributes[g]/q.attributes[C]};b=u({},b);b.field=p;delete b.normalizationField;return b}if(b.valueExpression&&
"$view.scale"!==b.valueExpression){var D=b.valueExpression;p="$$fake"+l++;var E=h.createFunction(D);e[p]=function(q,x){t.repurposeFromGraphicLikeObject(q.geometry,q.attributes,d);return h.executeFunction(E,{vars:{$feature:t,$view:h.getViewInfo(x)},spatialReference:c})};b=u({},b);b.field=p;delete b.valueExpression;return b}return b}));return{renderer:a,normalizingFunctions:e,getSymbolFunction:m}}Object.defineProperty(k,"__esModule",{value:!0});var t=new z;k.createRendererInfo=function(a,c,d){var l=
(c=w(a,c,d)||{renderer:null,normalizingFunctions:null,getSymbolFunction:null},c.normalizingFunctions),e=c&&c.getSymbolFunction;a=c&&c.renderer||a;c=v.convertVisualVariables(a.visualVariables);return{renderer:a,vvFields:c.vvFields,vvRanges:c.vvRanges,getValue:function(f,m){var n=l[m];return n?n(f):f.attributes[m]},getSymbol:function(f){return e?e(this.renderer,f):this.renderer.getSymbol?this.renderer.getSymbol.call(this.renderer,f):null}}};k.getNormalizedRenderer=function(a,c,d){return(c=w(a,c,d)||
{renderer:null,normalizingFunctions:null,getSymbolFunction:null},c.renderer)||a};k.getSymbol=function(a,c){return a.getSymbol(c)};k.isRendererWebGLCompatible=function(a){if(!a||-1===["simple","class-breaks","unique-value","heatmap"].indexOf(a.type))return!1;if(a.visualVariables){var c=0;for(a=a.visualVariables;c<a.length;c++){var d=a[c];switch(d.type){case "color":case "opacity":if(d.stops&&8<d.stops.length)return!1;break;case "size":if(v.getTypeOfSizeVisualVariable(d)===A.WGLVVFlag.SIZE_FIELD_STOPS&&
d.stops&&6<d.stops.length)return!1}}}return!0}});