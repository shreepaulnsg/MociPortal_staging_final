// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/3.38/esri/copyright.txt for details.
//>>built
define("esri/layers/vectorTiles/views/2d/engine/webgl/brushes/WGLGeometryBrushFill","require exports ../../../../../core/tsSupport/extendsHelper ../enums ../Utils ./WGLGeometryBrush ../../../../webgl/VertexArrayObject".split(" "),function(n,p,t,u,v,w,q){Object.defineProperty(p,"__esModule",{value:!0});n=function(m){function f(){var a=null!==m&&m.apply(this,arguments)||this;a._isInitialized=!1;a._fillAttributeLocations={a_pos:0,a_id:1,a_color:2,a_tlbr:3,a_aux:4};a._fillAttributeLocationsVV={a_pos:0,
a_id:1,a_color:2,a_tlbr:3,a_aux:4,a_vv:5};a._spritesTextureSize=new Float32Array(2);return a}t(f,m);f.prototype.dispose=function(){};f.prototype.getGeometryType=function(){return u.WGLGeometryType.FILL};f.prototype.drawGeometry=function(a,d,b,e){e=a.context;var g=a.painter,k=a.rendererInfo,x=a.requiredLevel,y=a.stationary,z=b.indexCount,A=b.indexFrom;this._initialize();var l=b.materialInfo.materialKeyInfo,c=l.hasVV()?this._fillAttributeLocationsVV:this._fillAttributeLocations;if(c=a.painter.materialManager.getProgram(b.materialInfo.materialKey,
a.drawPhase,c)){e.bindProgram(c);var h=this._getVAO(e,d,l.hasVV());e.bindVAO(h);if(0<b.materialInfo.texBindingInfo.length){b=b.materialInfo.texBindingInfo[0];h=b.pageId;var r=a.painter.textureManager.sprites;this._spritesTextureSize[0]=r.getWidth(h);this._spritesTextureSize[1]=r.getHeight(h);c.setUniform1f("u_zoomFactor",1/Math.pow(2,x-d.key.level)/a.pixelRatio);g.textureManager.bindSpritePage(e,h,b.unit,y?9728:9729);c.setUniform1i(b.semantic,b.unit);c.setUniform2fv("u_mosaicSize",this._spritesTextureSize)}c.setUniformMatrix4fv("u_transformMatrix",
d.tileTransform.transform);c.setUniform2fv("u_normalized_origin",d.tileTransform.displayCoord);c.setUniform1f("u_opacity",1);l.vvColor&&(c.setUniform1fv("u_vvColorValues",k.vvColorValues),c.setUniform4fv("u_vvColors",k.vvColors));l.vvOpacity&&(c.setUniform1fv("u_vvOpacityValues",k.vvOpacityValues),c.setUniform1fv("u_vvOpacities",k.vvOpacities));e.drawElements(4,z,5125,4*A);e.bindVAO(null)}};f.prototype._initialize=function(){if(this._isInitialized)return!0;this._fillVertexAttributeLayout={geometry:[{name:"a_pos",
count:2,type:5122,offset:0,stride:24,normalized:!1,divisor:0},{name:"a_id",count:4,type:5121,offset:4,stride:24,normalized:!0,divisor:0},{name:"a_color",count:4,type:5121,offset:8,stride:24,normalized:!0,divisor:0},{name:"a_tlbr",count:4,type:5123,offset:12,stride:24,normalized:!1,divisor:0},{name:"a_aux",count:4,type:5121,offset:20,stride:24,normalized:!1,divisor:0}]};this._fillVertexAttributeLayoutVV={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:32,normalized:!1,divisor:0},{name:"a_id",
count:4,type:5121,offset:4,stride:32,normalized:!0,divisor:0},{name:"a_color",count:4,type:5121,offset:8,stride:32,normalized:!0,divisor:0},{name:"a_tlbr",count:4,type:5123,offset:12,stride:32,normalized:!1,divisor:0},{name:"a_aux",count:4,type:5121,offset:20,stride:32,normalized:!1,divisor:0},{name:"a_vv",count:2,type:5126,offset:24,stride:32,normalized:!1,divisor:0}]};this._isInitialized=!0};f.prototype._getVAO=function(a,d,b){if(d.fillGeometry.vao)return d.fillGeometry.vao;var e=d.fillGeometry.vertexBufferMap[v.C_VBO_GEOMETRY],
g=d.fillGeometry.indexBuffer;if(!e||!g)return null;d.fillGeometry.vao=b?new q(a,this._fillAttributeLocationsVV,this._fillVertexAttributeLayoutVV,{geometry:e},g):new q(a,this._fillAttributeLocations,this._fillVertexAttributeLayout,{geometry:e},g);return d.fillGeometry.vao};return f}(w.default);p.default=n});