// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/3.38/esri/copyright.txt for details.
//>>built
define("esri/layers/vectorTiles/views/2d/engine/webgl/WGLDisplayRecord",["require","exports","../../../../core/Logger","./MeshData"],function(q,r,n,m){var p=n.getLogger("esri/views/2d/engine/webgl/WGLDisplayRecord");return function(){function g(a,b,f){this.id=a;this.geometryType=b;this._materialInfo=f;this.meshData=null;this.indexCount=this.indexFrom=this.vertexCount=this.vertexFrom=this.zOrder=this.symbolLevel=0}Object.defineProperty(g.prototype,"sortKey",{get:function(){void 0===this._sortKey&&
this._computeSortKey();return this._sortKey},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"materialInfo",{get:function(){return"number"===typeof this._materialInfo?(p.warn("Tried to read materialInfo, but found an index! Was materialInfo deserialized correctly?"),null):this._materialInfo},set:function(a){this._materialInfo=a},enumerable:!0,configurable:!0});g.prototype.copy=function(){var a=new g(this.id,this.geometryType,this._materialInfo);a.vertexFrom=this.vertexFrom;a.vertexCount=
this.vertexCount;a.indexFrom=this.indexFrom;a.indexCount=this.indexCount;a.zOrder=this.zOrder;a.symbolLevel=this.symbolLevel;a.meshData=this.meshData;return a};g.prototype.setMeshDataFromBuffers=function(a,b,f){var e=new m,h;for(h in b){for(var k=b[h].stride,d=b[h].data,l=[],c=0;c<k*a.vertexCount/4;++c)l[c]=d[c+k*a.vertexFrom/4];e.vertexData.set(h,l)}for(c=e.indexData.length=0;c<a.indexCount;++c)e.indexData[c]=f[c+a.indexFrom]-a.vertexFrom;e.vertexCount=a.vertexCount;this.meshData=e};g.prototype.readMeshDataFromBuffers=
function(a,b){this.meshData?this.meshData.clear():this.meshData=new m;for(var f in a){for(var e=a[f].stride,h=a[f].data,k=[],d=0;d<e*this.vertexCount/4;++d)k[d]=h[d+e*this.vertexFrom/4];this.meshData.vertexData.set(f,k)}for(d=this.meshData.indexData.length=0;d<this.indexCount;++d)this.meshData.indexData[d]=b[d+this.indexFrom]-this.vertexFrom;this.meshData.vertexCount=this.vertexCount};g.prototype.writeMeshDataToBuffers=function(a,b,f,e){for(var h in b)for(var k=b[h].stride,d=this.meshData.vertexData.get(h),
l=b[h].data,c=0;c<k*this.meshData.vertexCount/4;++c)l[c+k*a/4]=d[c];for(c=0;c<this.meshData.indexData.length;++c)e[c+f]=this.meshData.indexData[c]+a;this.vertexFrom=a;this.vertexCount=this.meshData.vertexCount;this.indexFrom=f;this.indexCount=this.meshData.indexData.length};g.writeAllMeshDataToBuffers=function(a,b,f){for(var e=0,h=0,k=0;k<a.length;k++){var d=a[k];d.writeMeshDataToBuffers(e,b,h,f);e+=d.vertexCount;h+=d.indexCount}};g.prototype._computeSortKey=function(){this._sortKey=(this.symbolLevel&
31)<<12|(this.zOrder&127)<<4|this.geometryType&7};g.prototype.serialize=function(a){a.writeInt32(this.geometryType);a.writeInt32(this._materialInfo);a.writeInt32(this.symbolLevel);a.writeInt32(this.zOrder);a.writeInt32(this.vertexFrom);a.writeInt32(this.vertexCount);a.writeInt32(this.indexFrom);a.writeInt32(this.indexCount);return a};g.deserialize=function(a,b){var f=a.readInt32(),e=b.store&&b.store.get(a.readInt32())||a.readInt32();b=new g(b.id,f,e);b.symbolLevel=a.readInt32();b.zOrder=a.readInt32();
b.vertexFrom=a.readInt32();b.vertexCount=a.readInt32();b.indexFrom=a.readInt32();b.indexCount=a.readInt32();return b};return g}()});