// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/3.38/esri/copyright.txt for details.
//>>built
define("esri/layers/vectorTiles/views/2d/engine/webgl/CIMSymbolHelper","require exports ../../../../core/Logger ./CIMSymbolDrawHelper ./SDFHelper ../../../vectorTiles/GeometryUtils".split(" "),function(l,m,v,n,w,t){Object.defineProperty(m,"__esModule",{value:!0});var u=v.getLogger("esri/views/2d/engine/webgl/CIMSymbolHelper");l=function(){function g(){}g.getEnvelope=function(d){if("CIMPointSymbol"!==d.type)return null;var b=new n.EnvDrawHelper;b.drawSymbol(d,{type:"point",x:0,y:0});return b.envelope()};
g.rasterize=function(d,b){var a=this.getEnvelope(b);if(!a||0>=a.width||0>=a.height)return[null,0,0,0,0];var c=96/72,e=(a.x+.5*a.width)*c,f=-(a.y+.5*a.height)*c;d.width=a.width*c+2;d.height=a.height*c+2;a=d.getContext("2d");c=n.Transformation.createScale(c,-c);c.translate(.5*d.width-e,.5*d.height-f);(new n.CanvasDrawHelper(a,c)).drawSymbol(b,{type:"point",x:0,y:0});b=a.getImageData(0,0,d.width,d.height);b=new Uint8Array(b.data);for(a=0;a<b.length;a+=4)c=b[a+3]/255,b[a]*=c,b[a+1]*=c,b[a+2]*=c;return[b,
d.width,d.height,e/d.width,f/d.height]};g.fromSimpleMarker=function(d){var b=d.style;if("circle"===b||"esriSMSCircle"===b){var a=Math.acos(.995);var c=Math.ceil(t.C_PI/a/4);0===c&&(c=1);a=t.C_PI_BY_2/c;c*=4;b=[];b.push([50,0]);for(var e=1;e<c;e++)b.push([50*Math.cos(e*a),-50*Math.sin(e*a)]);b.push([50,0]);a={rings:[b]};c={xmin:-50,ymin:-50,xmax:50,ymax:50}}else if("cross"===b||"esriSMSCross"===b)a=0,a={rings:[[[a,50],[a,a],[50,a],[50,-a],[a,-a],[a,-50],[-a,-50],[-a,-a],[-50,-a],[-50,a],[-a,a],[-a,
50],[a,50]]]},c={xmin:-50,ymin:-50,xmax:50,ymax:50};else if("diamond"===b||"esriSMSDiamond"===b)a={rings:[[[-50,0],[0,50],[50,0],[0,-50],[-50,0]]]},c={xmin:-50,ymin:-50,xmax:50,ymax:50};else if("square"===b||"esriSMSSquare"===b)a={rings:[[[-50,-50],[-50,50],[50,50],[50,-50],[-50,-50]]]},c={xmin:-50,ymin:-50,xmax:50,ymax:50};else if("x"===b||"esriSMSX"===b)a=0,a={rings:[[[0,a],[50-a,50],[50,50-a],[a,0],[50,a-50],[50-a,-50],[0,-a],[a-50,-50],[-50,a-50],[-a,0],[-50,50-a],[a-50,50],[0,a]]]},c={xmin:-50,
ymin:-50,xmax:50,ymax:50};else if("triangle"===b||"esriSMSTriangle"===b)c=2/3*100,b=c-100,a={rings:[[[-57.735026918962575,b],[0,c],[57.735026918962575,b],[-57.735026918962575,b]]]},c={xmin:-57.735026918962575,ymin:b,xmax:57.735026918962575,ymax:c};if(a&&c){var f=[{type:"CIMSolidFill",enable:!0,color:d.color}];d.outline&&f.push({type:"CIMSolidStroke",enable:!0,width:d.outline.width,color:d.outline.color});f={type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,rotation:d.angle,size:d.size,
offsetX:d.xoffset,offsetY:d.yoffset,frame:c,markerGraphics:[{type:"CIMMarkerGraphic",geometry:a,symbol:{type:"CIMPolygonSymbol",symbolLayers:f}}]}]}}return f};return g}();m.CIMSymbolHelper=l;l=function(){function g(){}g.rasterizeSimpleFill=function(d,b){"solid"!==b&&"none"!==b&&"esriSFSSolid"!==b&&"esriSFSNull"!==b||console.error("Unexpected: style does not require rasterization");d.width=8;d.height=8;var a=d.getContext("2d");a.strokeStyle="#FFFFFF";a.beginPath();if("vertical"===b||"cross"===b||"esriSFSCross"===
b||"esriSFSVertical"===b)a.moveTo(0,0),a.lineTo(0,8);if("horizontal"===b||"cross"===b||"esriSFSCross"===b||"esriSFSHorizontal"===b)a.moveTo(0,0),a.lineTo(8,0);if("forward-diagonal"===b||"diagonal-cross"===b||"esriSFSDiagonalCross"===b||"esriSFSForwardDiagonal"===b)a.moveTo(0,0),a.lineTo(8,8);if("backward-diagonal"===b||"diagonal-cross"===b||"esriSFSBackwardDiagonal"===b||"esriSFSDiagonalCross"===b)a.moveTo(8,0),a.lineTo(0,8);a.stroke();b=a.getImageData(0,0,d.width,d.height);b=new Uint8Array(b.data);
for(var c=0;c<b.length;c+=4)a=b[c+3]/255,b[c]*=a,b[c+1]*=a,b[c+2]*=a;return[b,d.width,d.height]};g.rasterizeSimpleLine=function(d,b){switch(b){case "dash":case "esriSLSDash":var a=[3,2];break;case "dash-dot":case "esriSLSDashDot":a=[2,2,0,2];break;case "dot":case "esriSLSDot":a=[0,3];break;case "long-dash":case "esriSLSLongDash":a=[6,3];break;case "long-dash-dot":case "esriSLSLongDashDot":a=[6,3,0,3];break;case "long-dash-dot-dot":case "esriSLSDashDotDot":a=[2,2,0,2,0,2];break;case "short-dash":case "esriSLSShortDash":a=
[2,2];break;case "short-dash-dot":case "esriSLSShortDashDot":a=[2,2,0,2];break;case "short-dash-dot-dot":case "esriSLSShortDashDotDot":a=[2,2,0,2,0,2];break;case "short-dot":case "esriSLSShortDot":a=[0,2];break;case "solid":case "esriSLSSolid":case "none":u.error("Unexpected: style does not require rasterization");a=[0,0];break;default:u.error("Tried to rasterize SLS, but found an unexpected style: "+b+"!"),a=[0,0]}b=d=0;for(var c=a;b<c.length;b++){var e=c[b];d+=e}d*=16;c=31*d;b=new Float32Array(c);
for(e=0;e<c;++e)b[e]=257;for(var f=c=.5,p=!0,q=0;q<a.length;q++){e=a[q];c=f;f+=16*e;for(var h=c;h<f;){for(var k=.5;31>k;){e=(31-k+1.5)*d+h-.5;var r=(k-15.5)*(k-15.5);b[e]=p?r:Math.min((h-c)*(h-c)+r,(h-f)*(h-f)+r);k++}h++}p=!p}a=b.length;c=new Uint8Array(4*a);for(e=0;e<a;++e)w.packFloat(Math.sqrt(b[e])/15,c,4*e);return[c,d,31]};return g}();m.SymbolHelper=l});