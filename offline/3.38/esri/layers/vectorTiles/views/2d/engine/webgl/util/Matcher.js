// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/3.38/esri/copyright.txt for details.
//>>built
define("esri/layers/vectorTiles/views/2d/engine/webgl/util/Matcher",["require","exports","../../../../../core/tsSupport/extendsHelper","../../../../../core/Logger","../Utils"],function(h,k,m,l,n){Object.defineProperty(k,"__esModule",{value:!0});var p=l.getLogger("esri/views/2d/engine/webgl/util/Matcher");h=function(){function g(){this._defaultResult=null}g.prototype.size=function(){return 1};g.prototype.getDefault=function(){return this._defaultResult};g.prototype.setDefault=function(e){this._defaultResult=
e};g.prototype.match=function(e,a){return this.getDefault()};return g}();k.default=h;l=function(g){function e(a,d,c,b){var f=g.call(this)||this;f._intervals=[];f._isMaxInclusive=d;c?f._getValue=n.createArcadeFunction(c):a&&a.length?"function"===typeof a?(f._field=null,f._getValue=a):(f._field=a,f._normalizationInfo=b,f._getValue=f._getValueFromField.bind(f)):f._field=null;return f}m(e,g);e.prototype.add=function(a,d){this._intervals.push({interval:a,result:d});this._intervals.sort(function(c,b){return c.interval.min-
b.interval.min})};e.prototype.size=function(){return g.prototype.size.call(this)+this._intervals.length};e.prototype.match=function(a,d){if(!this._getValue)return this.getDefault();a=this._getValue(a,d);if(!a&&(null===a||void 0===a||isNaN(a)))return this.getDefault();for(d=0;d<this._intervals.length;d++){var c=this._intervals[d],b=c.interval;c=c.result;var f=this._isMaxInclusive?a<=b.max:a<b.max;if(a>=b.min&&f)return c}return this.getDefault()};e.prototype._needsNormalization=function(){var a=this._normalizationInfo;
return a&&(a.normalizationField||a.normalizationTotal||a.normalizationType)};e.prototype._getValueFromField=function(a){var d=a.attributes[this._field];if(!this._needsNormalization())return d;var c=this._normalizationInfo,b=c.normalizationField,f=c.normalizationTotal;c=c.normalizationType;a=!!b&&a.attributes[b];if(c)switch(c){case "field":return(a||void 0)&&d/a;case "log":return Math.log(d)*Math.LOG10E;case "percent-of-total":return d/f*100;default:p.error("Found unknown normalization type: "+c)}else p.error("Normalization is required, but no type was set!")};
return e}(h);k.IntervalMatcher=l;h=function(g){function e(a,d,c){var b=g.call(this)||this;b._resultsMap=new Map;c?b._getValue=n.createArcadeFunction(c):a&&a.length?"function"===typeof a[0]?(b._fields=null,b._getValue=a[0]):(b._fields=a,b._seperator=d||"",b._getValue=b._getValueFromFields.bind(b)):b._fields=null;return b}m(e,g);e.prototype.add=function(a,d){this._resultsMap.set(a.toString(),d)};e.prototype.size=function(){return g.prototype.size.call(this)+this._resultsMap.size};e.prototype.match=
function(a,d){if(!this._getValue)return this.getDefault();a=this._getValue(a,d);if(!a&&(null===a||void 0===a))return this.getDefault();a=a.toString();return this._resultsMap.has(a)?this._resultsMap.get(a):this.getDefault()};e.prototype._getValueFromFields=function(a){for(var d=[],c=0,b=this._fields;c<b.length;c++)d.push(a.attributes[b[c]]);return d.join(this._seperator)};return e}(h);k.MapMatcher=h});