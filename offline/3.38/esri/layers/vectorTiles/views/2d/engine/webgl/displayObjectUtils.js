// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/3.38/esri/copyright.txt for details.
//>>built
define("esri/layers/vectorTiles/views/2d/engine/webgl/displayObjectUtils","require exports ../../../../core/tsSupport/assignHelper ./enums ./enums ./MaterialInfoUtils ./mesh ./textMeshUtils ./Utils ./visualVariablesUtils ./WGLDisplayObject ./WGLDisplayRecord".split(" "),function(F,y,G,g,m,A,B,C,h,v,D,E){function w(n,p){if(!n)return g.WGLVVFlag.NONE;for(var k=0,t=0;t<n.length;t++){var q=n[t];"size"===q.type&&"outline"!==q.target?k|=v.getTypeOfSizeVisualVariable(q):"color"===q.type?k|=g.WGLVVFlag.COLOR:
"opacity"===q.type?k|=g.WGLVVFlag.OPACITY:p&&"rotation"===q.type&&(k|=g.WGLVVFlag.ROTATION)}return k}Object.defineProperty(y,"__esModule",{value:!0});var l=[];y.getDisplayObject=function(n,p,k,t,q,z,r){p=n.attributes[p];var x=new D(p);l.length=0;var a=k.renderer,e=k.getSymbol(n);if(e){var c=h.isMarkerSymbol(e)||h.isTextSymbol(e);if("esriGeometryPoint"===t||"esriGeometryPolyline"===t)l.push({symbol:e,vv:w(a.visualVariables,c)});else if(c){if(a.backgroundFillSymbol){c=a.backgroundFillSymbol;var b=g.WGLVVFlag.NONE;
if(a.visualVariables)for(var f=0,u=a.visualVariables;f<u.length;f++){var d=u[f];d=d.type;"color"===d?b|=g.WGLVVFlag.COLOR:"opacity"===d&&(b|=g.WGLVVFlag.OPACITY)}l.push({symbol:c,vv:b,isBFS:!0});if(c.outline&&"none"!==c.outline.style){b=g.WGLVVFlag.NONE;if(a.visualVariables)for(f=0,u=a.visualVariables;f<u.length;f++)if(d=u[f],"size"===d.type&&"outline"===d.target){b|=v.getTypeOfSizeVisualVariable(d);break}l.push({symbol:c.outline,vv:b})}}l.push({symbol:e,vv:w(a.visualVariables,!0)})}else if(h.isFillSymbol(e)){d=
g.WGLVVFlag.NONE;if(a.visualVariables)for(b=0,f=a.visualVariables;b<f.length;b++)c=f[b],c=c.type,"color"===c?d|=g.WGLVVFlag.COLOR:"opacity"===c&&(d|=g.WGLVVFlag.OPACITY);l.push({symbol:e,vv:d});if(e.outline&&"none"!==e.outline.style){d=g.WGLVVFlag.NONE;if(a.visualVariables)for(b=0,a=a.visualVariables;b<a.length;b++)if(c=a[b],"size"===c.type&&"outline"===c.target){d|=v.getTypeOfSizeVisualVariable(c);break}l.push({symbol:e.outline,vv:d})}}else h.isLineSymbol(e)&&l.push({symbol:e,vv:w(a.visualVariables,
c)})}for(e=0;e<l.length;e++){c=l[e];d=c.symbol;a=h.getSymbolGeometryType(d);b=0!==c.vv;switch(a){case m.WGLGeometryType.MARKER:r.icon||(r.icon=h.getStrides(m.WGLGeometryType.MARKER,b,!1));break;case m.WGLGeometryType.LINE:r.line||(r.line=h.getStrides(m.WGLGeometryType.LINE,b));break;case m.WGLGeometryType.FILL:r.fill||(r.fill=h.getStrides(m.WGLGeometryType.FILL,b));break;case m.WGLGeometryType.TEXT:r.text||(r.text=h.getStrides(m.WGLGeometryType.TEXT,b))}if(a===m.WGLGeometryType.TEXT)for(b=0,a=C.createTextDisplayRecords(n,
c,p,k,z,h.getTextProperties(d),a);b<a.length;b++)x.displayRecords.push(a[b]);else if(f=z.get(d),b=A.createMaterialInfo(f,a,c.vv),b.materialKeyInfo.hasVV(),c=B.createMesh(p,k,b.materialKeyInfo,f,a,t,q,n,d,c.isBFS))a=new E(p,a,b),a.meshData=c,x.displayRecords.push(a)}return x}});