// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/3.38/esri/copyright.txt for details.
//>>built
define("esri/layers/vectorTiles/views/2d/engine/webgl/WGLBuffers",["require","exports","./Utils","../../../webgl/BufferObject"],function(h,k,l,m){Object.defineProperty(k,"__esModule",{value:!0});h=function(){function g(b,a){this.geometryMap=l.createGeometryData(a,function(c){return{indexBuffer:m.createIndex(b,35044),vao:null}},function(c,d){return{vertexBuffer:m.createVertex(b,l.C_VBO_INFO[d])}})}g.prototype.dispose=function(){for(var b in this.geometryMap){var a=this.geometryMap[b];a.data.vao&&a.data.vao.dispose(!1);
a.data.indexBuffer&&a.data.indexBuffer.dispose();for(var c in a.buffers)a.buffers[c]&&a.buffers[c].data.vertexBuffer.dispose()}};g.prototype.get=function(b){var a=this.geometryMap[b];b={};for(var c in a.buffers)b[c]=a.buffers[c].data.vertexBuffer;return{indexBuffer:a.data.indexBuffer,get vao(){return a.data.vao},set vao(d){a.data.vao=d},vertexBufferMap:b}};g.prototype.has=function(b){return null!=this.geometryMap[b]};g.prototype.upload=function(b,a){var c=this;a.forEach(function(d,e){d.indices&&(d.indices.allDirty?
c._uploadIndices(b,e):null!=d.indices.from&&null!=d.indices.count&&c._uploadIndices(b,e,d.indices.from,d.indices.count));d.vertices&&d.vertices.forEach(function(f,n){f.allDirty?c._uploadVertices(b,e,n):null!=f.from&&null!=f.count&&c._uploadVertices(b,e,n,f.from,f.count)})})};g.prototype._uploadVertices=function(b,a,c,d,e){var f=this.geometryMap[a];f&&(a=b.geometries[a].vertexBuffer[c])&&(b=a.stride,a=a.data.buffer,f.buffers[c]&&0<a.byteLength&&(null!=d&&null!=e?f.buffers[c].data.vertexBuffer.setSubData(a,
d*b,d*b,(d+e)*b):f.buffers[c].data.vertexBuffer.setData(a)))};g.prototype._uploadIndices=function(b,a,c,d){var e=this.geometryMap[a];e&&(b=b.geometries[a].indexBuffer.buffer,e.data.indexBuffer&&0<b.byteLength&&(null!=c&&null!=d?e.data.indexBuffer.setSubData(b,4*c,4*c,4*(c+d)):e.data.indexBuffer.setData(b)))};return g}();k.default=h});