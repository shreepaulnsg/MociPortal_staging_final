// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/3.38/esri/copyright.txt for details.
//>>built
define("esri/layers/vectorTiles/views/2d/layers/features/tileRenderers/SymbolTileRenderer","require exports ../../../../../core/tsSupport/declareExtendsHelper ../../../../../core/tsSupport/decorateHelper ../../../../../renderers ../../../../../core/Accessor ../../../../../core/accessorSupport/decorators ../../../../../geometry/support/aaBoundingRect ../../../../../renderers/support/diffUtils ../../../engine/webgl/rendererInfoUtils ../../../engine/webgl/visualVariablesUtils ../../../engine/webgl/WGLFeatureView ../../../engine/webgl/WGLTile ./BaseTileRenderer".split(" "),
function(l,m,r,t,f,u,n,v,p,g,q,w,x,y){function z(d){for(var c in d.diff){var a=d.diff[c];if("collection"===a.type){if(0!==a.changed.length||0!==a.added.length||0!==a.removed.length)return!0}else if("visualVariables"!==c&&"authoringInfo"!==c)return!0}return!1}Object.defineProperty(m,"__esModule",{value:!0});l=function(d){function c(a){return d.call(this)||this}r(c,d);c.prototype.initialize=function(){};c.prototype.createTile=function(a){var b=v.create();this.tileInfoView.getTileBounds(b,a);return new x(a,
b)};c.prototype.disposeTile=function(a){this._featuresView.removeChild(a)};c.prototype.highlight=function(a){return this._featuresView.highlight(a)};c.prototype.hitTest=function(a,b){return this._featuresView.hitTest(a,b)};c.prototype.supportsRenderer=function(a){return null!=a&&g.isRendererWebGLCompatible(a)&&-1!==["simple","class-breaks","unique-value"].indexOf(a.type)};c.prototype.getProcessorConfiguration=function(){var a=this.layer;return{type:"symbol",renderer:a.renderer.toJSON(),devicePixelRatio:window.devicePixelRatio||
1,definitionExpression:a.definitionExpression,outFields:a.outFields.slice().sort(),gdbVersion:a.gdbVersion,historicMoment:a.historicMoment&&a.historicMoment.getTime(),labelingInfo:a.labelingInfo&&a.labelingInfo.map(function(b){return b.toJSON()})}};c.prototype.needsProcessorReconfiguration=function(a){var b=this.configuration;if(!b||b.definitionExpression!==a.definitionExpression||b.outFields.join()!==a.outFields.join())return!0;b=this.configuration&&f.fromJSON(this.configuration.renderer)||null;
a=a&&f.fromJSON(a.renderer)||null;b=p.diff(b,a);if(!b)return!1;switch(b.type){case "complete":return!0;case "partial":if(z(b))return!0;if(b.diff.visualVariables){b=this._featuresView.visualVariablesInfo;var e=this.tileInfoView.tileInfo.spatialReference,k={fields:this.layer.fields.map(function(h){return h.toJSON()})};a=g.getNormalizedRenderer(a,e,k);a=q.convertVisualVariables(a.visualVariables).vvFields;return p.diff(b.vvFields,a)?!0:!1}}};c.prototype.applyConfiguration=function(a,b){var e=f.fromJSON(a.renderer),
k={fields:this.layer.fields.map(function(h){return h.toJSON()})};e=g.getNormalizedRenderer(e,this.tileInfoView.tileInfo.spatialReference,k);this.configuration=a;this._featuresView.visualVariablesInfo=q.convertVisualVariables(e.visualVariables);b&&this._featuresView.disposeWebGLResources()};c.prototype.install=function(a){var b=new w.default({highlightOptions:this.highlightOptions,tileInfoView:this.tileInfoView,layer:this.layer,layerView:this.layerView});this._featuresView=b;b.install(a)};c.prototype.uninstall=
function(a){this._featuresView.uninstall(a)};c.prototype.onTileData=function(a){var b=this.tiles.get(a.tileKey);b&&(this._featuresView.onTileData(b,a.data),this.requestUpdate())};c.prototype.onTileDataUpdate=function(a){var b=this.tiles.get(a.tileId);b&&(this._featuresView.onTileDataUpdate(b,a.data),this.requestUpdate())};c.prototype.onTileError=function(a){if(a=this.tiles.get(a.tileKey))this._featuresView.onTileError(a),this.requestUpdate()};c.prototype.getMaterialItems=function(a){return this._featuresView.getMaterialItems(a)};
return c=t([n.subclass()],c)}(n.declared(u,y.default));m.default=l});