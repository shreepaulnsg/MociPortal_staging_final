// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/3.38/esri/copyright.txt for details.
//>>built
define("esri/layers/vectorTiles/core/urlUtils",["require","exports","esri/urlUtils","dojo/_base/url"],function(u,d,m,v){function n(a){return m.normalize(a)}function w(a){return"data:"===a.slice(0,5)}function h(a){return p(a)||x.test(a)}function p(a){return a&&"/"===a[0]&&"/"===a[1]}function y(a){return m.urlToObject(a)}function z(a){if("string"===typeof a)return new v(q(a));a.scheme||(a.scheme=d.appUrl.scheme);return a}function A(a){if(w(a))return null;var b=a.indexOf("://");if(-1===b&&p(a))b=2;else if(-1!==
b)b+=3;else return null;b=a.indexOf("/",b);return-1===b?a:a.slice(0,b)}function q(a,b,c){void 0===b&&(b=d.appBaseUrl);if(p(a))return c&&c.preserveProtocolRelative?a:"http"===d.appUrl.scheme&&d.appUrl.authority===A(a).slice(2)?"http:"+a:"https:"+a;if(x.test(a))return a;"/"===a[0]&&(c=b.indexOf("//"),c=b.indexOf("/",c+2),b=-1===c?b:b.slice(0,c));return B(b,a)}function C(a,b,c){void 0===c&&(c=!1);a=z(a);b=z(b);return c||a.scheme===b.scheme?a.host.toLowerCase()===b.host.toLowerCase()&&a.port===b.port:
!1}function B(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];if(a&&a.length){b=[];if(h(a[0])){var c=a[0],e=c.indexOf("//");b.push(c.slice(0,e+1));F.test(a[0])&&(b[0]+="/");a[0]=c.slice(e+2)}else"/"===a[0][0]&&b.push("");a=a.reduce(function(f,g){return g?f.concat(g.split("/")):f},[]);for(c=0;c<a.length;c++)e=a[c],".."===e&&0<b.length?b.pop():!e||"."===e&&0!==b.length||b.push(e);return b.join("/")}}function r(a,b,c){if(!(b&&c&&a&&h(a)))return a;var e=a.indexOf("//"),f=a.indexOf("/",e+2),
g=a.indexOf(":",e+2);f=Math.min(0>f?a.length:f,0>g?a.length:g);if(a.slice(e+2,f).toLowerCase()!==b.toLowerCase())return a;b=a.slice(0,e+2);a=a.slice(f);return""+b+c+a}function D(a,b,c){void 0===b&&(b=d.appBaseUrl);if(!h(a))return a;var e=n(a),f=e.toLowerCase();b=n(b).toLowerCase().replace(/\/+$/,"");if((c=c?n(c).toLowerCase().replace(/\/+$/,""):null)&&0!==b.indexOf(c))return a;for(var g=function(E,G,t){t=E.indexOf(G,t);return-1===t?E.length:t},k=g(f,"/",f.indexOf("//")+2),l=-1;f.slice(0,k+1)===b.slice(0,
k)+"/";){l=k+1;if(k===f.length)break;k=g(f,"/",k+1)}if(-1===l||c&&l<c.length)return a;a=e.slice(l);e=b.slice(l-1).replace(/[^/]+/g,"").length;if(0<e)for(f=0;f<e;f++)a="../"+a;else a="./"+a;return a}Object.defineProperty(d,"__esModule",{value:!0});d.normalize=n;d.canUseXhr=function(a){return m.canUseXhr(a)};d.removeTrailingSlash=function(a){return a.replace(/\/+$/,"")};u=Function("return this")();d.appUrl=new v(u.location);d.appBaseUrl=function(){var a=d.appUrl.path;a=a.substring(0,a.lastIndexOf(a.split("/")[a.split("/").length-
1]));return d.appUrl.scheme+"://"+d.appUrl.host+(null!=d.appUrl.port?":"+d.appUrl.port:"")+a}();var F=/^\s*file:/i,x=/^\s*[a-z][a-z0-9-+.]*:[^0-9]/i;d.isDataProtocol=w;d.isAbsolute=h;d.isProtocolRelative=p;d.urlToObject=y;d.getOrigin=A;d.makeAbsolute=q;d.hasSameOrigin=C;d.join=B;d.removeFile=function(a){var b=0;if(h(a)){var c=a.indexOf("//");-1!==c&&(b=c+2)}c=a.lastIndexOf("/");return c<b?a:a.slice(0,c+1)};d.addProxy=function(a){return m.addProxy(a)};d.makeData=function(a){return a.isBase64?"data:"+
a.mediaType+";base64,"+a.data:"data:"+a.mediaType+","+a.data};var H=/^data:(.*?)(;base64)?,(.*)$/;d.dataComponents=function(a){return(a=a.match(H))?{mediaType:a[1],isBase64:!!a[2],data:a[3]}:null};d.changeDomain=r;d.read=function(a,b){var c=b&&b.url&&b.url.path;a&&c&&(a=q(a,c,{preserveProtocolRelative:!0}));(b=b&&b.portal)&&!b.isPortal&&b.urlKey&&b.customBaseUrl?(c=b.urlKey+"."+b.customBaseUrl,b=C(d.appUrl,d.appUrl.scheme+"://"+c)?r(a,b.portalHostname,c):r(a,c,b.portalHostname)):b=a;return b};d.write=
function(a,b){if(!a)return a;!h(a)&&b&&b.blockedRelativeUrls&&b.blockedRelativeUrls.push(a);var c=q(a);if(b){var e=b.verifyItemRelativeUrls&&b.verifyItemRelativeUrls.rootPath||b.url&&b.url.path;e&&(c=D(c,e,e),c!==a&&b.verifyItemRelativeUrls&&b.verifyItemRelativeUrls.writtenUrls.push(c))}a=c;c=(b=b&&b.portal)&&!b.isPortal&&b.urlKey&&b.customBaseUrl?r(a,b.urlKey+"."+b.customBaseUrl,b.portalHostname):a;return c};d.makeRelative=D;d.removeQueryParameters=function(a){a=y(a);Object.keys(a.query||{});return a.path}});