// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/3.38/esri/copyright.txt for details.
//>>built
define("esri/layers/DataAdapterFeatureLayer","../declare dojo/_base/lang dojo/_base/array dojo/when ./FeatureLayer ../renderers/SimpleRenderer ../symbols/SimpleFillSymbol ../symbols/SimpleMarkerSymbol ../symbols/SimpleLineSymbol".split(" "),function(h,d,e,f,k,l,m,n,p){return h("esri.layers.DataAdapterFeatureLayer",k,{locationProvider:null,dataAdapter:null,dataAdapterQuery:null,_preventInit:!0,constructor:function(c,a){this.dataAdapterQuery=a&&a.dataAdapterQuery;this.locationProvider=a&&a.locationProvider;
if((this.dataAdapter=c)&&this.locationProvider&&this.dataAdapterQuery){var b=d.hitch(this,this._init,a);if(this.locationProvider.loaded)this._queryDataAdapter().then(b);else this.locationProvider.on("load",d.hitch(this,function(){this._queryDataAdapter().then(b)}))}},_queryDataAdapter:function(){function c(b,q){return{idField:b.idField,fields:e.filter(b.fields,function(g){return-1!==e.indexOf(a.dataAdapterQuery.outFields,g.name)||g.name===b.idField}),recordSet:q}}var a=this;return f(this.dataAdapter.getTableInfo(this.dataAdapterQuery.tableId)).then(function(b){return f(a.dataAdapter.query(a.dataAdapterQuery)).then(d.partial(c,
b))})},_init:function(c,a){switch(this.locationProvider.geometryType){case "esriGeometryPoint":case "esriGeometryMultipoint":var b=new n;break;case "esriGeometryPolyline":b=new p;break;case "esriGeometryPolygon":b=new m}a={layerDefinition:{geometryType:this.locationProvider.geometryType,objectIdField:a.idField,fields:a.fields,drawingInfo:{renderer:(new l(b)).toJson()}},featureSet:{features:a.recordSet.features}};this.on("load",d.hitch(this,this._locateFeatures));this._initFeatureLayer(a,c)},_locateFeatures:function(){var c=
this,a=this.getMap(),b=function(){c._fireUpdateStart();c.locationProvider.locate(c.graphics,{outSpatialReference:a.spatialReference}).then(function(){c._fireUpdateEnd()})};if(a&&!this._located)if(this._located=!0,this.locationProvider.loaded)b();else this.locationProvider.on("load",b)},_isWebGLCompatible:function(){return!1},_setMap:function(){var c=this.inherited(arguments);this._locateFeatures();return c}})});