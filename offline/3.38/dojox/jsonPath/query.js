//>>built
define("dojox/jsonPath/query",["dojo/_base/kernel","dojo/_base/lang"],function(F,G){var E=function(w,z,u){u||(u={});var x=[],H=function(c){return x[c]}.name;if("PATH"==u.resultType&&"RESULT"==u.evalType)throw Error("RESULT based evaluation not supported with PATH based results");var g={resultType:u.resultType||"VALUE",normalize:function(c){var d=[];c=c.replace(/'([^']|'')*'/g,function(e){return H+"("+(x.push(eval(e))-1)+")"});for(var f=-1;f!=d.length;)f=d.length,c=c.replace(/(\??\([^\(\)]*\))/g,function(e){return"#"+
(d.push(e)-1)});c=c.replace(/[\['](#[0-9]+)[\]']/g,"[$1]").replace(/'?\.'?|\['?/g,";").replace(/;;;|;;/g,";..;").replace(/;$|'?\]|'$/g,"");for(f=-1;f!=c;)f=c,c=c.replace(/#([0-9]+)/g,function(e,n){return d[n]});return c.split(";")},asPaths:function(c){var d,f;for(d=0;d<c.length;d++){var e="$";var n=c[d];var r=1;for(f=n.length;r<f;r++)e+=/^[0-9*]+$/.test(n[r])?"["+n[r]+"]":"['"+n[r]+"']";c[d]=e}return c},exec:function(c,d,f){function e(a,b,k){a&&a.hasOwnProperty(b)&&"VALUE"!=g.resultType&&p.push(q.concat([b]));
k?t=a[b]:a&&a.hasOwnProperty(b)&&t.push(a[b])}function n(a){t.push(a);p.push(q);g.walk(a,function(b){if("object"===typeof a[b]){var k=q;q=q.concat(b);n(a[b]);q=k}})}function r(a,b){if(b instanceof Array){var k=b.length,m=0,l=k,h=1;a.replace(/^(-?[0-9]*):(-?[0-9]*):?(-?[0-9]*)$/g,function(A,I,J,K){m=parseInt(I||m,10);l=parseInt(J||l,10);h=parseInt(K||h,10)});m=0>m?Math.max(0,m+k):Math.min(k,m);l=0>l?Math.max(0,l+k):Math.min(k,l);for(a=m;a<l;a+=h)e(b,a)}}function B(a,b){return(b=b.match(/^_str\(([0-9]+)\)$/))?
x[b[1]]:a}function C(a,b){if(/^\(.*?\)$/.test(b))e(a,g.eval(b,a),f);else if("*"===b)g.walk(a,f&&a instanceof Array?function(h){g.walk(a[h],function(A){e(a[h],A)})}:function(h){e(a,h)});else if(".."===b)n(a);else if(/,/.test(b)){var k;var m=b.split(/'?,'?/);var l=0;for(k=m.length;l<k;l++)e(a,B(m[l],b))}else/^\?\(.*?\)$/.test(b)?g.walk(a,function(h){g.eval(b.replace(/^\?\((.*?)\)$/,"$1"),a[h])&&e(a,h)}):/^(-?[0-9]*):(-?[0-9]*):?([0-9]*)$/.test(b)?r(b,a):(b=B(b,b),f&&a instanceof Array&&!/^[0-9*]+$/.test(b)?
g.walk(a,function(h){e(a[h],b)}):e(a,b,f))}for(var q=["$"],t=f?d:[d],p=[q],y,D;c.length;){y=c.shift();if(null===(d=t)||void 0===d)return d;t=[];D=p;p=[];f?C(d,y):g.walk(d,function(a){q=D[a]||q;C(d[a],y)})}if("BOTH"==g.resultType){p=g.asPaths(p);c=[];var v;for(v=0;v<p.length;v++)c.push({path:p[v],value:t[v]});return c}return"PATH"==g.resultType?g.asPaths(p):t},walk:function(c,d){var f;if(c instanceof Array){var e=0;for(f=c.length;e<f;e++)e in c&&d(e)}else if("object"===typeof c)for(e in c)c.hasOwnProperty(e)&&
d(e)},eval:function(c,d){try{return w&&d&&eval(c.replace(/@/g,"v"))}catch(f){throw new SyntaxError("jsonPath: "+f.message+": "+c.replace(/@/g,"v").replace(/\^/g,"_a"));}}};return z&&w?g.exec(g.normalize(z).slice(1),w,"RESULT"==u.evalType):!1};F.isAsync||(G.getObject("dojox.jsonPath",!0).query=E);return E});