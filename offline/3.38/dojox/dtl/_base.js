//>>built
define("dojox/dtl/_base","dojo/_base/kernel dojo/_base/lang dojox/string/tokenize dojo/_base/json dojo/dom dojo/_base/xhr dojox/string/Builder dojo/_base/Deferred".split(" "),function(r,f,n,E,t,p,u,q){r.experimental("dojox.dtl");var e=f.getObject("dojox.dtl",!0);e._base={};e.TOKEN_BLOCK=-1;e.TOKEN_VAR=-2;e.TOKEN_COMMENT=-3;e.TOKEN_TEXT=3;e._Context=f.extend(function(a){a&&(f._mixin(this,a),a.get&&(this._getter=a.get,delete this.get))},{push:function(){var a=this,b=f.delegate(this);b.pop=function(){return a};
return b},pop:function(){throw Error("pop() called on empty Context");},get:function(a,b){var c=this._normalize;if(this._getter){var d=this._getter(a);if(void 0!==d)return c(d)}return void 0!==this[a]?c(this[a]):b},_normalize:function(a){a instanceof Date&&(a.year=a.getFullYear(),a.month=a.getMonth()+1,a.day=a.getDate(),a.date=a.year+"-"+("0"+a.month).slice(-2)+"-"+("0"+a.day).slice(-2),a.hour=a.getHours(),a.minute=a.getMinutes(),a.second=a.getSeconds(),a.microsecond=a.getMilliseconds());return a},
update:function(a){var b=this.push();a&&f._mixin(this,a);return b}});var v=/("(?:[^"\\]*(?:\\.[^"\\]*)*)"|'(?:[^'\\]*(?:\\.[^'\\]*)*)'|[^\s]+)/g,w=/\s+/g,x=function(a,b){a=a||w;a instanceof RegExp||(a=new RegExp(a,"g"));if(!a.global)throw Error("You must use a globally flagged RegExp with split "+a);a.exec("");for(var c,d=[],h=0,g=0;(c=a.exec(this))&&!(d.push(this.slice(h,a.lastIndex-c[0].length)),h=a.lastIndex,b&&++g>b-1););d.push(this.slice(h));return d};e.Token=function(a,b){this.token_type=a;
this.contents=new String(f.trim(b));this.contents.split=x;this.split=function(){return String.prototype.split.apply(this.contents,arguments)}};e.Token.prototype.split_contents=function(a){var b,c=[],d=0;for(a=a||999;d++<a&&(b=v.exec(this.contents));)b=b[0],'"'==b.charAt(0)&&'"'==b.slice(-1)?c.push('"'+b.slice(1,-1).replace('\\"','"').replace("\\\\","\\")+'"'):"'"==b.charAt(0)&&"'"==b.slice(-1)?c.push("'"+b.slice(1,-1).replace("\\'","'").replace("\\\\","\\")+"'"):c.push(b);return c};var k=e.text={_get:function(a,
b,c){a=e.register.get(a,b.toLowerCase(),c);if(!a){if(!c)throw Error("No tag found for "+b);return null}c=a[1];a=a[2];-1!=c.indexOf(":")&&(c=c.split(":"),c=c.pop());var d=a;/\./.test(a)&&(a=a.replace(/\./g,"/"));require([a],function(){});a=f.getObject(d);return a[c||b]||a[b+"_"]||a[c+"_"]},getTag:function(a,b){return k._get("tag",a,b)},getFilter:function(a,b){return k._get("filter",a,b)},getTemplate:function(a){return new e.Template(k.getTemplateString(a))},getTemplateString:function(a){return p._getText(a.toString())||
""},_resolveLazy:function(a,b,c){return b?c?c.fromJson(p._getText(a))||{}:e.text.getTemplateString(a):p.get({handleAs:c?"json":"text",url:a})},_resolveTemplateArg:function(a,b){return k._isTemplate(a)?b?a:(b=new q,b.callback(a),b):k._resolveLazy(a,b)},_isTemplate:function(a){return void 0===a||"string"==typeof a&&(a.match(/^\s*[<{]/)||-1!=a.indexOf(" "))},_resolveContextArg:function(a,b){return a.constructor==Object?b?a:(b=new q,b.callback(a),b):k._resolveLazy(a,b,!0)},_re:/(?:\{\{\s*(.+?)\s*\}\}|\{%\s*(load\s*)?(.+?)\s*%\})/g,
tokenize:function(a){return n(a,k._re,k._parseDelims)},_parseDelims:function(a,b,c){if(a)return[e.TOKEN_VAR,a];if(b)for(a=f.trim(c).split(/\s+/g),b=0;c=a[b];b++)/\./.test(c)&&(c=c.replace(/\./g,"/")),require([c]);else return[e.TOKEN_BLOCK,c]}};e.Template=f.extend(function(a,b){a=b?a:k._resolveTemplateArg(a,!0)||"";a=k.tokenize(a);this.nodelist=(new e._Parser(a)).parse()},{update:function(a,b){return k._resolveContextArg(b).addCallback(this,function(c){var d=this.render(new e._Context(c));a.forEach?
a.forEach(function(h){h.innerHTML=d}):t.byId(a).innerHTML=d;return this})},render:function(a,b){b=b||this.getBuffer();a=a||new e._Context({});return this.nodelist.render(a,b)+""},getBuffer:function(){return new u}});var y=/\{\{\s*(.+?)\s*\}\}/g;e.quickFilter=function(a){if(!a)return new e._NodeList;if(-1==a.indexOf("{%"))return new e._QuickNodeList(n(a,y,function(b){return new e._Filter(b)}))};e._QuickNodeList=f.extend(function(a){this.contents=a},{render:function(a,b){for(var c=0,d=this.contents.length;c<
d;c++)b=this.contents[c].resolve?b.concat(this.contents[c].resolve(a)):b.concat(this.contents[c]);return b},dummyRender:function(a){return this.render(a,e.Template.prototype.getBuffer()).toString()},clone:function(a){return this}});e._Filter=f.extend(function(a){if(!a)throw Error("Filter must be called with variable name");this.contents=a;var b=this._cache[a];b?(this.key=b[0],this.filters=b[1]):(this.filters=[],n(a,this._re,this._tokenize,this),this._cache[a]=[this.key,this.filters])},{_cache:{},
_re:/(?:^_\("([^\\"]*(?:\\.[^\\"])*)"\)|^"([^\\"]*(?:\\.[^\\"]*)*)"|^([a-zA-Z0-9_.]+)|\|(\w+)(?::(?:_\("([^\\"]*(?:\\.[^\\"])*)"\)|"([^\\"]*(?:\\.[^\\"]*)*)"|([a-zA-Z0-9_.]+)|'([^\\']*(?:\\.[^\\']*)*)'))?|^'([^\\']*(?:\\.[^\\']*)*)')/g,_values:{0:'"',1:'"',2:"",8:'"'},_args:{4:'"',5:'"',6:"",7:"'"},_tokenize:function(){for(var a,b,c=0,d=[];c<arguments.length;c++)d[c]=void 0!==arguments[c]&&"string"==typeof arguments[c]&&arguments[c];if(this.key){for(a in this._args)if(d[a]){b=arguments[a];"'"==this._args[a]?
b=b.replace(/\\'/g,"'"):'"'==this._args[a]&&(b=b.replace(/\\"/g,'"'));b=[!this._args[a],b];break}a=k.getFilter(arguments[3]);if(!f.isFunction(a))throw Error(arguments[3]+" is not registered as a filter");this.filters.push([a,b])}else for(a in this._values)if(d[a]){this.key=this._values[a]+arguments[a]+this._values[a];break}},getExpression:function(){return this.contents},resolve:function(a){if(void 0===this.key)return"";for(var b=this.resolvePath(this.key,a),c=0,d;d=this.filters[c];c++)b=d[1]?d[1][0]?
d[0](b,this.resolvePath(d[1][1],a)):d[0](b,d[1][1]):d[0](b);return b},resolvePath:function(a,b){var c=a.charAt(0);var d=a.slice(-1);if(isNaN(parseInt(c)))if('"'==c&&c==d)a=a.slice(1,-1);else{if("true"==a)return!0;if("false"==a)return!1;if("null"==a||"None"==a)return null;c=a.split(".");a=b.get(c[0]);f.isFunction(a)&&(b=b.getThis&&b.getThis(),a=a.alters_data?"":b?a.call(b):"");for(b=1;b<c.length;b++)if(d=c[b],a){var h=a;if(f.isObject(a)&&"items"==d&&void 0===a[d]){d=[];for(var g in a)d.push([g,a[g]]);
a=d}else{if(a.get&&f.isFunction(a.get)&&a.get.safe)a=a.get(d);else if(void 0===a[d]){a=a[d];break}else a=a[d];f.isFunction(a)?a=a.alters_data?"":a.call(h):a instanceof Date&&(a=e._Context.prototype._normalize(a))}}else return""}else a=-1==a.indexOf(".")?parseInt(a):parseFloat(a);return a}});e._TextNode=e._Node=f.extend(function(a){this.contents=a},{set:function(a){this.contents=a;return this},render:function(a,b){return b.concat(this.contents)},isEmpty:function(){return!f.trim(this.contents)},clone:function(){return this}});
e._NodeList=f.extend(function(a){this.contents=a||[];this.last=""},{push:function(a){this.contents.push(a);return this},concat:function(a){this.contents=this.contents.concat(a);return this},render:function(a,b){for(var c=0;c<this.contents.length;c++)if(b=this.contents[c].render(a,b),!b)throw Error("Template must return buffer");return b},dummyRender:function(a){return this.render(a,e.Template.prototype.getBuffer()).toString()},unrender:function(a,b){return b},clone:function(){return this},rtrim:function(){for(;;)if(i=
this.contents.length-1,this.contents[i]instanceof e._TextNode&&this.contents[i].isEmpty())this.contents.pop();else break;return this}});e._VarNode=f.extend(function(a){this.contents=new e._Filter(a)},{render:function(a,b){a=this.contents.resolve(a);if(void 0===a||null===a)a="";a.safe||(a=e._base.escape(""+a));return b.concat(a)}});e._noOpNode=new function(){this.render=this.unrender=function(a,b){return b};this.clone=function(){return this}};e._Parser=f.extend(function(a){this.contents=a},{i:0,parse:function(a){var b=
{};a=a||[];for(var c=0;c<a.length;c++)b[a[c]]=!0;for(c=new e._NodeList;this.i<this.contents.length;){var d=this.contents[this.i++];if("string"==typeof d)c.push(new e._TextNode(d));else{var h=d[0];d=d[1];if(h==e.TOKEN_VAR)c.push(new e._VarNode(d));else if(h==e.TOKEN_BLOCK){if(b[d])return--this.i,c;var g=d.split(/\s+/g);g.length&&(g=g[0],(g=k.getTag(g))&&c.push(g(this,new e.Token(h,d))))}}}if(a.length)throw Error("Could not find closing tag(s): "+a.toString());this.contents.length=0;return c},next_token:function(){var a=
this.contents[this.i++];return new e.Token(a[0],a[1])},delete_first_token:function(){this.i++},skip_past:function(a){for(;this.i<this.contents.length;){var b=this.contents[this.i++];if(b[0]==e.TOKEN_BLOCK&&b[1]==a)return}throw Error("Unclosed tag found when looking for "+a);},create_variable_node:function(a){return new e._VarNode(a)},create_text_node:function(a){return new e._TextNode(a||"")},getTemplate:function(a){return new e.Template(a)}});e.register={_registry:{attributes:[],tags:[],filters:[]},
get:function(a,b){a=e.register._registry[a+"s"];for(var c=0,d;d=a[c];c++)if("string"==typeof d[0]){if(d[0]==b)return d}else if(b.match(d[0]))return d},getAttributeTags:function(){for(var a=[],b=e.register._registry.attributes,c=0,d;d=b[c];c++)if(3==d.length)a.push(d);else{var h=f.getObject(d[1]);h&&f.isFunction(h)&&(d.push(h),a.push(d))}return a},_any:function(a,b,c){for(var d in c)for(var h=0,g;g=c[d][h];h++){var l=g;f.isArray(g)&&(l=g[0],g=g[1]);if("string"==typeof l){if("attr:"==l.substr(0,5)){var m=
g;"attr:"==m.substr(0,5)&&(m=m.slice(5));e.register._registry.attributes.push([m.toLowerCase(),b+"."+d+"."+m])}l=l.toLowerCase()}e.register._registry[a].push([l,g,b+"."+d])}},tags:function(a,b){e.register._any("tags",a,b)},filters:function(a,b){e.register._any("filters",a,b)}};var z=/&/g,A=/</g,B=/>/g,C=/'/g,D=/"/g;e._base.escape=function(a){return e.mark_safe(a.replace(z,"\x26amp;").replace(A,"\x26lt;").replace(B,"\x26gt;").replace(D,"\x26quot;").replace(C,"\x26#39;"))};e._base.safe=function(a){"string"==
typeof a&&(a=new String(a));"object"==typeof a&&(a.safe=!0);return a};e.mark_safe=e._base.safe;e.register.tags("dojox.dtl.tag",{date:["now"],logic:["if","for","ifequal","ifnotequal"],loader:["extends","block","include","load","ssi"],misc:"comment debug filter firstof spaceless templatetag widthratio with".split(" "),loop:["cycle","ifchanged","regroup"]});e.register.filters("dojox.dtl.filter",{dates:["date","time","timesince","timeuntil"],htmlstrings:["linebreaks","linebreaksbr","removetags","striptags"],
integers:["add","get_digit"],lists:"dictsort dictsortreversed first join length length_is random slice unordered_list".split(" "),logic:["default","default_if_none","divisibleby","yesno"],misc:["filesizeformat","pluralize","phone2numeric","pprint"],strings:"addslashes capfirst center cut fix_ampersands floatformat iriencode linenumbers ljust lower make_list rjust slugify stringformat title truncatewords truncatewords_html upper urlencode urlize urlizetrunc wordcount wordwrap".split(" ")});e.register.filters("dojox.dtl",
{_base:["escape","safe"]});return e});