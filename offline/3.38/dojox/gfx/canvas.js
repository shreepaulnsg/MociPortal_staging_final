//>>built
require({cache:{"dojox/gfx/shape":function(){define("./_base dojo/_base/lang dojo/_base/declare dojo/_base/kernel dojo/_base/sniff dojo/on dojo/_base/array dojo/dom-construct dojo/_base/Color ./matrix".split(" "),function(u,F,y,C,D,n,h,l,g,e){function t(d,m){for(var q=d.length-1;m<q;)d[m]=d[++m];d.length=q}var k=u.shape={};k.Shape=y("dojox.gfx.shape.Shape",null,{constructor:function(){this.parentMatrix=this.parent=this.bbox=this.strokeStyle=this.fillStyle=this.matrix=this.shape=this.rawNode=null;
if(D("gfxRegistry")){var d=k.register(this);this.getUID=function(){return d}}},destroy:function(){D("gfxRegistry")&&k.dispose(this);this.rawNode&&"__gfxObject__"in this.rawNode&&(this.rawNode.__gfxObject__=null);this.rawNode=null},getNode:function(){return this.rawNode},getShape:function(){return this.shape},getTransform:function(){return this.matrix},getFill:function(){return this.fillStyle},getStroke:function(){return this.strokeStyle},getParent:function(){return this.parent},getBoundingBox:function(){return this.bbox},
getTransformedBoundingBox:function(){var d=this.getBoundingBox();if(!d)return null;var m=this._getRealMatrix();return[e.multiplyPoint(m,d.x,d.y),e.multiplyPoint(m,d.x+d.width,d.y),e.multiplyPoint(m,d.x+d.width,d.y+d.height),e.multiplyPoint(m,d.x,d.y+d.height)]},getEventSource:function(){return this.rawNode},setClip:function(d){this.clip=d},getClip:function(){return this.clip},setShape:function(d){this.shape=u.makeParameters(this.shape,d);this.bbox=null;return this},setFill:function(d){if(!d)return this.fillStyle=
null,this;var m=null;if("object"==typeof d&&"type"in d)switch(d.type){case "linear":m=u.makeParameters(u.defaultLinearGradient,d);break;case "radial":m=u.makeParameters(u.defaultRadialGradient,d);break;case "pattern":m=u.makeParameters(u.defaultPattern,d)}else m=u.normalizeColor(d);this.fillStyle=m;return this},setStroke:function(d){if(!d)return this.strokeStyle=null,this;if("string"==typeof d||F.isArray(d)||d instanceof g)d={color:d};d=this.strokeStyle=u.makeParameters(u.defaultStroke,d);d.color=
u.normalizeColor(d.color);return this},setTransform:function(d){this.matrix=e.clone(d?e.normalize(d):e.identity);return this._applyTransform()},_applyTransform:function(){return this},moveToFront:function(){var d=this.getParent();d&&(d._moveChildToFront(this),this._moveToFront());return this},moveToBack:function(){var d=this.getParent();d&&(d._moveChildToBack(this),this._moveToBack());return this},_moveToFront:function(){},_moveToBack:function(){},applyRightTransform:function(d){return d?this.setTransform([this.matrix,
d]):this},applyLeftTransform:function(d){return d?this.setTransform([d,this.matrix]):this},applyTransform:function(d){return d?this.setTransform([this.matrix,d]):this},removeShape:function(d){this.parent&&this.parent.remove(this,d);return this},_setParent:function(d,m){this.parent=d;return this._updateParentMatrix(m)},_updateParentMatrix:function(d){this.parentMatrix=d?e.clone(d):null;return this._applyTransform()},_getRealMatrix:function(){for(var d=this.matrix,m=this.parent;m;)m.matrix&&(d=e.multiply(m.matrix,
d)),m=m.parent;return d}});k._eventsProcessing={on:function(d,m){return n(this.getEventSource(),d,k.fixCallback(this,u.fixTarget,m))},connect:function(d,m,q){"on"==d.substring(0,2)&&(d=d.substring(2));return this.on(d,q?F.hitch(m,q):m)},disconnect:function(d){return d.remove()}};k.fixCallback=function(d,m,q,z){z||(z=q,q=null);if(F.isString(z)){q=q||C.global;if(!q[z])throw['dojox.gfx.shape.fixCallback: scope["',z,'"] is null (scope\x3d"',q,'")'].join("");return function(x){return m(x,d)?q[z].apply(q,
arguments||[]):void 0}}return q?function(x){return m(x,d)?z.apply(q,arguments||[]):void 0}:function(x){return m(x,d)?z.apply(q,arguments):void 0}};F.extend(k.Shape,k._eventsProcessing);k.Container={_init:function(){this.children=[];this._batch=0},openBatch:function(){return this},closeBatch:function(){return this},add:function(d){var m=d.getParent();m&&m.remove(d,!0);this.children.push(d);return d._setParent(this,this._getRealMatrix())},remove:function(d,m){for(var q=0;q<this.children.length;++q)if(this.children[q]==
d){m||(d.parent=null,d.parentMatrix=null);t(this.children,q);break}return this},clear:function(d){for(var m,q=0;q<this.children.length;++q)m=this.children[q],m.parent=null,m.parentMatrix=null,d&&m.destroy();this.children=[];return this},getBoundingBox:function(){if(this.children){var d=null;h.forEach(this.children,function(m){var q=m.getBoundingBox();q&&((m=m.getTransform())&&(q=e.multiplyRectangle(m,q)),d?(d.x=Math.min(d.x,q.x),d.y=Math.min(d.y,q.y),d.endX=Math.max(d.endX,q.x+q.width),d.endY=Math.max(d.endY,
q.y+q.height)):d={x:q.x,y:q.y,endX:q.x+q.width,endY:q.y+q.height})});d&&(d.width=d.endX-d.x,d.height=d.endY-d.y);return d}return null},_moveChildToFront:function(d){for(var m=0;m<this.children.length;++m)if(this.children[m]==d){t(this.children,m);this.children.push(d);break}return this},_moveChildToBack:function(d){for(var m=0;m<this.children.length;++m)if(this.children[m]==d){t(this.children,m);this.children.unshift(d);break}return this}};k.Surface=y("dojox.gfx.shape.Surface",null,{constructor:function(){this._parent=
this.rawNode=null;this._nodes=[];this._events=[]},destroy:function(){h.forEach(this._nodes,l.destroy);this._nodes=[];h.forEach(this._events,function(d){d&&d.remove()});this._events=[];this.rawNode=null;if(D("ie"))for(;this._parent.lastChild;)l.destroy(this._parent.lastChild);else this._parent.innerHTML="";this._parent=null},getEventSource:function(){return this.rawNode},_getRealMatrix:function(){return null},isLoaded:!0,onLoad:function(d){},whenLoaded:function(d,m){var q=F.hitch(d,m);if(this.isLoaded)q(this);
else n.once(this,"load",function(z){q(z)})}});F.extend(k.Surface,k._eventsProcessing);k.Rect=y("dojox.gfx.shape.Rect",k.Shape,{constructor:function(d){this.shape=u.getDefault("Rect");this.rawNode=d},getBoundingBox:function(){return this.shape}});k.Ellipse=y("dojox.gfx.shape.Ellipse",k.Shape,{constructor:function(d){this.shape=u.getDefault("Ellipse");this.rawNode=d},getBoundingBox:function(){if(!this.bbox){var d=this.shape;this.bbox={x:d.cx-d.rx,y:d.cy-d.ry,width:2*d.rx,height:2*d.ry}}return this.bbox}});
k.Circle=y("dojox.gfx.shape.Circle",k.Shape,{constructor:function(d){this.shape=u.getDefault("Circle");this.rawNode=d},getBoundingBox:function(){if(!this.bbox){var d=this.shape;this.bbox={x:d.cx-d.r,y:d.cy-d.r,width:2*d.r,height:2*d.r}}return this.bbox}});k.Line=y("dojox.gfx.shape.Line",k.Shape,{constructor:function(d){this.shape=u.getDefault("Line");this.rawNode=d},getBoundingBox:function(){if(!this.bbox){var d=this.shape;this.bbox={x:Math.min(d.x1,d.x2),y:Math.min(d.y1,d.y2),width:Math.abs(d.x2-
d.x1),height:Math.abs(d.y2-d.y1)}}return this.bbox}});k.Polyline=y("dojox.gfx.shape.Polyline",k.Shape,{constructor:function(d){this.shape=u.getDefault("Polyline");this.rawNode=d},setShape:function(d,m){d&&d instanceof Array?(this.inherited(arguments,[{points:d}]),m&&this.shape.points.length&&this.shape.points.push(this.shape.points[0])):this.inherited(arguments,[d]);return this},_normalizePoints:function(){var d=this.shape.points,m=d&&d.length;if(m&&"number"==typeof d[0]){for(var q=[],z=0;z<m;z+=
2)q.push({x:d[z],y:d[z+1]});this.shape.points=q}},getBoundingBox:function(){if(!this.bbox&&this.shape.points.length){for(var d=this.shape.points,m=d.length,q=d[0],z=q.x,x=q.y,v=q.x,I=q.y,B=1;B<m;++B)q=d[B],z>q.x&&(z=q.x),v<q.x&&(v=q.x),x>q.y&&(x=q.y),I<q.y&&(I=q.y);this.bbox={x:z,y:x,width:v-z,height:I-x}}return this.bbox}});k.Image=y("dojox.gfx.shape.Image",k.Shape,{constructor:function(d){this.shape=u.getDefault("Image");this.rawNode=d},getBoundingBox:function(){return this.shape},setStroke:function(){return this},
setFill:function(){return this}});k.Text=y(k.Shape,{constructor:function(d){this.fontStyle=null;this.shape=u.getDefault("Text");this.rawNode=d},getFont:function(){return this.fontStyle},setFont:function(d){this.fontStyle="string"==typeof d?u.splitFontString(d):u.makeParameters(u.defaultFont,d);this._setFont();return this},getBoundingBox:function(){var d=null;this.getShape().text&&(d=u._base._computeTextBoundingBox(this));return d}});k.Creator={createShape:function(d){switch(d.type){case u.defaultPath.type:return this.createPath(d);
case u.defaultRect.type:return this.createRect(d);case u.defaultCircle.type:return this.createCircle(d);case u.defaultEllipse.type:return this.createEllipse(d);case u.defaultLine.type:return this.createLine(d);case u.defaultPolyline.type:return this.createPolyline(d);case u.defaultImage.type:return this.createImage(d);case u.defaultText.type:return this.createText(d);case u.defaultTextPath.type:return this.createTextPath(d)}return null},createGroup:function(){return this.createObject(u.Group)},createRect:function(d){return this.createObject(u.Rect,
d)},createEllipse:function(d){return this.createObject(u.Ellipse,d)},createCircle:function(d){return this.createObject(u.Circle,d)},createLine:function(d){return this.createObject(u.Line,d)},createPolyline:function(d){return this.createObject(u.Polyline,d)},createImage:function(d){return this.createObject(u.Image,d)},createText:function(d){return this.createObject(u.Text,d)},createPath:function(d){return this.createObject(u.Path,d)},createTextPath:function(d){return this.createObject(u.TextPath,{}).setText(d)},
createObject:function(d,m){return null}};return k})},"dojox/gfx/path":function(){define(["./_base","dojo/_base/lang","dojo/_base/declare","./matrix","./shape"],function(u,F,y,C,D){D=y("dojox.gfx.path.Path",D.Shape,{constructor:function(n){this.shape=F.clone(u.defaultPath);this.segments=[];this.tbbox=null;this.absolute=!0;this.last={};this.rawNode=n;this.segmented=!1},setAbsoluteMode:function(n){this._confirmSegmented();this.absolute="string"==typeof n?"absolute"==n:n;return this},getAbsoluteMode:function(){this._confirmSegmented();
return this.absolute},getBoundingBox:function(){this._confirmSegmented();return this.bbox&&"l"in this.bbox?{x:this.bbox.l,y:this.bbox.t,width:this.bbox.r-this.bbox.l,height:this.bbox.b-this.bbox.t}:null},_getRealBBox:function(){this._confirmSegmented();if(this.tbbox)return this.tbbox;var n=this.bbox,h=this._getRealMatrix();this.bbox=null;for(var l=0,g=this.segments.length;l<g;++l)this._updateWithSegment(this.segments[l],h);h=this.bbox;this.bbox=n;return this.tbbox=h?[{x:h.l,y:h.t},{x:h.r,y:h.t},{x:h.r,
y:h.b},{x:h.l,y:h.b}]:null},getLastPosition:function(){this._confirmSegmented();return"x"in this.last?this.last:null},_applyTransform:function(){this.tbbox=null;return this.inherited(arguments)},_updateBBox:function(n,h,l){l&&(h=C.multiplyPoint(l,n,h),n=h.x,h=h.y);this.bbox&&"l"in this.bbox?(this.bbox.l>n&&(this.bbox.l=n),this.bbox.r<n&&(this.bbox.r=n),this.bbox.t>h&&(this.bbox.t=h),this.bbox.b<h&&(this.bbox.b=h)):this.bbox={l:n,b:h,r:n,t:h}},_updateWithSegment:function(n,h){var l=n.args,g=l.length,
e;switch(n.action){case "M":case "L":case "C":case "S":case "Q":case "T":for(e=0;e<g;e+=2)this._updateBBox(l[e],l[e+1],h);this.last.x=l[g-2];this.last.y=l[g-1];this.absolute=!0;break;case "H":for(e=0;e<g;++e)this._updateBBox(l[e],this.last.y,h);this.last.x=l[g-1];this.absolute=!0;break;case "V":for(e=0;e<g;++e)this._updateBBox(this.last.x,l[e],h);this.last.y=l[g-1];this.absolute=!0;break;case "m":e=0;"x"in this.last||(this._updateBBox(this.last.x=l[0],this.last.y=l[1],h),e=2);for(;e<g;e+=2)this._updateBBox(this.last.x+=
l[e],this.last.y+=l[e+1],h);this.absolute=!1;break;case "l":case "t":for(e=0;e<g;e+=2)this._updateBBox(this.last.x+=l[e],this.last.y+=l[e+1],h);this.absolute=!1;break;case "h":for(e=0;e<g;++e)this._updateBBox(this.last.x+=l[e],this.last.y,h);this.absolute=!1;break;case "v":for(e=0;e<g;++e)this._updateBBox(this.last.x,this.last.y+=l[e],h);this.absolute=!1;break;case "c":for(e=0;e<g;e+=6)this._updateBBox(this.last.x+l[e],this.last.y+l[e+1],h),this._updateBBox(this.last.x+l[e+2],this.last.y+l[e+3],h),
this._updateBBox(this.last.x+=l[e+4],this.last.y+=l[e+5],h);this.absolute=!1;break;case "s":case "q":for(e=0;e<g;e+=4)this._updateBBox(this.last.x+l[e],this.last.y+l[e+1],h),this._updateBBox(this.last.x+=l[e+2],this.last.y+=l[e+3],h);this.absolute=!1;break;case "A":for(e=0;e<g;e+=7)this._updateBBox(l[e+5],l[e+6],h);this.last.x=l[g-2];this.last.y=l[g-1];this.absolute=!0;break;case "a":for(e=0;e<g;e+=7)this._updateBBox(this.last.x+=l[e+5],this.last.y+=l[e+6],h);this.absolute=!1}n=[n.action];for(e=0;e<
g;++e)n.push(u.formatNumber(l[e],!0));if("string"==typeof this.shape.path)this.shape.path+=n.join("");else for(e=0,g=n.length;e<g;++e)this.shape.path.push(n[e])},_validSegments:{m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7,z:0},_pushSegment:function(n,h){this.tbbox=null;var l=this._validSegments[n.toLowerCase()];"number"==typeof l&&(l?h.length>=l&&(n={action:n,args:h.slice(0,h.length-h.length%l)},this.segments.push(n),this._updateWithSegment(n)):(n={action:n,args:[]},this.segments.push(n),this._updateWithSegment(n)))},
_collectArgs:function(n,h){for(var l=0;l<h.length;++l){var g=h[l];"boolean"==typeof g?n.push(g?1:0):"number"==typeof g?n.push(g):g instanceof Array?this._collectArgs(n,g):"x"in g&&"y"in g&&n.push(g.x,g.y)}},moveTo:function(){this._confirmSegmented();var n=[];this._collectArgs(n,arguments);this._pushSegment(this.absolute?"M":"m",n);return this},lineTo:function(){this._confirmSegmented();var n=[];this._collectArgs(n,arguments);this._pushSegment(this.absolute?"L":"l",n);return this},hLineTo:function(){this._confirmSegmented();
var n=[];this._collectArgs(n,arguments);this._pushSegment(this.absolute?"H":"h",n);return this},vLineTo:function(){this._confirmSegmented();var n=[];this._collectArgs(n,arguments);this._pushSegment(this.absolute?"V":"v",n);return this},curveTo:function(){this._confirmSegmented();var n=[];this._collectArgs(n,arguments);this._pushSegment(this.absolute?"C":"c",n);return this},smoothCurveTo:function(){this._confirmSegmented();var n=[];this._collectArgs(n,arguments);this._pushSegment(this.absolute?"S":
"s",n);return this},qCurveTo:function(){this._confirmSegmented();var n=[];this._collectArgs(n,arguments);this._pushSegment(this.absolute?"Q":"q",n);return this},qSmoothCurveTo:function(){this._confirmSegmented();var n=[];this._collectArgs(n,arguments);this._pushSegment(this.absolute?"T":"t",n);return this},arcTo:function(){this._confirmSegmented();var n=[];this._collectArgs(n,arguments);this._pushSegment(this.absolute?"A":"a",n);return this},closePath:function(){this._confirmSegmented();this._pushSegment("Z",
[]);return this},_confirmSegmented:function(){if(!this.segmented){var n=this.shape.path;this.shape.path=[];this._setPath(n);this.shape.path=this.shape.path.join("");this.segmented=!0}},_setPath:function(n){n=F.isArray(n)?n:n.match(u.pathSvgRegExp);this.segments=[];this.absolute=!0;this.bbox={};this.last={};if(n){for(var h="",l=[],g=n.length,e=0;e<g;++e){var t=n[e],k=parseFloat(t);isNaN(k)?(h&&this._pushSegment(h,l),l=[],h=t):l.push(k)}this._pushSegment(h,l)}},setShape:function(n){this.inherited(arguments,
["string"==typeof n?{path:n}:n]);this.segmented=!1;this.segments=[];u.lazyPathSegmentation||this._confirmSegmented();return this},_2PI:2*Math.PI});y=y("dojox.gfx.path.TextPath",D,{constructor:function(n){"text"in this||(this.text=F.clone(u.defaultTextPath));"fontStyle"in this||(this.fontStyle=F.clone(u.defaultFont))},getText:function(){return this.text},setText:function(n){this.text=u.makeParameters(this.text,"string"==typeof n?{text:n}:n);this._setText();return this},getFont:function(){return this.fontStyle},
setFont:function(n){this.fontStyle="string"==typeof n?u.splitFontString(n):u.makeParameters(u.defaultFont,n);this._setFont();return this}});return u.path={Path:D,TextPath:y}})},"dojox/gfx/arc":function(){define(["./_base","dojo/_base/lang","./matrix"],function(u,F,y){function C(e){var t=Math.cos(e);e=Math.sin(e);var k={x:t+4/3*(1-t),y:e-4/3*t*(1-t)/e};return{s:{x:t,y:-e},c1:{x:k.x,y:-k.y},c2:k,e:{x:t,y:e}}}var D=2*Math.PI,n=Math.PI/4,h=Math.PI/8,l=n+h,g=C(h);return u.arc={unitArcAsBezier:C,curvePI4:g,
arcAsBezier:function(e,t,k,d,m,q,z,x){m=!!m;q=!!q;var v=y._degToRad(d);d=t*t;var I=k*k,B=y.multiplyPoint(y.rotate(-v),{x:(e.x-z)/2,y:(e.y-x)/2}),L=B.x*B.x,R=B.y*B.y;d=Math.sqrt((d*I-d*R-I*L)/(d*R+I*L));isNaN(d)&&(d=0);d={x:d*t*B.y/k,y:-d*k*B.x/t};m==q&&(d={x:-d.x,y:-d.y});d=y.multiplyPoint([y.translate((e.x+z)/2,(e.y+x)/2),y.rotate(v)],d);t=y.normalize([y.translate(d.x,d.y),y.rotate(v),y.scale(t,k)]);d=y.invert(t);e=y.multiplyPoint(d,e);x=y.multiplyPoint(d,z,x);z=Math.atan2(e.y,e.x);d=z-Math.atan2(x.y,
x.x);q&&(d=-d);0>d?d+=D:d>D&&(d-=D);k=h;x=g;k=q?k:-k;e=[];for(m=d;0<m;m-=n)m<l&&(k=m/2,x=C(k),k=q?k:-k,m=0),B=y.normalize([t,y.rotate(z+k)]),q?(d=y.multiplyPoint(B,x.c1),v=y.multiplyPoint(B,x.c2),B=y.multiplyPoint(B,x.e)):(d=y.multiplyPoint(B,x.c2),v=y.multiplyPoint(B,x.c1),B=y.multiplyPoint(B,x.s)),e.push([d.x,d.y,v.x,v.y,B.x,B.y]),z+=2*k;return e}}})},"dojox/gfx/decompose":function(){define(["./_base","dojo/_base/lang","./matrix"],function(u,F,y){function C(g,e){return Math.abs(g-e)<=1E-6*(Math.abs(g)+
Math.abs(e))}function D(g,e,t,k){if(!isFinite(g))return t;if(!isFinite(t))return g;e=Math.abs(e);k=Math.abs(k);return(e*g+k*t)/(e+k)}function n(g){g=y.normalize(g);var e=-g.xx-g.yy,t=g.xx*g.yy-g.xy*g.yx,k=Math.sqrt(e*e-4*t);e=-(e+(0>e?-k:k))/2;t/=e;k=g.xy/(e-g.xx);var d=1,m=g.xy/(t-g.xx),q=1;C(e,t)&&(k=1,m=d=0,q=1);isFinite(k)||(k=1,d=(e-g.xx)/g.xy,isFinite(d)||(k=(e-g.yy)/g.yx,d=1,isFinite(k)||(k=1,d=g.yx/(e-g.yy))));isFinite(m)||(m=1,q=(t-g.xx)/g.xy,isFinite(q)||(m=(t-g.yy)/g.yx,q=1,isFinite(m)||
(m=1,q=g.yx/(t-g.yy))));g=Math.sqrt(k*k+d*d);var z=Math.sqrt(m*m+q*q);isFinite(k/=g)||(k=0);isFinite(d/=g)||(d=0);isFinite(m/=z)||(m=0);isFinite(q/=z)||(q=0);return{value1:e,value2:t,vector1:{x:k,y:d},vector2:{x:m,y:q}}}function h(g,e){var t=0>g.xx*g.yy||0<g.xy*g.yx?-1:1,k=e.angle1=(Math.atan2(g.yx,g.yy)+Math.atan2(-t*g.xy,t*g.xx))/2;t=Math.cos(k);k=Math.sin(k);e.sx=D(g.xx/t,t,-g.xy/k,k);e.sy=D(g.yy/t,t,g.yx/k,k);return e}function l(g,e){var t=0>g.xx*g.yy||0<g.xy*g.yx?-1:1,k=e.angle2=(Math.atan2(t*
g.yx,t*g.xx)+Math.atan2(-g.xy,g.yy))/2;t=Math.cos(k);k=Math.sin(k);e.sx=D(g.xx/t,t,g.yx/k,k);e.sy=D(g.yy/t,t,-g.xy/k,k);return e}return u.decompose=function(g){var e=y.normalize(g);g={dx:e.dx,dy:e.dy,sx:1,sy:1,angle1:0,angle2:0};if(C(e.xy,0)&&C(e.yx,0))return F.mixin(g,{sx:e.xx,sy:e.yy});if(C(e.xx*e.yx,-e.xy*e.yy))return h(e,g);if(C(e.xx*e.xy,-e.yx*e.yy))return l(e,g);var t=new y.Matrix2D(e);var k=F.mixin(t,{dx:0,dy:0,xy:t.yx,yx:t.xy});t=n([e,k]);k=n([k,e]);t=new y.Matrix2D({xx:t.vector1.x,xy:t.vector2.x,
yx:t.vector1.y,yy:t.vector2.y});k=new y.Matrix2D({xx:k.vector1.x,xy:k.vector1.y,yx:k.vector2.x,yy:k.vector2.y});e=new y.Matrix2D([y.invert(t),e,y.invert(k)]);h(k,g);e.xx*=g.sx;e.yy*=g.sy;l(t,g);e.xx*=g.sx;e.yy*=g.sy;return F.mixin(g,{sx:e.xx,sy:e.yy})}})},"dojox/gfx/bezierutils":function(){define(["./_base"],function(u){u=u.bezierutils={};u.tAtLength=function(h,l){var g=0,e=6==h.length,t=0,k=0,d=e?C:n,m=function(q,z){for(var x=0,v=0;v<q.length-2;v+=2)x+=y(q[v],q[v+1],q[v+2],q[v+3]);v=e?y(h[0],h[1],
h[4],h[5]):y(h[0],h[1],h[6],h[7]);x-v>z||t+x>l+z?(++k,q=d(q,.5),m(q[0],z),Math.abs(t-l)<=z||m(q[1],z)):(t+=x,g+=1/(1<<k))};l&&m(h,.5);return g};var F=u.computeLength=function(h){for(var l=6==h.length,g=0,e=0;e<h.length-2;e+=2)g+=y(h[e],h[e+1],h[e+2],h[e+3]);e=l?y(h[0],h[1],h[4],h[5]):y(h[0],h[1],h[6],h[7]);return.1<g-e?(h=l?C(h,.5):D(h,.5),g=F(h[0],l),g+=F(h[1],l)):g},y=u.distance=function(h,l,g,e){return Math.sqrt((g-h)*(g-h)+(e-l)*(e-l))},C=function(h,l){var g=1-l,e=g*g,t=l*l,k=h[0],d=h[1],m=h[2],
q=h[3],z=h[4];h=h[5];var x=e*k+2*g*l*m+t*z;e=e*d+2*g*l*q+t*h;return[[k,d,g*k+l*m,g*d+l*q,x,e],[x,e,g*m+l*z,g*q+l*h,z,h]]},D=function(h,l){var g=1-l,e=g*g,t=e*g,k=l*l,d=k*l,m=h[0],q=h[1],z=h[2],x=h[3],v=h[4],I=h[5],B=h[6];h=h[7];var L=t*m+3*e*l*z+3*g*k*v+d*B;t=t*q+3*e*l*x+3*g*k*I+d*h;return[[m,q,g*m+l*z,g*q+l*x,e*m+2*g*l*z+k*v,e*q+2*g*l*x+k*I,L,t],[L,t,e*z+2*g*l*v+k*B,e*x+2*g*l*I+k*h,g*v+l*B,g*I+l*h,B,h]]},n=u.splitBezierAtT=function(h,l){return 6==h.length?C(h,l):D(h,l)};return u})},"*noref":1}});
define("dojox/gfx/canvas","./_base dojo/_base/lang dojo/_base/array dojo/_base/declare dojo/_base/window dojo/dom-geometry dojo/dom ./shape ./path ./arc ./matrix ./decompose ./bezierutils".split(" "),function(u,F,y,C,D,n,h,l,g,e,t,k,d){function m(a,c,b,f,r,A,w,E,H,G){var K=c.length,J=0;if(G){var M=G.l/r;J=G.i}else M=c[0]/r;for(;A<w;){if(A+M>w){var S={l:(A+M-w)*r,i:J};M=w-A}J%2||(a.beginPath(),a.arc(b,f,r,A,A+M,E),H&&a.stroke());A+=M;++J;M=c[J%K]/r}return S}function q(a,c,b,f){var r=0,A=0,w=0;if(f){var E=
f.l;w=f.i}else E=c[0];for(;1>A;)A=d.tAtLength(a,E),1==A&&(r=d.computeLength(a),r={l:E-r,i:w}),a=d.splitBezierAtT(a,A),w%2||b.push(a[0]),a=a[1],++w,E=c[w%c.length];return r}function z(a,c,b,f){var r=[c.last.x,c.last.y].concat(b),A=!(a instanceof Array);b=4===b.length?"quadraticCurveTo":"bezierCurveTo";var w=[];c=q(r,c.canvasDash,w,f);for(f=0;f<w.length;++f)r=w[f],A?(a.moveTo(r[0],r[1]),a[b].apply(a,r.slice(2))):(a.push("moveTo",[r[0],r[1]]),a.push(b,r.slice(2)));return c}function x(a,c,b,f,r,A,w){var E=
0,H=0,G=0,K=d.distance(b,f,r,A),J=0;c=c.canvasDash;var M=b,S=f,X=!(a instanceof Array);w?(G=w.l,J=w.i):G+=c[0];for(;.01<Math.abs(1-H);){G>K&&(E={l:G-K,i:J},G=K);H=G/K;w=b+(r-b)*H;var U=f+(A-f)*H;J++%2||(X?(a.moveTo(M,S),a.lineTo(w,U)):(a.push("moveTo",[M,S]),a.push("lineTo",[w,U])));M=w;S=U;G+=c[J%c.length]}return E}var v=u.canvas={},I=null,B=t.multiplyPoint,L=Math.PI,R=2*L,N=L/2;k=F.extend;if(D.global.CanvasRenderingContext2D){D=D.doc.createElement("canvas").getContext("2d");var T="function"==typeof D.setLineDash,
Y="function"==typeof D.fillText}var W={solid:"none",shortdash:[4,1],shortdot:[1,1],shortdashdot:[4,1,1,1],shortdashdotdot:[4,1,1,1,1,1],dot:[1,3],dash:[4,3],longdash:[8,3],dashdot:[4,3,1,3],longdashdot:[8,3,1,3],longdashdotdot:[8,3,1,3,1,3]};v.Shape=C("dojox.gfx.canvas.Shape",l.Shape,{_render:function(a){a.save();this._renderTransform(a);this._renderClip(a);this._renderShape(a);this._renderFill(a,!0);this._renderStroke(a,!0);a.restore()},_renderClip:function(a){this.canvasClip&&(this.canvasClip.render(a),
a.clip())},_renderTransform:function(a){if("canvasTransform"in this){var c=this.canvasTransform;a.translate(c.dx,c.dy);a.rotate(c.angle2);a.scale(c.sx,c.sy);a.rotate(c.angle1)}},_renderShape:function(a){},_renderFill:function(a,c){if("canvasFill"in this){var b=this.fillStyle;if("canvasFillImage"in this){var f=b.width,r=b.height,A=this.canvasFillImage.width,w=this.canvasFillImage.height,E=Math.min(f==A?1:f/A,r==w?1:r/w),H=(f-E*A)/2,G=(r-E*w)/2;I.width=f;I.height=r;var K=I.getContext("2d");K.clearRect(0,
0,f,r);K.drawImage(this.canvasFillImage,0,0,A,w,H,G,E*A,E*w);this.canvasFill=a.createPattern(I,"repeat");delete this.canvasFillImage}a.fillStyle=this.canvasFill;c&&("pattern"!==b.type||0===b.x&&0===b.y||a.translate(b.x,b.y),a.fill())}else a.fillStyle="rgba(0,0,0,0.0)"},_renderStroke:function(a,c){var b=this.strokeStyle;b?(a.strokeStyle=b.color.toString(),a.lineWidth=b.width,a.lineCap=b.cap,"number"==typeof b.join?(a.lineJoin="miter",a.miterLimit=b.join):a.lineJoin=b.join,this.canvasDash?T?(a.setLineDash(this.canvasDash),
c&&a.stroke()):this._renderDashedStroke(a,c):c&&a.stroke()):c||(a.strokeStyle="rgba(0,0,0,0.0)")},_renderDashedStroke:function(a,c){},getEventSource:function(){return null},on:function(){},connect:function(){},disconnect:function(){},canvasClip:null,setClip:function(a){this.inherited(arguments);var c=a?"width"in a?"rect":"cx"in a?"ellipse":"points"in a?"polyline":"d"in a?"path":null:null;if(a&&!c)return this;this.canvasClip=a?Z(c,a):null;this.parent&&this.parent._makeDirty();return this}});var Z=
function(a,c){switch(a){case "ellipse":return{canvasEllipse:V({shape:c}),render:function(b){return v.Ellipse.prototype._renderShape.call(this,b)}};case "rect":return{shape:F.delegate(c,{r:0}),render:function(b){return v.Rect.prototype._renderShape.call(this,b)}};case "path":return{canvasPath:aa(c),render:function(b){this.canvasPath._renderShape(b)}};case "polyline":return{canvasPolyline:c.points,render:function(b){return v.Polyline.prototype._renderShape.call(this,b)}}}return null},aa=function(a){var c=
new dojox.gfx.canvas.Path;c.canvasPath=[];c._setPath(a.d);return c},P=function(a,c,b){var f=a.prototype[c];a.prototype[c]=b?function(){this.parent&&this.parent._makeDirty();f.apply(this,arguments);b.call(this);return this}:function(){this.parent&&this.parent._makeDirty();return f.apply(this,arguments)}};P(v.Shape,"setTransform",function(){this.matrix?this.canvasTransform=u.decompose(this.matrix):delete this.canvasTransform});P(v.Shape,"setFill",function(){var a=this.fillStyle;if(a){if("object"==typeof a&&
"type"in a){var c=this.surface.rawNode.getContext("2d");switch(a.type){case "linear":case "radial":var b="linear"==a.type?c.createLinearGradient(a.x1,a.y1,a.x2,a.y2):c.createRadialGradient(a.cx,a.cy,0,a.cx,a.cy,a.r);y.forEach(a.colors,function(f){b.addColorStop(f.offset,u.normalizeColor(f.color).toString())});break;case "pattern":I||(I=document.createElement("canvas")),c=new Image,this.surface.downloadImage(c,a.src),this.canvasFillImage=c}}else b=a.toString();this.canvasFill=b}else delete this.canvasFill});
P(v.Shape,"setStroke",function(){var a=this.strokeStyle;if(a){var c=this.strokeStyle.style.toLowerCase();c in W&&(c=W[c]);if(c instanceof Array){this.canvasDash=c=c.slice();var b;for(b=0;b<c.length;++b)c[b]*=a.width;if("butt"!=a.cap){for(b=0;b<c.length;b+=2)c[b]-=a.width,1>c[b]&&(c[b]=1);for(b=1;b<c.length;b+=2)c[b]+=a.width}}else delete this.canvasDash}else delete this.canvasDash;this._needsDash=!T&&!!this.canvasDash});P(v.Shape,"setShape");v.Group=C("dojox.gfx.canvas.Group",v.Shape,{constructor:function(){l.Container._init.call(this)},
_render:function(a){a.save();this._renderTransform(a);this._renderClip(a);for(var c=0;c<this.children.length;++c)this.children[c]._render(a);a.restore()},destroy:function(){l.Container.clear.call(this,!0);v.Shape.prototype.destroy.apply(this,arguments)}});v.Rect=C("dojox.gfx.canvas.Rect",[v.Shape,l.Rect],{_renderShape:function(a){var c=this.shape,b=Math.min(c.r,c.height/2,c.width/2),f=c.x,r=f+c.width,A=c.y;c=A+c.height;var w=f+b,E=r-b,H=A+b,G=c-b;a.beginPath();a.moveTo(w,A);b?(a.arc(E,H,b,-N,0,!1),
a.arc(E,G,b,0,N,!1),a.arc(w,G,b,N,L,!1),a.arc(w,H,b,L,L+N,!1)):(a.lineTo(E,A),a.lineTo(r,G),a.lineTo(w,c),a.lineTo(f,H));a.closePath()},_renderDashedStroke:function(a,c){var b=this.shape,f=Math.min(b.r,b.height/2,b.width/2),r=b.x,A=r+b.width,w=b.y,E=w+b.height,H=r+f,G=A-f,K=w+f,J=E-f;f?(a.beginPath(),b=x(a,this,H,w,G,w),c&&a.stroke(),b=m(a,this.canvasDash,G,K,f,-N,0,!1,c,b),a.beginPath(),b=x(a,this,A,K,A,J,b),c&&a.stroke(),b=m(a,this.canvasDash,G,J,f,0,N,!1,c,b),a.beginPath(),b=x(a,this,G,E,H,E,b),
c&&a.stroke(),b=m(a,this.canvasDash,H,J,f,N,L,!1,c,b),a.beginPath(),b=x(a,this,r,J,r,K,b),c&&a.stroke(),m(a,this.canvasDash,H,K,f,L,L+N,!1,c,b)):(a.beginPath(),b=x(a,this,H,w,G,w),b=x(a,this,G,w,A,J,b),b=x(a,this,A,J,H,E,b),x(a,this,H,E,r,K,b),c&&a.stroke())}});var O=[];(function(){var a=e.curvePI4;O.push(a.s,a.c1,a.c2,a.e);for(var c=45;360>c;c+=45){var b=t.rotateg(c);O.push(B(b,a.c1),B(b,a.c2),B(b,a.e))}})();var V=function(a){var c=[],b=a.shape,f=t.normalize([t.translate(b.cx,b.cy),t.scale(b.rx,
b.ry)]);var r=B(f,O[0]);c.push([r.x,r.y]);for(b=1;b<O.length;b+=3){var A=B(f,O[b]);var w=B(f,O[b+1]);r=B(f,O[b+2]);c.push([A.x,A.y,w.x,w.y,r.x,r.y])}if(a._needsDash){r=[];A=c[0];for(b=1;b<c.length;++b)w=[],q(A.concat(c[b]),a.canvasDash,w),A=[c[b][4],c[b][5]],r.push(w);a._dashedPoints=r}return c};v.Ellipse=C("dojox.gfx.canvas.Ellipse",[v.Shape,l.Ellipse],{setShape:function(){this.inherited(arguments);this.canvasEllipse=V(this);return this},setStroke:function(){this.inherited(arguments);T||(this.canvasEllipse=
V(this));return this},_renderShape:function(a){var c=this.canvasEllipse,b;a.beginPath();a.moveTo.apply(a,c[0]);for(b=1;b<c.length;++b)a.bezierCurveTo.apply(a,c[b]);a.closePath()},_renderDashedStroke:function(a,c){var b=this._dashedPoints;a.beginPath();for(var f=0;f<b.length;++f)for(var r=b[f],A=0;A<r.length;++A){var w=r[A];a.moveTo(w[0],w[1]);a.bezierCurveTo(w[2],w[3],w[4],w[5],w[6],w[7])}c&&a.stroke()}});v.Circle=C("dojox.gfx.canvas.Circle",[v.Shape,l.Circle],{_renderShape:function(a){var c=this.shape;
a.beginPath();a.arc(c.cx,c.cy,c.r,0,R,1)},_renderDashedStroke:function(a,c){var b=this.shape,f=0,r=this.canvasDash.length;for(i=0;f<R;){var A=this.canvasDash[i%r]/b.r;i%2||(a.beginPath(),a.arc(b.cx,b.cy,b.r,f,f+A,0),c&&a.stroke());f+=A;++i}}});v.Line=C("dojox.gfx.canvas.Line",[v.Shape,l.Line],{_renderShape:function(a){var c=this.shape;a.beginPath();a.moveTo(c.x1,c.y1);a.lineTo(c.x2,c.y2)},_renderDashedStroke:function(a,c){var b=this.shape;a.beginPath();x(a,this,b.x1,b.y1,b.x2,b.y2);c&&a.stroke()}});
v.Polyline=C("dojox.gfx.canvas.Polyline",[v.Shape,l.Polyline],{setShape:function(){this.inherited(arguments);var a=this.shape.points,c=a[0],b;this.bbox=null;this._normalizePoints();if(a.length)if("number"==typeof c)c=a;else for(c=[],b=0;b<a.length;++b){var f=a[b];c.push(f.x,f.y)}else c=[];this.canvasPolyline=c;return this},_renderShape:function(a){var c=this.canvasPolyline;if(c.length){a.beginPath();a.moveTo(c[0],c[1]);for(var b=2;b<c.length;b+=2)a.lineTo(c[b],c[b+1])}},_renderDashedStroke:function(a,
c){var b=this.canvasPolyline,f=0;a.beginPath();for(var r=0;r<b.length;r+=2)f=x(a,this,b[r],b[r+1],b[r+2],b[r+3],f);c&&a.stroke()}});v.Image=C("dojox.gfx.canvas.Image",[v.Shape,l.Image],{setShape:function(){this.inherited(arguments);var a=new Image;this.surface.downloadImage(a,this.shape.src);this.canvasImage=a;return this},_renderShape:function(a){var c=this.shape;a.drawImage(this.canvasImage,c.x,c.y,c.width,c.height)}});v.Text=C("dojox.gfx.canvas.Text",[v.Shape,l.Text],{_setFont:function(){this.fontStyle?
this.canvasFont=u.makeFontString(this.fontStyle):delete this.canvasFont},getTextWidth:function(){var a=this.shape,c=0;if(a.text){var b=this.surface.rawNode.getContext("2d");b.save();this._renderTransform(b);this._renderFill(b,!1);this._renderStroke(b,!1);this.canvasFont&&(b.font=this.canvasFont);c=b.measureText(a.text).width;b.restore()}return c},_render:function(a){a.save();this._renderTransform(a);this._renderFill(a,!1);this._renderStroke(a,!1);this._renderShape(a);a.restore()},_renderShape:function(a){var c=
this.shape;c.text&&(a.textAlign="middle"===c.align?"center":c.align,this.canvasFont&&(a.font=this.canvasFont),this.canvasFill&&a.fillText(c.text,c.x,c.y),this.strokeStyle&&(a.beginPath(),a.strokeText(c.text,c.x,c.y),a.closePath()))}});P(v.Text,"setFont");Y||v.Text.extend({getTextWidth:function(){return 0},getBoundingBox:function(){return null},_renderShape:function(){}});var ba={M:"_moveToA",m:"_moveToR",L:"_lineToA",l:"_lineToR",H:"_hLineToA",h:"_hLineToR",V:"_vLineToA",v:"_vLineToR",C:"_curveToA",
c:"_curveToR",S:"_smoothCurveToA",s:"_smoothCurveToR",Q:"_qCurveToA",q:"_qCurveToR",T:"_qSmoothCurveToA",t:"_qSmoothCurveToR",A:"_arcTo",a:"_arcTo",Z:"_closePath",z:"_closePath"};v.Path=C("dojox.gfx.canvas.Path",[v.Shape,g.Path],{constructor:function(){this.lastControl={}},setShape:function(){this.canvasPath=[];this._dashedPath=[];return this.inherited(arguments)},setStroke:function(){this.inherited(arguments);T||(this.segmented=!1,this._confirmSegmented());return this},_setPath:function(){this._dashResidue=
null;this.inherited(arguments)},_updateWithSegment:function(a){var c=F.clone(this.last);this[ba[a.action]](this.canvasPath,a.action,a.args,this._needsDash?this._dashedPath:null);this.last=c;this.inherited(arguments)},_renderShape:function(a){var c=this.canvasPath;a.beginPath();for(var b=0;b<c.length;b+=2)a[c[b]].apply(a,c[b+1])},_renderDashedStroke:T?function(){}:function(a,c){var b=this._dashedPath;a.beginPath();for(var f=0;f<b.length;f+=2)a[b[f]].apply(a,b[f+1]);c&&a.stroke()},_moveToA:function(a,
c,b,f){a.push("moveTo",[b[0],b[1]]);f&&f.push("moveTo",[b[0],b[1]]);for(c=2;c<b.length;c+=2)a.push("lineTo",[b[c],b[c+1]]),f&&(this._dashResidue=x(f,this,b[c-2],b[c-1],b[c],b[c+1],this._dashResidue));this.last.x=b[b.length-2];this.last.y=b[b.length-1];this.lastControl={}},_moveToR:function(a,c,b,f){c="x"in this.last?[this.last.x+=b[0],this.last.y+=b[1]]:[this.last.x=b[0],this.last.y=b[1]];a.push("moveTo",c);f&&f.push("moveTo",c);for(c=2;c<b.length;c+=2)a.push("lineTo",[this.last.x+=b[c],this.last.y+=
b[c+1]]),f&&(this._dashResidue=x(f,this,f[f.length-1][0],f[f.length-1][1],this.last.x,this.last.y,this._dashResidue));this.lastControl={}},_lineToA:function(a,c,b,f){for(c=0;c<b.length;c+=2)f&&(this._dashResidue=x(f,this,this.last.x,this.last.y,b[c],b[c+1],this._dashResidue)),a.push("lineTo",[b[c],b[c+1]]);this.last.x=b[b.length-2];this.last.y=b[b.length-1];this.lastControl={}},_lineToR:function(a,c,b,f){for(c=0;c<b.length;c+=2)a.push("lineTo",[this.last.x+=b[c],this.last.y+=b[c+1]]),f&&(this._dashResidue=
x(f,this,f[f.length-1][0],f[f.length-1][1],this.last.x,this.last.y,this._dashResidue));this.lastControl={}},_hLineToA:function(a,c,b,f){for(c=0;c<b.length;++c)a.push("lineTo",[b[c],this.last.y]),f&&(this._dashResidue=x(f,this,f[f.length-1][0],f[f.length-1][1],b[c],this.last.y,this._dashResidue));this.last.x=b[b.length-1];this.lastControl={}},_hLineToR:function(a,c,b,f){for(c=0;c<b.length;++c)a.push("lineTo",[this.last.x+=b[c],this.last.y]),f&&(this._dashResidue=x(f,this,f[f.length-1][0],f[f.length-
1][1],this.last.x,this.last.y,this._dashResidue));this.lastControl={}},_vLineToA:function(a,c,b,f){for(c=0;c<b.length;++c)a.push("lineTo",[this.last.x,b[c]]),f&&(this._dashResidue=x(f,this,f[f.length-1][0],f[f.length-1][1],this.last.x,b[c],this._dashResidue));this.last.y=b[b.length-1];this.lastControl={}},_vLineToR:function(a,c,b,f){for(c=0;c<b.length;++c)a.push("lineTo",[this.last.x,this.last.y+=b[c]]),f&&(this._dashResidue=x(f,this,f[f.length-1][0],f[f.length-1][1],this.last.x,this.last.y,this._dashResidue));
this.lastControl={}},_curveToA:function(a,c,b,f){for(c=0;c<b.length;c+=6)a.push("bezierCurveTo",b.slice(c,c+6)),f&&(this._dashResidue=z(f,this,a[a.length-1],this._dashResidue));this.last.x=b[b.length-2];this.last.y=b[b.length-1];this.lastControl.x=b[b.length-4];this.lastControl.y=b[b.length-3];this.lastControl.type="C"},_curveToR:function(a,c,b,f){for(c=0;c<b.length;c+=6)a.push("bezierCurveTo",[this.last.x+b[c],this.last.y+b[c+1],this.lastControl.x=this.last.x+b[c+2],this.lastControl.y=this.last.y+
b[c+3],this.last.x+b[c+4],this.last.y+b[c+5]]),f&&(this._dashResidue=z(f,this,a[a.length-1],this._dashResidue)),this.last.x+=b[c+4],this.last.y+=b[c+5];this.lastControl.type="C"},_smoothCurveToA:function(a,c,b,f){for(c=0;c<b.length;c+=4){var r="C"==this.lastControl.type;a.push("bezierCurveTo",[r?2*this.last.x-this.lastControl.x:this.last.x,r?2*this.last.y-this.lastControl.y:this.last.y,b[c],b[c+1],b[c+2],b[c+3]]);f&&(this._dashResidue=z(f,this,a[a.length-1],this._dashResidue));this.lastControl.x=
b[c];this.lastControl.y=b[c+1];this.lastControl.type="C"}this.last.x=b[b.length-2];this.last.y=b[b.length-1]},_smoothCurveToR:function(a,c,b,f){for(c=0;c<b.length;c+=4){var r="C"==this.lastControl.type;a.push("bezierCurveTo",[r?2*this.last.x-this.lastControl.x:this.last.x,r?2*this.last.y-this.lastControl.y:this.last.y,this.last.x+b[c],this.last.y+b[c+1],this.last.x+b[c+2],this.last.y+b[c+3]]);f&&(this._dashResidue=z(f,this,a[a.length-1],this._dashResidue));this.lastControl.x=this.last.x+b[c];this.lastControl.y=
this.last.y+b[c+1];this.lastControl.type="C";this.last.x+=b[c+2];this.last.y+=b[c+3]}},_qCurveToA:function(a,c,b,f){for(c=0;c<b.length;c+=4)a.push("quadraticCurveTo",b.slice(c,c+4));f&&(this._dashResidue=z(f,this,a[a.length-1],this._dashResidue));this.last.x=b[b.length-2];this.last.y=b[b.length-1];this.lastControl.x=b[b.length-4];this.lastControl.y=b[b.length-3];this.lastControl.type="Q"},_qCurveToR:function(a,c,b,f){for(c=0;c<b.length;c+=4)a.push("quadraticCurveTo",[this.lastControl.x=this.last.x+
b[c],this.lastControl.y=this.last.y+b[c+1],this.last.x+b[c+2],this.last.y+b[c+3]]),f&&(this._dashResidue=z(f,this,a[a.length-1],this._dashResidue)),this.last.x+=b[c+2],this.last.y+=b[c+3];this.lastControl.type="Q"},_qSmoothCurveToA:function(a,c,b,f){for(c=0;c<b.length;c+=2){var r="Q"==this.lastControl.type;a.push("quadraticCurveTo",[this.lastControl.x=r?2*this.last.x-this.lastControl.x:this.last.x,this.lastControl.y=r?2*this.last.y-this.lastControl.y:this.last.y,b[c],b[c+1]]);f&&(this._dashResidue=
z(f,this,a[a.length-1],this._dashResidue));this.lastControl.type="Q"}this.last.x=b[b.length-2];this.last.y=b[b.length-1]},_qSmoothCurveToR:function(a,c,b,f){for(c=0;c<b.length;c+=2){var r="Q"==this.lastControl.type;a.push("quadraticCurveTo",[this.lastControl.x=r?2*this.last.x-this.lastControl.x:this.last.x,this.lastControl.y=r?2*this.last.y-this.lastControl.y:this.last.y,this.last.x+b[c],this.last.y+b[c+1]]);f&&(this._dashResidue=z(f,this,a[a.length-1],this._dashResidue));this.lastControl.type="Q";
this.last.x+=b[c];this.last.y+=b[c+1]}},_arcTo:function(a,c,b,f){c="a"==c;for(var r=0;r<b.length;r+=7){var A=b[r+5],w=b[r+6];c&&(A+=this.last.x,w+=this.last.y);var E=e.arcAsBezier(this.last,b[r],b[r+1],b[r+2],b[r+3]?1:0,b[r+4]?1:0,A,w);y.forEach(E,function(H){a.push("bezierCurveTo",H)});f&&(this._dashResidue=z(f,this,p,this._dashResidue));this.last.x=A;this.last.y=w}this.lastControl={}},_closePath:function(a,c,b,f){a.push("closePath",[]);f&&(this._dashResidue=x(f,this,this.last.x,this.last.y,f[1][0],
f[1][1],this._dashResidue));this.lastControl={}}});y.forEach("moveTo lineTo hLineTo vLineTo curveTo smoothCurveTo qCurveTo qSmoothCurveTo arcTo closePath".split(" "),function(a){P(v.Path,a)});v.TextPath=C("dojox.gfx.canvas.TextPath",[v.Shape,g.TextPath],{_renderShape:function(a){},_setText:function(){},_setFont:function(){}});v.Surface=C("dojox.gfx.canvas.Surface",l.Surface,{constructor:function(){l.Container._init.call(this);this.pendingImageCount=0;this.makeDirty()},destroy:function(){l.Container.clear.call(this,
!0);this.inherited(arguments)},setDimensions:function(a,c){this.width=u.normalizedLength(a);this.height=u.normalizedLength(c);if(!this.rawNode)return this;a=!1;this.rawNode.width!=this.width&&(this.rawNode.width=this.width,a=!0);this.rawNode.height!=this.height&&(this.rawNode.height=this.height,a=!0);a&&this.makeDirty();return this},getDimensions:function(){return this.rawNode?{width:this.rawNode.width,height:this.rawNode.height}:null},_render:function(a){!this.rawNode||!a&&this.pendingImageCount||
(a=this.rawNode.getContext("2d"),a.clearRect(0,0,this.rawNode.width,this.rawNode.height),this.render(a),"pendingRender"in this&&(clearTimeout(this.pendingRender),delete this.pendingRender))},render:function(a){a.save();for(var c=0;c<this.children.length;++c)this.children[c]._render(a);a.restore()},makeDirty:function(){this.pendingImagesCount||"pendingRender"in this||this._batch||(this.pendingRender=setTimeout(F.hitch(this,this._render),0))},downloadImage:function(a,c){var b=F.hitch(this,this.onImageLoad);
!this.pendingImageCount++&&"pendingRender"in this&&(clearTimeout(this.pendingRender),delete this.pendingRender);a.onload=b;a.onerror=b;a.onabort=b;a.src=c},onImageLoad:function(){--this.pendingImageCount||(this.onImagesLoaded(),this._render())},onImagesLoaded:function(){},getEventSource:function(){return null},connect:function(){},disconnect:function(){},on:function(){}});v.createSurface=function(a,c,b){if(!c&&!b){var f=n.position(a);c=c||f.w;b=b||f.h}"number"==typeof c&&(c+="px");"number"==typeof b&&
(b+="px");f=new v.Surface;a=h.byId(a);var r=a.ownerDocument.createElement("canvas");r.width=u.normalizedLength(c);r.height=u.normalizedLength(b);a.appendChild(r);f.rawNode=r;f._parent=a;return f.surface=f};var Q=l.Container;C={openBatch:function(){++this._batch;return this},closeBatch:function(){this._batch=0<this._batch?--this._batch:0;this._makeDirty();return this},_makeDirty:function(){this._batch||this.surface.makeDirty()},add:function(a){this._makeDirty();return Q.add.apply(this,arguments)},
remove:function(a,c){this._makeDirty();return Q.remove.apply(this,arguments)},clear:function(){this._makeDirty();return Q.clear.apply(this,arguments)},getBoundingBox:Q.getBoundingBox,_moveChildToFront:function(a){this._makeDirty();return Q._moveChildToFront.apply(this,arguments)},_moveChildToBack:function(a){this._makeDirty();return Q._moveChildToBack.apply(this,arguments)}};g={createObject:function(a,c){a=new a;a.surface=this.surface;a.setShape(c);this.add(a);return a}};k(v.Group,C);k(v.Group,l.Creator);
k(v.Group,g);k(v.Surface,C);k(v.Surface,l.Creator);k(v.Surface,g);v.fixTarget=function(a,c){return!0};return v});