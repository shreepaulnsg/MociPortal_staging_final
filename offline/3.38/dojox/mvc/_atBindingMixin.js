//>>built
define("dojox/mvc/_atBindingMixin","dojo/_base/array dojo/_base/lang dojo/_base/declare dojo/has dojo/Stateful ./resolve ./sync".split(" "),function(v,l,m,k,y,w,z){function A(a){try{var b=require("dijit/registry")}catch(d){return}for(a=a.domNode&&a.domNode.parentNode;a;){if(a=b.getEnclosingWidget(a)){var c=a._relTargetProp||"target";if((l.isFunction(a.get)?a.get(c):a[c])||c in a.constructor.prototype)return a}a=a&&a.domNode.parentNode}}function q(a,b,c,d,n){function x(){h.Two&&h.Two.unwatch();delete h.Two;
var e=f&&(l.isFunction(f.get)?f.get(r):f[r]),g=w(a,e);e=w(c,e);k("mvc-bindings-log-api")&&(!g||/^rel:/.test(a)&&!f)&&t(a,b);k("mvc-bindings-log-api")&&(!e||/^rel:/.test(c)&&!f)&&t(c,d);g&&e&&(!/^rel:/.test(a)&&!/^rel:/.test(c)||f)&&(g.set&&g.watch||"*"!=b?null==b?(l.isFunction(e.set)?e.set(d,g):e[d]=g,k("mvc-bindings-log-api")&&console.log("dojox/mvc/_atBindingMixin set "+g+" to: "+B(e,d))):h.Two=z(g,b,e,d,n):k("mvc-bindings-log-api")&&t(a,b))}var h={},f=A(c),r=f&&f._relTargetProp||"target";x();if(f&&
/^rel:/.test(a)||/^rel:/.test(c)&&l.isFunction(f.set)&&l.isFunction(f.watch))h.rel=f.watch(r,function(e,g,C){g!==C&&(k("mvc-bindings-log-api")&&console.log("Change in relative data binding target: "+f),x())});var u={};u.unwatch=u.remove=function(){for(var e in h)h[e]&&h[e].unwatch(),delete h[e]};return u}var B=k("mvc-bindings-log-api")?function(a,b){return[a._setIdAttr||!a.declaredClass?a:a.declaredClass,b].join(":")}:"",t=k("mvc-bindings-log-api")?function(a,b){console.warn(b+" could not be resolved"+
("string"==typeof a?" with "+a:"")+".")}:"",p={dataBindAttr:"data-mvc-bindings",_dbpostscript:function(a,b){b=this._refs=(a||{}).refs||{};for(var c in a)if("dojox.mvc.at"==(a[c]||{}).atsignature){var d=a[c];delete a[c];b[c]=d}d=new y;var n=this;d.toString=function(){return"[Mixin value of widget "+n.declaredClass+", "+(n.id||"NO ID")+"]"};d.canConvertToLoggable=!0;this._startAtWatchHandles(d);for(c in b)void 0!==d[c]&&((a=a||{})[c]=d[c]);this._stopAtWatchHandles()},_startAtWatchHandles:function(a){this.canConvertToLoggable=
!0;var b=this._refs;if(b){var c=this._atWatchHandles=this._atWatchHandles||{};this._excludes=null;for(var d in b)b[d]&&"*"!=d&&(c[d]=q(b[d].target,b[d].targetProp,a||this,d,{bindDirection:b[d].bindDirection,converter:b[d].converter,equals:b[d].equalsCallback}));"dojox.mvc.at"==(b["*"]||{}).atsignature&&(c["*"]=q(b["*"].target,b["*"].targetProp,a||this,"*",{bindDirection:b["*"].bindDirection,converter:b["*"].converter,equals:b["*"].equalsCallback}))}},_stopAtWatchHandles:function(){for(var a in this._atWatchHandles)this._atWatchHandles[a].unwatch(),
delete this._atWatchHandles[a]},_setAtWatchHandle:function(a,b){if("ref"==a)throw Error(this+": 1.7 ref syntax used in conjunction with 1.8 dojox/mvc/at syntax, which is not supported.");var c=this._atWatchHandles=this._atWatchHandles||{};c[a]&&(c[a].unwatch(),delete c[a]);this._excludes=this[a]=null;this._started?c[a]=q(b.target,b.targetProp,this,a,{bindDirection:b.bindDirection,converter:b.converter,equals:b.equalsCallback}):this._refs[a]=b},_setBind:function(a){a=eval("({"+a+"})");for(var b in a){var c=
a[b];"dojox.mvc.at"!=(c||{}).atsignature?console.warn(b+" in "+dataBindAttr+" is not a data binding handle."):this._setAtWatchHandle(b,c)}},_getExcludesAttr:function(){if(this._excludes)return this._excludes;var a=[],b;for(b in this._atWatchHandles)"*"!=b&&a.push(b);return a},_getPropertiesAttr:function(){if(this.constructor._attribs)return this.constructor._attribs;var a=["onClick"].concat(this.constructor._setterAttrs);v.forEach(["id","excludes","properties","ref","binding"],function(b){b=v.indexOf(a,
b);0<=b&&a.splice(b,1)});return this.constructor._attribs=a}};p[p.dataBindAttr]="";m=m("dojox/mvc/_atBindingMixin",null,p);m.mixin=p;return m});