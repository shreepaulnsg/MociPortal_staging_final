//>>built
define("dojox/treemap/_utils",["dojo/_base/array"],function(n){var p={group:function(d,h,f){var e={children:[]},l=function(c,a){c.__treeValue||(c.__treeValue=0);c.__treeValue+=f(a);return c};n.forEach(d,function(c){var a=e;n.forEach(h,function(b,k){var g=b(c);(b=p.find(a.children,function(m){return m.__treeName==g}))||a.children.push(b={__treeName:g,__treeID:g+Math.random(),children:[]});b=l(b,c);k!=h.length-1?a=b:b.children.push(c)});a=l(a,c)});return e},find:function(d,h){for(var f=d.length,e=0;e<
f;++e)if(h.call(null,d[e]))return d[e];return null},solve:function(d,h,f,e,l){var c=p.initElements(d,e);e=c.total;c=c.elements;var a=e;if(0==e){if(0==c.length)return{items:d,rects:[],total:0};n.forEach(c,function(b){b.size=b.sizeTmp=100});e=100*c.length}c.sort(function(b,k){return k.size-b.size});p._compute(h,f,c,e);c.sort(function(b,k){return b.index-k.index});d={};d.elements=c;d.size=a;rects=n.map(c,function(b){return{x:l?h-b.x-b.width:b.x,y:b.y,w:b.width,h:b.height}});d.rectangles=rects;return d},
initElements:function(d,h){var f=0;return{elements:n.map(d,function(e,l){e=null!=h?h(e):0;if(0>e)throw Error("item size dimension must be positive");f+=e;return{index:l,size:e,sizeTmp:e}}),total:f}},_compute:function(d,h,f,e){var l=d*h/e/100;n.forEach(f,function(t){t.sizeTmp*=l});for(var c=e=0,a=2147483647,b,k=0,g=0,m=d,r=h,q=m>r;c!=f.length;)if(b=p._trySolution(f,e,c,q,m,r),b>a||1>b){m=b=0;for(a=e;a<c;a++)f[a].x=k+b,f[a].y=g+m,q?m+=f[a].height:b+=f[a].width;q?k+=f[e].width:g+=f[e].height;m=d-k;r=
h-g;q=m>r;c=e=c;a=2147483647}else{for(a=e;a<=c;a++)f[a].width=f[a].widthTmp,f[a].height=f[a].heightTmp;a=b;c++}h=d=0;for(a=e;a<c;a++)f[a].x=k+d,f[a].y=g+h,q?h+=f[a].height:d+=f[a].width},_trySolution:function(d,h,f,e,l,c){for(var a=0,b=0,k=b=0,g=h;g<=f;g++)a+=d[g].sizeTmp;e?0==c?b=k=0:(b=a/c*100,k=c):0==l?b=k=0:(k=a/l*100,b=l);for(g=h;g<=f;g++)e?(d[g].widthTmp=b,d[g].heightTmp=0==a?0:k*d[g].sizeTmp/a):(d[g].widthTmp=0==a?0:b*d[g].sizeTmp/a,d[g].heightTmp=k);b=Math.max(d[f].heightTmp/d[f].widthTmp,
d[f].widthTmp/d[f].heightTmp);return void 0==b?1:b}};return p});